{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/utils/SheetUtils.js","webpack:///./src/draw/font/BaseFont.js","webpack:///./src/lib/Element.js","webpack:///./src/const/Constant.js","webpack:///./src/lib/XEvent.js","webpack:///./src/lib/Widget.js","webpack:///./src/core/xwork/head/tool/Icon.js","webpack:///./src/module/dragpanel/DragPanel.js","webpack:///./src/module/colorpicker/ColorPicker.js","webpack:///./src/module/colorpicker/colorarray/ColorItem.js","webpack:///./src/module/colorpicker/colorarray/ColorArray.js","webpack:///./src/core/xtable/tablecell/CellFont.js","webpack:///./src/draw/XDraw.js","webpack:///./src/draw/Line.js","webpack:///./src/core/xtable/tablecell/Border.js","webpack:///./src/core/xtable/tablecell/CellBorder.js","webpack:///./src/draw/Rect.js","webpack:///./src/core/xtable/tableicon/XIconOffset.js","webpack:///./src/draw/Crop.js","webpack:///./src/core/xtable/tableicon/XIcon.js","webpack:///./src/utils/DateUtils.js","webpack:///./src/core/xtable/XTableTextFormat.js","webpack:///./src/core/xtable/tablecell/RichFont.js","webpack:///./src/core/xtable/tablecell/RichFonts.js","webpack:///./src/formula/Compiler.js","webpack:///./src/formula/Formula.js","webpack:///./src/core/xtable/tablecell/Cell.js","webpack:///./src/core/xtable/XTableDataItem.js","webpack:///./src/lib/Listen.js","webpack:///./src/core/xtable/snapshot/Snapshot.js","webpack:///./src/core/xtable/XTableDataItems.js","webpack:///./src/task/worker/sumtotal.worker.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","S4","Math","random","toString","substring","alphabets","DATA_TYPE","String","Boolean","Number","Array","Function","Null","Undefined","Promise","GeneratorFunction","AsyncFunction","BigInt","DedicatedWorkerGlobalScope","Date","Un","SheetUtils","test","navigator","userAgent","isEmptyObject","e","this","isUnDef","type","length","trim","obj","getPrototypeOf","parent","str","toLowerCase","arg","sources","forEach","source","keys","v","isArray","isPlainObject","copy","json","JSON","stringify","parse","target","len","item","objOrAry","cb","total","size","val","isNumber","parseFloat","parseInt","index","idx","ret","charCodeAt","expoNet","src","x","y","charAt","indexAt","stringAt","xn","yn","expr2xy","xy2expr","min","range","window","getSelection","selectAllChildren","collapseToEnd","isBlank","now","width","innerWidth","height","innerHeight","document","exitFullscreen","msExitFullscreen","mozCancelFullScreen","webkitExitFullscreen","element","el","requestFullscreen","msRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","webkitIsFullScreen","mozFullScreen","msFullscreenElement","fullscreenElement","explorer","indexOf","version","match","array","isString","replace","EMPTY","num","fixed","toFixed","defaultValue","self","condition","establish","otherwise","likeArray","slice","Nul","Undef","undefined","noop","BaseFont","draw","ruler","attr","align","ALIGN","center","padding","verticalAlign","VERTICAL_ALIGN","top","bottom","left","right","TEXT_WRAP","OVER_FLOW","WORD_WRAP","TRUNCATE","TEXT_DIRECTION","HORIZONTAL","VERTICAL","ANGLE","ANGLE_BAR","DEFAULT_FONT_ATTR","color","bold","italic","strikethrough","underline","angle","textWrap","direction","DEFAULT_RICH_ATTR","DEFAULT_RICH_ITEM_ATTR","Element","tag","className","createElement","map","HTMLCollection","NodeList","includes","elements","push","text","createTextNode","args","arguments","wrapElement","children","ele","append","childNodes","isTextNode","childrenNodes","prepend","k","css","offsetTop","offsetLeft","offsetHeight","offsetWidth","parentNode","classList","add","contains","remove","getBoundingClientRect","firstChild","lastChild","find","handle","elem","hasChild","reverse","removeChild","previousSibling","nextSibling","flag","cls","addClass","removeClass","nodeValue","innerText","html","innerHTML","focus","blur","removeAttribute","style","setAttribute","getAttribute","removeProperty","hyphenateRE","newValue","getPropertyValue","setProperty","getComputedStyle","computedStyle","display","message","evt","MouseEvent","detail","bubbles","cancelable","initEvent","dispatchEvent","CustomEvent","select","result","querySelectorAll","sibling","previousElementSibling","nextElementSibling","nodeName","toLocaleLowerCase","nodeType","after","before","cloneNode","other","equals","tagName","DocumentFragment","h","Constant","WORK_BODY_EVENT_TYPE","CHANGE_ACTIVE","REMOVE_SHEET","SYSTEM_EVENT_TYPE","MOUSE_MOVE","MOUSE_DOWN","CONTEXT_MENU","SCROLL","RESIZE","MOUSE_UP","INPUT","KEY_DOWN","KEY_UP","MOUSE_OVER","MOUSE_LEAVE","MOUSE_WHEEL","MOUSE_ENTER","CLICK","FOCUS","DRAG_START","CHANGE","VISIBILITY_CHANGE","TABLE_EVENT_TYPE","RENDER","SNAPSHOT_CHANGE","CHANGE_ROW_HEIGHT","CHANGE_COL_WIDTH","SCALE_CHANGE","EDIT_START","EDIT_INPUT","EDIT_FINISH","REMOVE_ROW","REMOVE_COL","ADD_NEW_ROW","ADD_NEW_COL","FIXED_CHANGE","FIXED_COL_CHANGE","FIXED_ROW_CHANGE","SELECT_OVER","SELECT_DOWN","SELECT_CHANGE","DATA_CHANGE","RESIZE_CHANGE","FORM_EVENT_TYPE","SEARCH_INPUT_CHANGE","PLAIN_INPUT_CHANGE","FORM_SELECT_CHANGE","pool","callback","option","removeEventListener","addEventListener","rem","eqElem","eqOpt","eqType","eqCall","eles","unbind","XEvent","fn","multipleUnbind","multipleBind","holdFunc","endFunc","time","setInterval","xEvtUp","clearInterval","moveFunc","upFunc","xEvtMove","stopPropagation","preventDefault","WrapFuncion","doubleClick","lastPageX","lastPageY","lastTime","event","button","pageX","pageY","current","mouseClick","Widget","$$rootFlag","clazz","node","body","is","hasClass","data","widget","parentWidget","onAttach","box","clientY","clientX","Icon","iconNameEl","instances","DragPanel","options","position","DRAG_PANEL_POSITION","CENTER","status","mask","content","instance","filter","close","root","getRootWidget","dragPanelLocation","evt1","downEventXy","eventXy","mouseMoveUp","evt2","offset","rootBox","elemBox","LEFT","RIGHT","TOP","removeInstance","ColorPicker","selectCb","dragPanel","preViewColorPoint","colorValueTips","colorInput","selectColorPoint","selectColorArea1","selectColorArea2","selectColorArea3","colorHuxTips","colorBar","colorBarPoint","cancelButton","selectButton","buttons","hex","join","hsx","max","rgb","startsWith","isHex","hexToRgb","g","b","parseRgb","rgbToHsb","hsb","delta","t1","t2","t3","round","nr","rgbToHex","hsbToRgb","e1","hexColor","xy","colorBarBox","downHue","e2","moveHue","centerBox","downSelect","moveSelect","fixHsx","open","isRgb","change","colorBarPointBox","colorBarPointLeft","selectColorPointBox","selectColorPointLeft","selectColorPointTop","colorValue","hsbToHex","areaColorValue","sliderPosition","hueChange","selectChange","hexToHsb","fixHex","destroy","ColorItem","icon","blankClear","isDark","checkedIcon","hide","active","show","ColorArray","colors","activeColor","setActiveByColor","findIndex","setActive","empty","BLACK","WHITE","CellFont","keys1","keys2","scaleAdapter","DPR","inWorker","devicePixelRatio","LINE_WIDTH_LOW","LINE_WIDTH_MEDIUM","LINE_WIDTH_HIGH","LINE_PIXEL_OFFSET","Base","canvas","ctx","getContext","px","dpr","srcPx","stylePx","ceil","trunc","PI","CorsLine","lineWidthType","LINE_WIDTH_TYPE","low","lineColor","medium","high","sx","sy","ex","ey","lineWidth","strokeStyle","polyStroke","xys","getOffsetX","getOffsetY","TypeError","corsLine","linePx","pixel","offsetX","offsetY","interpolation","beginPath","moveTo","lineTo","stroke","fill","fillRect","radian","dash","measureText","save","restore","clip","setLineDash","scale","translate","deg","rotate","XDraw","fillText","path","polyInFill","points","w","rect","sw","sh","tx","ty","tw","th","drawImage","LINE_TYPE","DoubleLine","widthType","spacing","leftShow","topShow","rightShow","bottomShow","iFMerge","iFMergeFirstRow","iFMergeLastRow","iFMergeFirstCol","iFMergeLastCol","row","col","pos","external","ifMerge","firstRow","lastRow","firstCol","lastCol","sTopLeftCorner","sTop","sBottom","eBottomLeftCorner","eBottom","eTop","sLeft","sRight","eTopRightCorner","eRight","eLeft","sTopRightCorner","eBottomRightCorner","sBottomLeftCorner","internal","setLineColor","setLineWidthType","handleExternal","handleInternal","horizonLine","verticalLine","zIndexID","Border","zIndex","getZIndex","border","origin","CellBorder","setBDisplay","setLDisplay","setTDisplay","setRDisplay","setDisplay","setBColor","setLColor","setTColor","setRColor","setColor","setBWidthType","setLWidthType","setTWidthType","setRWidthType","setWidthType","setBType","setLType","setTType","setRType","setType","setZIndex","clone","Rect","XIconOffset","Crop","XIcon","vertical","ICON_VERTICAL","horizontal","ICON_HORIZONTAL","ICON_TYPE","image","iconFocus","onDraw","onLeave","onMove","onDown","onEnter","icons","iconHorizontal","iconVertical","iconOffsetX","iconOffsetY","iconWidth","iconHeight","rectX","rectY","rectWidth","rectHeight","py","BOTTOM","load","sync","Image","loadImg","complete","onload","onerror","console","error","drawCustom","positionRect","include","includeRect","crop","fillStyle","native","location","inRectPosition","activate","ICON_EVENT_TYPE","includePoint","setActivate","custom","DateUtils","fmt","date","getMonth","getDate","getHours","getMinutes","getSeconds","floor","S","getMilliseconds","resultYear","exec","yearFormatPart","yearVal","getFullYear","substr","res","RegExp","Val","formatPart","replaceVal","parserToDate","dateText","format","defaultVal","reg","year","month","day","hours","minutes","seconds","milliseconds","j","oneChar","onePart","onePartReg","dataInfo","toExponential","isFraction","split","dateFormat","RichFont","RichFonts","rich","font","each","reset","plain","item1","item2","Functions","functions","toLocaleString","func","Assembly","assembly","endsWith","op","Tokenizer","syntaxCheck","input","OPERATOR","NUMBERS","LETTERS","bracketsStack","tokens","char","SPACE","next","last","brackets","pop","syntax","sQuotesStack","dQuotesStack","callStack","arrayStack","ignoreArray","token","ignoreFunc","skipIgnoreToken","dir","checkArray","local","checkValue","checkOperator","checkFunction","Compiler","writer","groupStack","ignore","opIf","opAdd","opMul","opCommon","opRel","opNew","opCell","function","number","eofToken","nextToken","backToken","compileIfge","isSkipNextToken","getInstruct","compileAdd","operator","reduceGroup","writeOperator","compileMul","compileCommon","compileRel","compileArray","compileFunction","addGroup","popGroup","compilePushValue","increaseGroup","writeString","writeNumber","writeOperand","Evaluation","instruct","memory","newArray","invoke","pushSRegexp","pushNRegexp","pushORegexp","ificmpge","ificmpgt","ifge","ifgt","ifeq","ifne","sub","mul","div","mod","power","rel","link","uni","common","group","pushS","pushN","pushO","a","pow","getFunction","apply","Compile","tokenizer","lexical","compile","Instruct","inst","eval","Formula","expr","Cell","fontAttr","borderAttr","formula","richText","background","contentWidth","contentHeight","contentType","TYPE","STRING","newInstances","formatText","setContentType","setExpr","setRich","setContentWidth","getExpr","NUMBER","DATE_TIME","isDate","RICH_TEXT","getComputeText","hasExpr","getValue","XTableFormat","getRich","getFormatText","XTableDataItem","cell","safeValue","mergeId","Listen","Snapshot","undoStack","redoStack","layer","listen","undo","execute","redo","action","XTableDataItems","snapshot","items","ri","ci","set","sri","sci","eri","eci","line","wrap","rectRange","ignoreCorner","oldItems","effRiLength","effCiLength","oldRowItem","rowItem","addAction","orderValue","splice","subItems","newSubItems","getCell","hasFormula","postMessage"],"mappings":"aACE,IAAIA,EAAmB,GAGvB,SAASC,EAAoBC,GAG5B,GAAGF,EAAiBE,GACnB,OAAOF,EAAiBE,GAAUC,QAGnC,IAAIC,EAASJ,EAAiBE,GAAY,CACzCG,EAAGH,EACHI,GAAG,EACHH,QAAS,IAUV,OANAI,EAAQL,GAAUM,KAAKJ,EAAOD,QAASC,EAAQA,EAAOD,QAASF,GAG/DG,EAAOE,GAAI,EAGJF,EAAOD,QAKfF,EAAoBQ,EAAIF,EAGxBN,EAAoBS,EAAIV,EAGxBC,EAAoBU,EAAI,SAASR,EAASS,EAAMC,GAC3CZ,EAAoBa,EAAEX,EAASS,IAClCG,OAAOC,eAAeb,EAASS,EAAM,CAAEK,YAAY,EAAMC,IAAKL,KAKhEZ,EAAoBkB,EAAI,SAAShB,GACX,oBAAXiB,QAA0BA,OAAOC,aAC1CN,OAAOC,eAAeb,EAASiB,OAAOC,YAAa,CAAEC,MAAO,WAE7DP,OAAOC,eAAeb,EAAS,aAAc,CAAEmB,OAAO,KAQvDrB,EAAoBsB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQrB,EAAoBqB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,iBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKX,OAAOY,OAAO,MAGvB,GAFA1B,EAAoBkB,EAAEO,GACtBX,OAAOC,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOrB,EAAoBU,EAAEe,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRzB,EAAoB6B,EAAI,SAAS1B,GAChC,IAAIS,EAAST,GAAUA,EAAOqB,WAC7B,WAAwB,OAAOrB,EAAgB,SAC/C,WAA8B,OAAOA,GAEtC,OADAH,EAAoBU,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRZ,EAAoBa,EAAI,SAASiB,EAAQC,GAAY,OAAOjB,OAAOkB,UAAUC,eAAe1B,KAAKuB,EAAQC,IAGzG/B,EAAoBkC,EAAI,GAIjBlC,EAAoBA,EAAoBmC,EAAI,G,2rBCjFrD,SAASC,IAEP,OAA+B,OAArB,EAAIC,KAAKC,UAAuB,GAAGC,SAAS,IAAIC,UAAU,G,OAGtE,IAAMC,EAAY,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAE1IC,EAAY,CAChBC,OAAQ,EACRC,QAAS,EACTC,OAAQ,EACR/B,OAAQ,EACRgC,MAAO,EACPC,SAAU,EACVC,KAAM,EACNC,UAAW,EACXC,QAAS,EACTC,kBAAmB,GACnBC,cAAe,GACfC,OAAQ,GACRlC,OAAQ,GACRmC,2BAA4B,GAC5BC,KAAM,GACNC,GAAI,GAGAC,E,+LAGF,MAAO,iBAAiBC,KAAKC,UAAUC,a,8BAIvC,MAAO,sBAAsBF,KAAKC,UAAUC,a,uCAGtB9B,GACtB,OAAQ2B,EAAWI,cAAc/B,K,oCAGdA,GAEnB,IAAK,IAAMH,KAAOG,EAEhB,GAAIA,EAAOG,eAAeN,GACxB,OAAO,EAGX,OAAO,I,8BAGMmC,GACb,OAAOA,U,4BAGIA,GACX,OAAQC,KAAKC,QAAQF,K,+BAGPA,GACd,MAAO,0BAA0BJ,KAAKI,K,iCAGtBA,GAChB,MAAO,aAAaJ,KAAKI,K,6BAGbA,GACZ,OAAOL,EAAWQ,KAAKH,KAAOpB,EAAUa,O,iCAGxBO,GAEhB,OADaL,EAAWQ,KAAKH,KACbpB,EAAUK,W,8BAGbe,GACb,OAAOL,EAAWQ,KAAKH,KAAOpB,EAAUI,Q,kCAGvBgB,GACjB,OAAIL,EAAWO,QAAQF,IAGI,iBAAbA,EAAEI,S,8BAGH/B,GACb,QAAIsB,EAAWO,QAAQ7B,IAGQ,KAAxBA,EAAEI,WAAW4B,S,oCAGDC,GACnB,OAAIX,EAAWO,QAAQI,IAGhBtD,OAAOuD,eAAeD,KAAStD,OAAOuD,eAAe,M,+BAG9CD,GACd,OAAOX,EAAWQ,KAAKG,KAAS1B,EAAUC,S,kCAGzByB,EAAKE,GACtB,OAAOF,aAAeE,I,gCAGPC,GACf,OAAOA,EAAIC,gB,2BAGDC,GACV,IAAMR,EAAOnD,OAAOkB,UAAUO,SAAShC,KAAKkE,GAC5C,OAAQR,GACN,IAAK,gBACH,OAAOvB,EAAUM,KACnB,IAAK,kBACH,OAAON,EAAU5B,OACnB,IAAK,qBACH,OAAO4B,EAAUO,UACnB,IAAK,kBACH,OAAOP,EAAUC,OACnB,IAAK,mBACH,OAAOD,EAAUE,QACnB,IAAK,kBACH,OAAOF,EAAUG,OACnB,IAAK,oBACH,OAAOH,EAAUK,SACnB,IAAK,iBACH,OAAOL,EAAUI,MACnB,IAAK,mBACH,OAAOJ,EAAUQ,QACnB,IAAK,6BACH,OAAOR,EAAUS,kBACnB,IAAK,yBACH,OAAOT,EAAUU,cACnB,IAAK,kBACH,OAAOV,EAAUW,OACnB,IAAK,kBACH,OAAOX,EAAUvB,OACnB,IAAK,gBACH,OAAOuB,EAAUa,KACnB,IAAK,sCACH,OAAOb,EAAUY,2BACnB,QACE,OAAOZ,EAAUc,M,6BAIc,IAAzB1B,EAAyB,uDAAhB,GACnB,GAAI2B,EAAWO,QAAQlC,GACrB,MAAO,GAF0B,2BAAT4C,EAAS,iCAATA,EAAS,kBAInC,OAAIjB,EAAWO,QAAQU,IAA+B,IAAnBA,EAAQR,QAG3CQ,EAAQC,SAAQ,SAACC,GACXnB,EAAWO,QAAQY,IACvB9D,OAAO+D,KAAKD,GAAQD,SAAQ,SAAChD,GAC3B,IAAMmD,EAAIF,EAAOjD,GACA,iBAANmD,GAA+B,iBAANA,GAA+B,kBAANA,EAC3DhD,EAAOH,GAAOmD,EACQ,mBAANA,IAAqBhC,MAAMiC,QAAQD,IAAMrB,EAAWuB,cAAcF,IAClFhD,EAAOH,GAAOG,EAAOH,IAAQ,GAC7B8B,EAAWwB,KAAKnD,EAAOH,GAAMmD,IAE7BhD,EAAOH,GAAOmD,QAZXhD,I,gCAmBMA,GACf,IAAMoD,EAAOC,KAAKC,UAAUtD,GAC5B,OAAOqD,KAAKE,MAAMH,K,8BAGLI,GACb,IAAK,IAAIlF,EAAI,EAAGmF,EAAM,UAAH,+BAAenF,EAAImF,EAAKnF,IAAK,CAC9C,IAAMoF,EAAWpF,EAAP,uBAAOA,EAAP,mBAAOA,EAAP,GACV,IAAK,IAAIuB,KAAO6D,EACd,GAAIA,EAAKvD,eAAeN,GAAM,CAC5B,IAAMN,EAAQmE,EAAK7D,GACfN,IACFiE,EAAO3D,GAAON,IAKtB,OAAOiE,I,0BAGEG,GAA+B,IAArBC,EAAqB,uDAAhB,SAAArE,GAAK,OAAIA,GAC7BsE,EAAQ,EACRC,EAAO,EAKX,OAJA9E,OAAO+D,KAAKY,GAAUd,SAAQ,SAAChD,GAC7BgE,GAASD,EAAGD,EAAS9D,GAAMA,GAC3BiE,GAAQ,KAEH,CAACD,EAAOC,K,gJAGCC,GAChB,OAAIpC,EAAWqC,SAASD,GAAaE,WAAWF,GACzC,M,8IAGOA,GACd,OAAIpC,EAAWqC,SAASD,GAAaG,SAASH,EAAK,IAC5C,M,+BAGOI,GAGd,IAFA,IAAI1B,EAAM,GACN2B,EAAMD,EACHC,GAAOzD,EAAUyB,QACtBgC,GAAOzD,EAAUyB,OACjBgC,GAAO,EACP3B,GAAO9B,EAAUuD,SAASE,EAAK,IAAMzD,EAAUyB,QAIjD,OADAK,GAAO9B,EADMwD,EAAQxD,EAAUyB,U,8BAKlBK,GAEb,IADA,IAAI4B,EAAM,EACD/F,EAAI,EAAGA,EAAImE,EAAIL,OAAS,EAAG9D,GAAK,EAAG,CAC1C,IAAM8F,EAAM3B,EAAI6B,WAAWhG,GAAK,GAC1BiG,EAAU9B,EAAIL,OAAS,EAAI9D,EACjC+F,GAAO,SAAC1D,EAAUyB,OAAUmC,GAAY5D,EAAUyB,OAASgC,EAG7D,OADAC,GAAO5B,EAAI6B,WAAW7B,EAAIL,OAAS,GAAK,K,8BAI3BoC,GAGb,IAFA,IAAIC,EAAI,GACJC,EAAI,GACCpG,EAAI,EAAGA,EAAIkG,EAAIpC,OAAQ9D,GAAK,EAC/BkG,EAAIG,OAAOrG,IAAM,KAAOkG,EAAIG,OAAOrG,IAAM,IAC3CoG,GAAKF,EAAIG,OAAOrG,GAEhBmG,GAAKD,EAAIG,OAAOrG,GAGpB,MAAO,CAACqD,EAAWiD,QAAQH,GAAIP,SAASQ,EAAG,IAAM,K,8BAGpCD,EAAGC,GAChB,gBAAU/C,EAAWkD,SAASJ,IAA9B,OAAmCC,EAAI,K,gCAGxBF,EAAKM,EAAIC,GAAI,QACbpD,EAAWqD,QAAQR,GADN,GACrBC,EADqB,KAClBC,EADkB,KAE5B,OAAO/C,EAAWsD,QAAQR,EAAIK,EAAIJ,EAAIK,K,4BAG3B/B,EAAGkC,GACd,OAAIlC,EAAIkC,EAAYA,EACblC,I,oCAGYV,GACnB,IAAM6C,EAAQC,OAAOC,eACrBF,EAAMG,kBAAkBhD,GACxB6C,EAAMI,kB,2BAGIlF,GACV,OAAI4B,KAAKuD,QAAQnF,GAAW,GACrBA,EAAEgC,S,4BAIT,OAAOZ,KAAKgE,MAAMhF,a,iCAIlB,MAAO,CACLiF,MAAON,OAAOO,WACdC,OAAQR,OAAOS,e,uCAKbC,SAASC,eACXD,SAASC,iBACAD,SAASE,iBAClBF,SAASE,mBACAF,SAASG,oBAClBH,SAASG,sBACAH,SAASI,sBAClBJ,SAASI,yB,iCAIKC,GACZA,EAAQC,KACVD,EAAUA,EAAQC,IAEhBD,EAAQE,kBACVF,EAAQE,oBACCF,EAAQG,oBACjBH,EAAQG,sBACCH,EAAQI,qBACjBJ,EAAQI,uBACCJ,EAAQK,yBACjBL,EAAQK,4B,+BAKV,SAAUV,SAASW,oBAAsBX,SAASY,eAC7CZ,SAASa,qBAAuBb,SAASc,qB,6BAI9C,gBAAWtG,IAAOA,KAAlB,OAAyBA,KAAzB,OAAgCA,KAAhC,OAAuCA,KAAvC,OAA8CA,KAA9C,OAAqDA,KAArD,OAA4DA,O,wCAI5D,IAAMuG,EAAWzB,OAAOvD,UAAUC,UAAUY,cAE5C,OAAImE,EAASC,QAAQ,YAAc,EAE1B,CAAE3E,KAAM,UAAW4E,QADdF,EAASG,MAAM,qBAAqB,IAI9CH,EAASC,QAAQ,WAAa,EAEzB,CAAE3E,KAAM,SAAU4E,QADbF,EAASG,MAAM,oBAAoB,IAI7CH,EAASC,QAAQ,UAAY,EAExB,CAAE3E,KAAM,QAAS4E,QADZF,EAASG,MAAM,kBAAkB,IAI3CH,EAASC,QAAQ,WAAa,EAEzB,CAAE3E,KAAM,SAAU4E,QADbF,EAASG,MAAM,qBAAqB,IAI9CH,EAASC,QAAQ,SAAW,EAEvB,CAAE3E,KAAM,KAAM4E,QADTF,EAASG,MAAM,iBAAiB,SAD9C,I,gCAQeC,GACf,OAAOA,EAAMA,EAAM7E,OAAS,K,gCAGb6E,GACf,OAAOA,EAAM,K,iCAGG1H,GAChB,OAAIoC,EAAWuF,SAAS3H,GACfA,EAAM4H,QAAQ,OAAQxF,EAAWyF,OAEnC7H,I,6BAGKiF,EAAKhB,GACjB,OAAI7B,EAAWO,QAAQsC,KAGnB7C,EAAWO,QAAQsB,IAGhBH,KAAKC,UAAUkB,KAASnB,KAAKC,UAAUE,K,8BAGjC6D,EAAKC,GAClB,OAAID,EAAI5G,WAAWqG,QAAQ,MAAQ,EAC1BO,EAAIE,QAAQD,GAEdD,I,gCAGQ9H,GAA0B,IAAnBiI,EAAmB,uDAAJ,GACrC,OAAO7F,EAAWO,QAAQ3C,GAASiI,EAAejI,I,iCAMlD,OADaoC,EAAWQ,KAAKsF,QACb7G,EAAUY,6B,yBAGlBkG,EAAWC,EAAWC,GAC9B,OAAOF,EAAYC,IAAcC,M,4BAGtBC,GACX,OAAO7G,MAAMd,UAAU4H,MAAMrJ,KAAKoJ,K,iCAGlBpF,GAChB,OAAOA,EAAI0E,QAAQ,MAAO,O,yMAK9BxF,EAAWyF,MAAQ,GACnBzF,EAAWoG,IAAM,KACjBpG,EAAWqG,WAAQC,EACnBtG,EAAWuG,KAAO,aAClBvG,EAAWf,UAAYA,E,IChajBuH,E,WAEJ,cAEG,IADDC,EACC,EADDA,KAAMC,EACL,EADKA,MAAOC,EACZ,EADYA,M,4FACZ,SACDrG,KAAKmG,KAAOA,EACZnG,KAAKqG,KAAOA,EACZrG,KAAKoG,MAAQA,E,wDAGNA,GACPpG,KAAKoG,MAAQA,I,wCAIb,OAAIpG,KAAKqG,KAAKC,QAAUJ,EAASK,MAAMC,OAC9B,EAEFxG,KAAKqG,KAAKI,U,gDAIjB,OAAIzG,KAAKqG,KAAKK,gBAAkBR,EAASS,eAAeH,OAC/C,EAEFxG,KAAKqG,KAAKI,a,6VAKrBP,EAASS,eAAiB,CACxBC,IAAK,MACLJ,OAAQ,SACRK,OAAQ,UAEVX,EAASK,MAAQ,CACfO,KAAM,OACNN,OAAQ,SACRO,MAAO,SAETb,EAASc,UAAY,CACnBC,UAAW,EACXC,UAAW,EACXC,SAAU,GAEZjB,EAASkB,eAAiB,CACxBC,WAAY,aACZC,SAAU,WACVC,MAAO,QACPC,UAAW,OAEbtB,EAASuB,kBAAoB,CAC3B7K,KAAM,QACNiF,KAAM,GACN6F,MAAO,aACPC,MAAM,EACNC,QAAQ,EACRC,eAAe,EACfC,WAAW,EACXC,MAAO,EACPtB,QAAS,EACTH,MAAOJ,EAASK,MAAMO,KACtBkB,SAAU9B,EAASc,UAAUG,SAC7BT,cAAeR,EAASS,eAAeH,OACvCyB,UAAW/B,EAASkB,eAAeC,YAErCnB,EAASgC,kBAAoB,CAC3BH,MAAO,EACPtB,QAAS,EACTH,MAAOJ,EAASK,MAAMO,KACtBkB,SAAU9B,EAASc,UAAUG,SAC7BT,cAAeR,EAASS,eAAeH,OACvCyB,UAAW/B,EAASkB,eAAeC,YAErCnB,EAASiC,uBAAyB,CAChCvL,KAAM,QACNiF,KAAM,GACN6F,MAAO,aACPC,MAAM,EACNC,QAAQ,EACRC,eAAe,EACfC,WAAW,G,IC3EPM,E,WA8CJ,WAAYC,GAAqB,IAAhBC,EAAgB,uDAAJ,GAAI,UACZ,iBAARD,GACTrI,KAAKmE,GAAKN,SAAS0E,cAAcF,GAC7BC,IACFtI,KAAKmE,GAAGmE,UAAYA,IAGtBtI,KAAKmE,GAAKkE,EAEZrI,KAAKwI,IAAM,G,mDAlDMzK,GACjB,GAAI,CACF2B,EAAWsB,QAAQjD,GACnBA,aAAkB0K,eAClB1K,aAAkB2K,UAClBC,UAAS,GAAO,CAEhB,IADA,IAAIC,EAAW,GACNvM,EAAI,EAAGA,EAAI0B,EAAOoC,OAAQ9D,IAAK,CACtC,IAAMoF,EAAO1D,EAAO1B,GAChBoF,aAAgB2G,EAClBQ,EAASC,KAAKpH,GAEdmH,EAASC,KAAK,IAAIT,EAAQ3G,IAG9B,OAAOmH,EAET,OAAO,IAAIR,EAAQrK,K,iCAGH+K,GAChB,OAAO,IAAIV,EAAQvE,SAASkF,eAAeD,M,kCAQ1BxL,GACjB,OAAIA,EACKA,EAAM4H,QAAQ,WAAY,OAAOzE,cAEnC,S,gCA0BJ7C,EAAKN,GACR,YAAc0I,IAAV1I,GACF0C,KAAKwI,IAAI5K,GAAON,EACT0C,MAEFA,KAAKwI,IAAI5K,K,iCASA,kCAANoL,EAAM,yBAANA,EAAM,gBAChB,OAAyB,IAArBC,UAAU9I,OACLiI,EAAQc,YAAYlJ,KAAKmE,GAAGgF,WAErCH,EAAKpI,SAAQ,SAAAwI,GAAG,OAAI,EAAKC,OAAOD,MACzBpJ,Q,sCASc,kCAANgJ,EAAM,yBAANA,EAAM,gBACrB,OAAyB,IAArBC,UAAU9I,OACLiI,EAAQc,YAAYlJ,KAAKmE,GAAGmF,aAErCN,EAAKpI,SAAQ,SAAAwI,GAAG,OAAI,EAAKC,OAAOD,MACzBpJ,Q,0CAOWoJ,GAAK,WAIvB,OAHKpJ,KAAKuJ,cACRH,EAAII,gBAAgB5I,SAAQ,SAAAvE,GAAC,OAAI,EAAKgN,OAAOhN,MAExC2D,O,2CAOYoJ,GAAK,WAIxB,OAHKpJ,KAAKuJ,cACRH,EAAII,gBAAgB5I,SAAQ,SAAAvE,GAAC,OAAI,EAAKoN,QAAQpN,MAEzC2D,O,6BAOFoJ,GAML,OALKpJ,KAAKuJ,cACJH,GAAOA,EAAIjF,IACbnE,KAAKmE,GAAGkF,OAAOD,EAAIjF,IAGhBnE,O,8BAODoJ,GAMN,OALKpJ,KAAKuJ,cACJH,GAAOA,EAAIjF,IACbnE,KAAKmE,GAAGsF,QAAQL,EAAIjF,IAGjBnE,O,6BAQF1C,GAAO,WACZ,QAAc0I,IAAV1I,EAIF,OAHAP,OAAO+D,KAAKxD,GAAOsD,SAAQ,SAAC8I,GAC1B,EAAKC,IAAID,EAAT,UAAepM,EAAMoM,GAArB,UAEK1J,KALG,MAOsBA,KAAKmE,GAA/ByF,EAPI,EAOJA,UAAWC,EAPP,EAOOA,WAPP,EAQ0B7J,KAAKmE,GAC3C,MAAO,CACLyC,IAAKgD,EACL9C,KAAM+C,EACNlG,OAZU,EAQJmG,aAKNrG,MAbU,EAQUsG,e,+BActB,OAAO/J,KAAKmE,GAAG6F,WACX,IAAI5B,EAAQpI,KAAKmE,GAAG6F,YAAc,O,+BAQ/BpN,GAIP,OAHKoD,KAAKuJ,cACRvJ,KAAKmE,GAAG8F,UAAUC,IAAItN,GAEjBoD,O,+BAQApD,GACP,OAAKoD,KAAKuJ,cACDvJ,KAAKmE,GAAG8F,UAAUE,SAASvN,K,wCAUpC,OAAOoD,KAAKmJ,WAAWhJ,OAAS,I,iCAQhC,OAAOH,KAAKwJ,gBAAgBrJ,OAAS,I,kCAQ3BvD,GAIV,OAHKoD,KAAKuJ,cACRvJ,KAAKmE,GAAG8F,UAAUG,OAAOxN,GAEpBoD,O,4BASP,OAAKA,KAAKuJ,aAGH,KAFEvJ,KAAKmE,GAAGkG,0B,8BAUjB,OAAKrK,KAAKuJ,aAGH,KAFEnB,EAAQc,YAAYlJ,KAAKmE,GAAGmG,c,6BAUrC,OAAKtK,KAAKuJ,aAGH,KAFEnB,EAAQc,YAAYlJ,KAAKmE,GAAGoG,a,sCASrC,GAAIvK,KAAKuJ,aACP,OAAOvJ,KAET,IAAIwK,EAAO,KAgBX,OAfa,SAATC,EAAUC,GACRA,EAAKC,YACPD,EAAKlB,gBAAgB5I,SAAQ,SAAC8J,GACf,OAATF,GACFC,EAAOC,MAIA,OAATF,GACEE,EAAKnB,eACPiB,EAAOE,GAIbD,CAAOzK,MACAwK,I,qCAOP,GAAIxK,KAAKuJ,aACP,OAAOvJ,KAET,IAAIwK,EAAO,KAgBX,OAfa,SAATC,EAAUC,GACRA,EAAKC,YACPD,EAAKlB,gBAAgBoB,UAAUhK,SAAQ,SAAC8J,GACzB,OAATF,GACFC,EAAOC,MAIA,OAATF,GACEE,EAAKnB,eACPiB,EAAOE,GAIbD,CAAOzK,MACAwK,I,+BAQa,IAAfjJ,EAAe,uDAAN,KACd,GAAIA,EACGvB,KAAKuJ,cACRvJ,KAAKmE,GAAG0G,YAAYtJ,EAAO4C,IAAM5C,OAE9B,CACL,IAAMhB,EAASP,KAAKO,SAChBA,GACFP,KAAKO,SAAS6J,OAAOpK,MAGzB,OAAOA,O,+BAQAoJ,GACP,OAAIpJ,KAAKuJ,cAGFvJ,KAAKmE,GAAGgG,SAASf,EAAIjF,M,6BAQ5B,OAAOnE,KAAKmE,GAAG2G,gBACX1C,EAAQc,YAAYlJ,KAAKmE,GAAG2G,iBAAmB,O,6BAQnD,OAAO9K,KAAKmE,GAAG4G,YACX3C,EAAQc,YAAYlJ,KAAKmE,GAAG4G,aAAe,O,+BASb,IAA7BC,IAA6B,yDAAhBC,EAAgB,uDAAV,SAKxB,OAJKjL,KAAKuJ,eACJyB,EAAMhL,KAAKkL,SAASD,GACnBjL,KAAKmL,YAAYF,IAEjBjL,O,2BAQJ8I,GACH,OAAI9I,KAAKuJ,aACAvJ,KAAKoL,iBAEDpF,IAAT8C,GACF9I,KAAKmE,GAAGkH,UAAYvC,EACb9I,MAEFA,KAAKmE,GAAGkH,Y,2BAQZC,GACH,OAAItL,KAAKuJ,aACAvJ,KAAKoL,iBAEDpF,IAATsF,GACFtL,KAAKmE,GAAGoH,UAAYD,EACbtL,MAEFA,KAAKmE,GAAGoH,Y,8BAUf,OAHKvL,KAAKuJ,cACRvJ,KAAKmE,GAAGqH,QAEHxL,O,6BAUP,OAHKA,KAAKuJ,cACRvJ,KAAKmE,GAAGsH,OAEHzL,O,iCAQEpC,GAIT,OAHKoC,KAAKuJ,cACRvJ,KAAKmE,GAAGuH,gBAAgB9N,GAEnBoC,O,4BAOH2L,GAIJ,OAHK3L,KAAKuJ,cACRvJ,KAAKqG,KAAK,QAASsF,GAEd3L,O,2BASJpC,EAAKN,GAAO,WACf,IAAK0C,KAAKuJ,aACR,QAAcvD,IAAV1I,EACE0C,KAAKmE,GAAGyH,cACV5L,KAAKmE,GAAGyH,aAAahO,EAAKN,OAEvB,CACL,GAAmB,iBAARM,EACT,OAAIoC,KAAKmE,GAAGyH,aACH5L,KAAKmE,GAAG0H,aAAajO,GAEvB,KAELoC,KAAKmE,GAAGyH,cACV7O,OAAO+D,KAAKlD,GAAKgD,SAAQ,SAAC8I,GACxB,EAAKvF,GAAGyH,aAAalC,EAAG9L,EAAI8L,OAKpC,OAAO1J,O,0BAQLe,GACF,OAAKf,KAAKuJ,kBAOAvD,IAANjF,EACKf,KAAKoL,YAEPpL,UATKgG,IAANjF,GACFf,KAAKmE,GAAG7G,MAAQyD,EACTf,MAEFA,KAAKmE,GAAG7G,Q,4BAajB,OAAO0C,KAAKmE,K,sCAQS,WACrB,IAAKnE,KAAKuJ,cACJvJ,KAAKmE,GAAGwH,MAAO,4BAFN7K,EAEM,yBAFNA,EAEM,gBACjBA,EAAKF,SAAQ,SAAC8I,GACR,EAAKvF,GAAGwH,OACV,EAAKxH,GAAGwH,MAAMG,eAAe1D,EAAQ2D,YAAYrC,OAKzD,OAAO1J,O,mCASIpC,EAAKN,GAChB,IAAK0C,KAAKuJ,cACJvJ,KAAKmE,GAAGwH,MAAO,CACjB,IAAM3N,EAAWoK,EAAQ2D,YAAYnO,GAE/BoO,EADgBhM,KAAKmE,GAAGwH,MAAMM,iBAAiBjO,GACtBkH,QAAQ5H,EAAO,IAC9C0C,KAAK2J,IAAI/L,EAAKoO,GAGlB,OAAOhM,O,0BASLpD,EAAMU,GAAO,WACf,IAAK0C,KAAKuJ,cACJvJ,KAAKmE,GAAGwH,MAAO,CACjB,QAAc3F,IAAV1I,GAAuC,iBAATV,EAKhC,OAJAG,OAAO+D,KAAKlE,GAAMgE,SAAQ,SAAChD,GACzB,IAAMI,EAAWoK,EAAQ2D,YAAYnO,GACrC,EAAKuG,GAAGwH,MAAMO,YAAYlO,EAAUpB,EAAKgB,OAEpCoC,KAET,QAAcgG,IAAV1I,EAAqB,CACvB,IAAMU,EAAWoK,EAAQ2D,YAAYnP,GAErC,OADAoD,KAAKmE,GAAGwH,MAAMO,YAAYlO,EAAUV,GAC7B0C,KAET,IAAMhC,EAAWoK,EAAQ2D,YAAYnP,GACrC,OAAOoD,KAAKmE,GAAGwH,MAAMM,iBAAiBjO,GAG1C,OAAO,O,sCAQP,OAAKgC,KAAKuJ,aAGH,KAFEpG,OAAOgJ,iBAAiBnM,KAAKmE,GAAI,Q,6BAU1C,IAAKnE,KAAKuJ,aAAc,CACtB,IAAMoC,EAAQ3L,KAAKoM,gBACfT,GAA2B,UAAlBA,EAAMU,SACjBrM,KAAK2J,IAAI,UAAW,SAGxB,OAAO3J,O,6BAQP,IAAKA,KAAKuJ,aAAc,CACtB,IAAMoC,EAAQ3L,KAAKoM,gBACfT,GAA2B,SAAlBA,EAAMU,SACjBrM,KAAK2J,IAAI,UAAW,QAGxB,OAAO3J,O,8BAQDE,EAAMoM,GACZ,IAAKtM,KAAKuJ,aACR,OAAQrJ,GACN,IAAK,QACH,IAAMqM,EAAM,IAAIC,WAAWtM,EAAM,CAC/BuM,OAAQH,EACRI,SAAS,EACTC,YAAY,IAEdJ,EAAIK,UAAU,SAAS,GAAM,GAC7B5M,KAAKmE,GAAG0I,cAAcN,GACtB,MAEF,QACE,IAAMA,EAAM,IAAIO,YAAY5M,EAAM,CAChCuM,OAAQH,EACRI,SAAS,EACTC,YAAY,IAEd3M,KAAKmE,GAAG0I,cAAcN,M,2BAYzBQ,GACH,IAAK/M,KAAKuJ,aAAc,CACtB,IAAMyD,EAAShN,KAAKmE,GAAG8I,iBAAiBF,GACxC,GAAIC,GAA4B,IAAlBA,EAAO7M,OACnB,OAAO,IAAIiI,EAAQ4E,EAAO,IAE5B,IAAMhI,EAAQ,GACd,GAAIgI,EAAQ,4BACV,YAAmBA,EAAnB,+CAA2B,KAAhBvL,EAAgB,QACzBuD,EAAM6D,KAAK,IAAIT,EAAQ3G,KAFf,mFAKZ,OAAOuD,EAET,MAAO,K,4BAQH+H,GACJ,IAAK/M,KAAKuJ,aAAc,CACtB,IAAMyD,EAAShN,KAAKmE,GAAG8I,iBAAiBF,GAClC/H,EAAQ,GACd,GAAIgI,EAAQ,4BACV,YAAmBA,EAAnB,+CAA2B,KAAhBvL,EAAgB,QACzBuD,EAAM6D,KAAK,IAAIT,EAAQ3G,KAFf,mFAKZ,OAAOuD,EAET,MAAO,K,gCAWP,IAHA,IAAIkI,EAAUlN,KAAKmE,GACb6I,EAAS,GAEuC,QAA9CE,EAAUA,EAAQC,yBAAkCH,EAAOnE,KAAK,IAAIT,EAAQ8E,IAGpF,IAFAA,EAAUlN,KAAKmE,GAEmC,QAA1C+I,EAAUA,EAAQE,qBAA8BJ,EAAOnE,KAAK,IAAIT,EAAQ8E,IAChF,OAAOF,I,gCAQP,OAAOhN,KAAKmE,GAAGkJ,SAASC,sB,kCAQxB,OAAOtN,KAAKmE,GAAGiH,Y,iCAQf,OAAOpL,KAAKmE,GAAGoJ,W,4BAOXnE,GAIJ,OAHIpJ,KAAKmE,IAAMiF,GAAOA,EAAIjF,IACxBnE,KAAKmE,GAAGqJ,MAAMpE,EAAIjF,IAEbnE,O,6BAOFoJ,GAIL,OAHIpJ,KAAKmE,IAAMiF,GAAOA,EAAIjF,IACxBnE,KAAKmE,GAAGsJ,OAAOrE,EAAIjF,IAEdnE,O,8BAOP,OAAO,IAAIoI,EAAQpI,KAAKmE,GAAGuJ,WAAU,M,8BAUrC,OAHK1N,KAAKuJ,cACRvJ,KAAKsL,KAAK,IAELtL,O,6BAQF2N,GACL,OAAO3N,KAAKmE,KAAOwJ,EAAMxJ,K,8BAOnB,WACF5D,EAASP,KAAKO,SACd2B,GAAS,EAOb,OANA3B,EAAOiJ,gBACJ5I,SAAQ,SAACG,EAAG1E,GACP0E,EAAE6M,OAAO,KACX1L,EAAQ7F,MAGP6F,I,yBAQNkH,GACD,OAAOpJ,KAAKmE,KAAOiF,EAAIjF,K,mCAQvB,MAA0B,UAAnBnE,KAAK6N,Y,oCAQZ,MAA0B,OAAnB7N,KAAK6N,Y,2CAQZ,OAAO7N,KAAKmE,cAAc2J,qB,KAKxBC,EAAI,SAAC1F,GAAD,IAAMC,EAAN,uDAAkB,GAAlB,OAAyB,IAAIF,EAAQC,EAAKC,IC5zB9C0F,GADgB,GAAH,OADD,UACC,kBACF,I,6TACjBA,EAASC,qBAAuB,CAC9BC,cAAe,eACfC,aAAc,eAEhBH,EAASI,kBAAoB,CAC3BC,WAAY,YACZC,WAAY,YACZC,aAAc,cACdC,OAAQ,SACRC,OAAQ,SACRC,SAAU,UACVC,MAAO,QACPC,SAAU,UACVC,OAAQ,QACRC,WAAY,YACZC,YAAa,aACbC,YAAa,QACbC,YAAa,aACbC,MAAO,QACPC,MAAO,QACPC,WAAY,YACZC,OAAQ,SACRC,kBAAmB,oBAErBtB,EAASuB,iBAAmB,CAC1BC,OAAQ,SACRC,gBAAiB,iBACjBC,kBAAmB,kBACnBC,iBAAkB,iBAClBC,aAAc,cACdC,WAAY,YACZC,WAAY,YACZC,YAAa,aACbC,WAAY,YACZC,WAAY,YACZC,YAAa,YACbC,YAAa,YACbC,aAAc,cACdC,iBAAkB,iBAClBC,iBAAkB,iBAClBC,YAAa,aACbC,YAAa,aACbC,cAAe,eACfC,YAAa,aACbC,cAAe,gBAEjB3C,EAAS4C,gBAAkB,CACzBC,oBAAqB,oBACrBC,mBAAoB,mBACpBC,mBAAoB,oB,ICahBC,EAAO,I,WA5DX,aAAc,UACZhR,KAAKgR,KAAO,G,yCAGP5H,EAAKlJ,EAAM+Q,EAAUC,GACtB9H,aAAehB,IACjBgB,EAAMA,EAAIjF,IAEZ,IAAM6I,EAAShN,KAAKoK,OAAOhB,EAAKlJ,EAAM+Q,EAAUC,GAC5ClE,EAAO7M,OACT6M,EAAOpM,SAAQ,SAACa,GACd2H,EAAI+H,oBAAoB1P,EAAKvB,KAAMuB,EAAKwP,SAAUxP,EAAKyP,WAGzD9H,EAAI+H,oBAAoBjR,EAAM+Q,EAAUC,K,2BAIvC9H,EAAKlJ,EAAM+Q,EAAUC,GACpB9H,aAAehB,IACjBgB,EAAMA,EAAIjF,IAEZnE,KAAKgR,KAAKnI,KAAK,CACbO,MAAKlJ,OAAM+Q,WAAUC,WAEvB9H,EAAIgI,iBAAiBlR,EAAM+Q,EAAUC,K,6BAGhC9H,GAAiD,IAA5ClJ,EAA4C,uDAArC,IAAK+Q,EAAgC,uDAArB,KAAMC,EAAe,uDAAN,KAC1CF,EAAO,GACPK,EAAM,GAaZ,OAZArR,KAAKgR,KAAKpQ,SAAQ,SAACa,GACjB,IAAM6P,EAASlI,IAAQ3H,EAAK2H,IACtBmI,EAAmB,OAAXL,GAAmBA,IAAWzP,EAAKyP,OAC3CM,EAAkB,MAATtR,GAAgBA,IAASuB,EAAKvB,KACvCuR,EAAsB,OAAbR,GAAqBA,IAAaxP,EAAKwP,SAClDK,GAAUE,GAAUC,GAAUF,EAChCF,EAAIxI,KAAKpH,GAETuP,EAAKnI,KAAKpH,MAGdzB,KAAKgR,KAAOA,EACLK,I,qCAGMK,EAAMxR,EAAM+Q,EAAUC,GAAQ,WAC3CQ,EAAK9Q,SAAQ,SAACa,GACZ,EAAKkQ,OAAOlQ,EAAMvB,EAAM+Q,EAAUC,Q,mCAIzBQ,EAAMxR,EAAM+Q,EAAUC,GAAQ,WACzCQ,EAAK9Q,SAAQ,SAACa,GACZ,EAAK5D,KAAK4D,EAAMvB,EAAM+Q,EAAUC,U,MAQhCU,E,gFAEUrQ,EAAQ3E,EAAMiV,GAAoB,IAAhBX,EAAgB,wDAM9C,OALInS,MAAMiC,QAAQO,GAChByP,EAAKc,eAAevQ,EAAQ3E,EAAMiV,EAAIX,GAEtCF,EAAKW,OAAOpQ,EAAQ3E,EAAMiV,EAAIX,GAEzB3P,I,2BAGGA,EAAQ3E,EAAMiV,GAAoB,IAAhBX,EAAgB,wDAM5C,OALInS,MAAMiC,QAAQO,GAChByP,EAAKe,aAAaxQ,EAAQ3E,EAAMiV,EAAIX,GAEpCF,EAAKnT,KAAK0D,EAAQ3E,EAAMiV,EAAIX,GAEvB3P,I,gCAGQA,GAA6D,IAArDyQ,EAAqD,uDAA1C,aAAUC,EAAgC,uDAAtB,aAAUC,EAAY,uDAAL,IACnEzH,EAAS0H,aAAY,WACvBH,MACCE,GACCE,EAAS,SAATA,EAAU7F,GACZ8F,cAAc5H,GACdmH,EAAOD,OAAOpQ,EAAQyM,EAASI,kBAAkBM,SAAU0D,GAAQ,GACnEH,EAAQ1F,IAEVyF,IACAJ,EAAO/T,KAAK0D,EAAQyM,EAASI,kBAAkBM,SAAU0D,GAAQ,K,kCAGhD7Q,GAAgD,IAAxC+Q,EAAwC,uDAA7B,aAAUC,EAAmB,uDAAV,aACjDC,EAAW,SAACjG,GAChB+F,EAAS/F,GACTA,EAAIkG,kBACJlG,EAAImG,kBAEAN,EAAS,SAATA,EAAU7F,GACdqF,EAAOD,OAAOpQ,EAAQyM,EAASI,kBAAkBC,WAAYmE,GAAU,GACvEZ,EAAOD,OAAOpQ,EAAQyM,EAASI,kBAAkBM,SAAU0D,GAAQ,GACnEG,EAAOhG,GACPA,EAAImG,kBAIN,OAFAd,EAAO/T,KAAK0D,EAAQyM,EAASI,kBAAkBC,WAAYmE,GAAU,GACrEZ,EAAO/T,KAAK0D,EAAQyM,EAASI,kBAAkBM,SAAU0D,GAAQ,GAC1D7Q,M,uqCAKXqQ,EAAOe,YAAc,CACnBC,YAAa,SAAC3B,GACZ,IAAI4B,EAAY,EACZC,EAAY,EACZC,EAAW,EACf,OAAO,SAACC,GACN,GAAqB,IAAjBA,EAAMC,OAIR,OAHAJ,EAAY,EACZE,EAAW,OACXD,EAAY,GAJE,IAORI,EAAiBF,EAAjBE,MAAOC,EAAUH,EAAVG,MACTC,EAAU5T,KAAKgE,MACJ4P,EAAUL,GAAY,KACrBG,IAAUL,GACVM,IAAUL,GAE1B7B,EAAS+B,GACTD,EAAW,EACXF,EAAY,EACZC,EAAY,IAEZD,EAAYK,EACZJ,EAAYK,EACZJ,EAAWK,KAIjBC,WAAY,SAAApC,GAAQ,OAAI,SAAC+B,GACvB/B,EAAS+B,M,ICnIPM,E,YAQJ,aAAkE,MAAtDhL,EAAsD,uDAA1C,GAAIiF,EAAsC,uDAA3B,MAAOgG,EAAoB,0EAE9D,SADuB,iBAAdjL,EACT,eAAMiF,EAAN,UF5BY,UE4BZ,mBAAuCjF,IAEvC,eAAMA,KAEHiL,WAAaA,EAN8C,K,sDAcrDC,GAEX,IADA,IAAIC,EAAOzT,MACH+N,EAAElK,SAAS6P,MAAMC,GAAGF,IAAO,CACjC,GAAIA,EAAKG,SAASJ,GAChB,OAAOC,EAETA,EAAOA,EAAKlT,SAEd,OAAO,O,sCAQP,IADA,IAAIA,EAASP,KAAK6T,KAAK,UAChBtT,IAAWA,EAAOgT,YACvBhT,EAASA,EAAOsT,KAAK,UAEvB,OAAOtT,I,+DAcPqR,EAAOD,OAAO3R,Q,6BAQT8T,GACL9T,KAAKwJ,cAAcsK,GACnBA,EAAOC,aAAa/T,MACpB8T,EAAOE,SAAShU,Q,mCAOL8T,GACX,OAAIA,GACF9T,KAAK6T,KAAK,SAAUC,GACb9T,MAEFA,KAAK6T,KAAK,Y,8BAUXb,GAAoB,IAAbtI,EAAa,uDAAN1K,KAAM,EACJ0K,EAAKuJ,MAAnBrN,EADkB,EAClBA,IAAKE,EADa,EACbA,KACb,MAAO,CACLrE,EAAGuQ,EAAMkB,QAAUtN,EACnBpE,EAAGwQ,EAAMmB,QAAUrN,K,gCAQrB9G,KAAK2R,SACL3R,KAAKoK,a,4IA9GUhC,I,y4BCLbgM,E,YAEJ,aAA4B,MAAhB9L,EAAgB,uDAAJ,GAAI,kBAC1B,kCHPc,UGOd,YACK+L,WAAatG,EAAE,MAAD,UHRL,UGQK,qBAAiCzF,IACpD,EAAKkB,cAAc,EAAK6K,YAHE,E,gSAMnB5Q,GACPzD,KAAKqU,WAAW1K,IAAI,QAApB,UAAgClG,EAAhC,S,gCAGQE,GACR3D,KAAKqU,WAAW1K,IAAI,SAApB,UAAiChG,EAAjC,Y,8BAbe2P,G,0gCCInB,IAAIgB,EAAY,GAOVC,E,YAMJ,WAAYC,GAAS,a,4FAAA,SACnB,E,qEAAA,+BJtBc,UIsBd,iBACAF,EAAUzL,KAAV,MACA,EAAK2L,QAAU9U,EAAWwB,KAAK,CAC7BuT,SAAUF,EAAUG,oBAAoBC,QACvCH,GACH,EAAKI,QAAS,EACd,EAAKC,KAAO9G,EAAE,MAAD,UJ5BC,UI4BD,qBACb,EAAK+G,QAAU/G,EAAE,MAAD,UJ7BF,UI6BE,wBAChB,iDAAoB,EAAK+G,SACzB,EAAKjX,OAVc,E,qSA2HCkX,GACpB,IAAMC,EAAS,GACfV,EAAU1T,SAAQ,SAACa,GACbA,IAASsT,GACXC,EAAOnM,KAAKpH,MAGhB6S,EAAYU,I,iCAOe,IAAbA,EAAa,uDAAJ,GACvBV,EAAU1T,SAAQ,SAACa,IACa,IAA1BuT,EAAOnQ,QAAQpD,IACjBA,EAAKwT,e,gCA3HT,IAAMC,EAAOlV,KAAKmV,gBACVN,EAAS7U,KAAT6U,KAOR,OANoB,IAAhB7U,KAAK4U,QAAoBM,IAC3BlV,KAAK4U,QAAS,EACdM,EAAK1L,cAAcqL,GACnBK,EAAK1L,cAAcxJ,MACnBA,KAAKoV,qBAEApV,O,8BAOP,IAAMkV,EAAOlV,KAAKmV,gBAClB,IAAoB,IAAhBnV,KAAK4U,QAAmBM,EAAM,KACxBL,EAAS7U,KAAT6U,KACR7U,KAAK4U,QAAS,EACdM,EAAK9K,OAAOpK,MACZkV,EAAK9K,OAAOyK,GAEd,OAAO7U,O,+BAMA,IACC6U,EAAS7U,KAAT6U,KACRjD,EAAOD,OAAOkD,K,6BAMT,WACGA,EAAS7U,KAAT6U,KACRjD,EAAO/T,KAAKgX,EAAM7G,EAASI,kBAAkBE,YAAY,SAACvO,GACxD,EAAKkV,QACLlV,EAAE0S,qBAEJb,EAAO/T,KAAKmC,KAAMgO,EAASI,kBAAkBE,YAAY,SAAC+G,GACxD,GAAoB,IAAhBA,EAAKpC,OAAT,CACA,IAAMqC,EAAc,EAAKC,QAAQF,EAAM,GACvCzD,EAAO4D,YAAYzH,EAAElK,WAAW,SAAC4R,GAE/B,IAAM7O,EAAM6O,EAAKtC,MAAQmC,EAAY7S,EAC/BqE,EAAO2O,EAAKvC,MAAQoC,EAAY9S,EACtC,EAAKkT,OAAO,CAAE9O,MAAKE,SACnB2O,EAAKhD,qBAEP4C,EAAK5C,wB,0CAQP,IAAMyC,EAAOlV,KAAKmV,gBAEVV,EADYzU,KAAZwU,QACAC,SACFkB,EAAUT,EAAKjB,MACf2B,EAAU5V,KAAKiU,MACrB,OAAQQ,GACN,KAAKF,EAAUG,oBAAoBmB,KAEnC,KAAKtB,EAAUG,oBAAoBoB,MAEnC,KAAKvB,EAAUG,oBAAoBqB,IACjC,MACF,KAAKxB,EAAUG,oBAAoBC,OACjC3U,KAAK0V,OAAO,CACV5O,KAAM6O,EAAQlS,MAAQ,EAAImS,EAAQnS,MAAQ,EAC1CmD,IAAK+O,EAAQhS,OAAS,EAAIiS,EAAQjS,OAAS,IAKjD,OAAO3D,O,sCAQc,MAErB,OADA,EAAAA,KAAK8U,SAAQtL,cAAb,mBACOxJ,O,gCAOP,4CACAA,KAAK2R,SACL4C,EAAUyB,eAAehW,W,8BA1HLsT,G,0gCAyJxBiB,EAAUG,oBAAsB,CAC9BmB,KAAM,EACNE,IAAK,EACLD,MAAO,EACPnB,OAAQ,G,ICpKJsB,E,YAEJ,WAAYzB,GAAS,a,4FAAA,UACnB,E,qEAAA,+BLXc,UKWd,oBACKA,QAAU9U,EAAWwB,KAAK,CAC7BgV,SAAU,cACT1B,GAEH,EAAK2B,WAAY,IAAI5B,GAAYR,aAAhB,MACjB,EAAKrM,MAAQ,CAAC,IAAK,EAAG,KAEtB,EAAK0O,kBAAoBrI,EAAE,MAAD,ULnBZ,UKmBY,uCAC1B,EAAKsI,eAAiBtI,EAAE,MAAD,ULpBT,UKoBS,mCACvB,EAAKsI,eAAevN,KAAK,WACzB,EAAKwN,WAAavI,EAAE,QAAD,ULtBL,UKsBK,8BACnB,EAAKnH,IAAMmH,EAAE,MAAD,ULvBE,UKuBF,sBACZ,EAAKnH,IAAI4C,cAAc,EAAK4M,mBAC5B,EAAKxP,IAAI4C,cAAc,EAAK6M,gBAC5B,EAAKzP,IAAI4C,cAAc,EAAK8M,YAE5B,EAAKC,iBAAmBxI,EAAE,MAAD,UL5BX,UK4BW,qCACzB,EAAKyI,iBAAmBzI,EAAE,MAAD,UL7BX,UK6BW,0CACzB,EAAK0I,iBAAmB1I,EAAE,MAAD,UL9BX,UK8BW,0CACzB,EAAK2I,iBAAmB3I,EAAE,MAAD,UL/BX,UK+BW,0CACzB,EAAKvH,OAASuH,EAAE,MAAD,ULhCD,UKgCC,yBACf,EAAKvH,OAAOgD,cAAc,EAAKgN,kBAC/B,EAAKhQ,OAAOgD,cAAc,EAAKiN,kBAC/B,EAAKjQ,OAAOgD,cAAc,EAAKkN,kBAC/B,EAAKlQ,OAAOgD,cAAc,EAAK+M,kBAE/B,EAAKI,aAAe5I,EAAE,MAAD,ULtCP,UKsCO,iCACrB,EAAK6I,SAAW7I,EAAE,MAAD,ULvCH,UKuCG,4BACjB,EAAK8I,cAAgB9I,EAAE,MAAD,ULxCR,UKwCQ,4BACtB,EAAKlH,OAASkH,EAAE,MAAD,ULzCD,UKyCC,yBACf,EAAK4I,aAAa7N,KAAK,OACvB,EAAK8N,SAASpN,cAAc,EAAKqN,eACjC,EAAKhQ,OAAO2C,cAAc,EAAKmN,cAC/B,EAAK9P,OAAO2C,cAAc,EAAKoN,UAE/B,EAAKE,aAAe/I,EAAE,MAAD,UL/CP,UK+CO,gCACrB,EAAKgJ,aAAehJ,EAAE,MAAD,ULhDP,UKgDO,gCACrB,EAAKiJ,QAAUjJ,EAAE,MAAD,ULjDF,UKiDE,0BAChB,EAAK+I,aAAahO,KAAK,MACvB,EAAKiO,aAAajO,KAAK,MACvB,EAAKkO,QAAQxN,cAAc,EAAKuN,cAChC,EAAKC,QAAQxN,cAAc,EAAKsN,cAChC,EAAKtN,cAAc,EAAK5C,KACxB,EAAK4C,cAAc,EAAKhD,QACxB,EAAKgD,cAAc,EAAK3C,QACxB,EAAK2C,cAAc,EAAKwN,SACxB,EAAKb,UAAU3M,cAAf,MACA,EAAK2M,UAAUxM,IAAI,aAAc,WACjC,EAAK9L,OAlDc,E,6RAkQPoZ,GACZ,IAAMzV,EAAM,EAAIyV,EAAI9W,OACpB,GAAIqB,EAAM,EAAG,CAEX,IADA,IAAM1E,EAAI,GACDT,EAAI,EAAGA,EAAImF,EAAKnF,GAAK,EAC5BS,EAAE+L,KAAK,KAET/L,EAAE+L,KAAKoO,GAEPA,EAAMna,EAAEoa,KAAK,IAEf,OAAOD,I,6BAGKE,GACZ,MAAO,CACLpJ,EAAGzP,KAAK2E,IAAI,IAAK3E,KAAK8Y,IAAI,EAAGD,EAAIpJ,IACjC3P,EAAGE,KAAK2E,IAAI,IAAK3E,KAAK8Y,IAAI,EAAGD,EAAI/Y,IACjCoE,EAAGlE,KAAK2E,IAAI,IAAK3E,KAAK8Y,IAAI,EAAGD,EAAI3U,O,4BAIxB6U,GACX,OAAOA,EAAIC,WAAW,S,4BAGXL,GACX,OAAOA,EAAIK,WAAW,O,6BAGVD,GACZ,GAAI3X,EAAWuF,SAASoS,GAAM,CAC5B,GAAIrX,KAAKuX,MAAMF,GAAM,CACnB,IAAMtW,EAAIkV,EAAYuB,SAASH,GAC/BA,EAAM,OAAH,OAAUtW,EAAE5D,EAAZ,aAAkB4D,EAAE0W,EAApB,aAA0B1W,EAAE2W,EAA5B,KAEL,IAAM1K,EAASiJ,EAAY0B,SAASN,GAEpC,MAAY,KADQrK,EAAZ7P,EACkB,KADN6P,EAATyK,EAC6B,KADpBzK,EAAN0K,GACoC,IAEpD,OAAO,I,+BAGOT,GAId,MAAO,CAAE9Z,GAFT8Z,EAAMhV,SAAWgV,EAAIpS,QAAQ,MAAQ,EAAKoS,EAAIxY,UAAU,GAAKwY,EAAM,MAEhD,GAAIQ,GAAU,MAANR,IAAmB,EAAGS,EAAU,IAANT,K,+BAGvCA,GACd,OAAOjX,KAAK4X,SAAS5X,KAAKwX,SAASP,M,+BAGrBI,GACd,IAAMQ,EAAM,CAAE9J,EAAG,EAAG3P,EAAG,EAAGoE,EAAG,GACvBS,EAAM3E,KAAK2E,IAAIoU,EAAIla,EAAGka,EAAII,EAAGJ,EAAIK,GACjCN,EAAM9Y,KAAK8Y,IAAIC,EAAIla,EAAGka,EAAII,EAAGJ,EAAIK,GACjCI,EAAQV,EAAMnU,EAYpB,OAXA4U,EAAIrV,EAAI4U,EACRS,EAAIzZ,EAAY,IAARgZ,EAAY,IAAMU,EAAQV,EAAM,EAC1B,IAAVS,EAAIzZ,EACFiZ,EAAIla,IAAMia,EAAKS,EAAI9J,GAAKsJ,EAAII,EAAIJ,EAAIK,GAAKI,EACpCT,EAAII,IAAML,EAAKS,EAAI9J,EAAI,GAAKsJ,EAAIK,EAAIL,EAAIla,GAAK2a,EACjDD,EAAI9J,EAAI,GAAKsJ,EAAIla,EAAIka,EAAII,GAAKK,EAC9BD,EAAI9J,GAAK,EAChB8J,EAAI9J,GAAK,GACL8J,EAAI9J,EAAI,IAAG8J,EAAI9J,GAAK,KACxB8J,EAAIzZ,GAAK,IAAM,IACfyZ,EAAIrV,GAAK,IAAM,IACRqV,I,+BAGOA,GACd,IAAMR,EAAM,GACNtJ,EAAM8J,EAAN9J,EACA3P,EAAY,IAARyZ,EAAIzZ,EAAU,IAClB2C,EAAY,IAAR8W,EAAIrV,EAAU,IACxB,GAAU,IAANpE,EACFiZ,EAAIla,EAAI4D,EACRsW,EAAII,EAAI1W,EACRsW,EAAIK,EAAI3W,MACH,CACL,IAAMgX,EAAKhX,EACLiX,GAAM,IAAM5Z,GAAK2C,EAAI,IACrBkX,EAAkBlK,EAAI,IAAhBgK,EAAKC,GAAiB,GACxB,MAANjK,IAAWA,EAAI,GACfA,EAAI,IACNsJ,EAAIla,EAAI4a,EACRV,EAAIK,EAAIM,EACRX,EAAII,EAAIO,EAAKC,GACJlK,EAAI,KACbsJ,EAAII,EAAIM,EACRV,EAAIK,EAAIM,EACRX,EAAIla,EAAI4a,EAAKE,GACJlK,EAAI,KACbsJ,EAAII,EAAIM,EACRV,EAAIla,EAAI6a,EACRX,EAAIK,EAAIM,EAAKC,GACJlK,EAAI,KACbsJ,EAAIK,EAAIK,EACRV,EAAIla,EAAI6a,EACRX,EAAII,EAAIM,EAAKE,GACJlK,EAAI,KACbsJ,EAAIK,EAAIK,EACRV,EAAII,EAAIO,EACRX,EAAIla,EAAI6a,EAAKC,GACJlK,EAAI,KACbsJ,EAAIla,EAAI4a,EACRV,EAAII,EAAIO,EACRX,EAAIK,EAAIK,EAAKE,IAEbZ,EAAIla,EAAI,EACRka,EAAII,EAAI,EACRJ,EAAIK,EAAI,GAGZ,MAAO,CAAEva,EAAGmB,KAAK4Z,MAAMb,EAAIla,GAAIsa,EAAGnZ,KAAK4Z,MAAMb,EAAII,GAAIC,EAAGpZ,KAAK4Z,MAAMb,EAAIK,M,+BAGzDL,GACd,IAAMJ,EAAM,CACVI,EAAIla,EAAEqB,SAAS,IACf6Y,EAAII,EAAEjZ,SAAS,IACf6Y,EAAIK,EAAElZ,SAAS,KAOjB,OALAyY,EAAIrW,SAAQ,SAACkB,EAAKqW,GACG,IAAfrW,EAAI3B,SACN8W,EAAIkB,GAAJ,WAAcrW,OAGXmV,EAAIC,KAAK,M,+BAGFW,GACd,OAAO7X,KAAKoY,SAASpY,KAAKqY,SAASR,M,+BAGrBR,GACd,IACMrK,EAASqK,EAAItS,MADP,oCAEZ,MAAO,CACL5H,EAAG8E,SAAS+K,EAAO,GAAI,IACvByK,EAAGxV,SAAS+K,EAAO,GAAI,IACvB0K,EAAGzV,SAAS+K,EAAO,GAAI,O,oCAINqK,GAA0B,IAArB9R,EAAqB,uDAAN,KACvC,GAAI8R,EAAK,CACP,GAAIrX,KAAKuX,MAAMF,GACb,OAAOA,EAAI5Y,UAAU,GAEvB,IAAMnB,EAAQ0C,KAAK2X,SAASN,GAC5B,OAAOrX,KAAKoY,SAAS9a,GAEvB,OAAOiI,I,oCAGY0R,GAA0B,IAArB1R,EAAqB,uDAAN,KACvC,GAAI0R,EAAK,CACP,IAAMI,EAAMpB,EAAYuB,SAASP,GACjC,oBAAcI,EAAIla,EAAlB,YAAuBka,EAAII,EAA3B,YAAgCJ,EAAIK,EAApC,KAEF,OAAOnS,M,kCAjXA,IACCgR,EAAqBvW,KAArBuW,iBACAM,EAAkB7W,KAAlB6W,cAENP,EACEtW,KADFsW,WAAYQ,EACV9W,KADU8W,aAAcC,EACxB/W,KADwB+W,aAE5BnF,EAAOD,OAAO2E,GACd1E,EAAOD,OAAO2E,GACd1E,EAAOD,OAAOkF,GACdjF,EAAOD,OAAO4E,GACd3E,EAAOD,OAAOmF,GACdlF,EAAOD,OAAOoF,K,6BAGT,WACGR,EAA6BvW,KAA7BuW,iBAAkB/P,EAAWxG,KAAXwG,OAClBqQ,EAA4B7W,KAA5B6W,cAAeD,EAAa5W,KAAb4W,SAErBN,EACEtW,KADFsW,WAAYQ,EACV9W,KADU8W,aAAcC,EACxB/W,KADwB+W,aAE5BnF,EAAO/T,KAAKyY,EAAYtI,EAASI,kBAAkBE,YAAY,SAACgK,GAC9DA,EAAG7F,qBAELb,EAAO/T,KAAKyY,EAAYtI,EAASI,kBAAkBiB,QAAQ,WACzD,IAAM/R,EAAQgZ,EAAWxU,MACrBxE,GACF,EAAKib,SAASjb,MAGlBsU,EAAO/T,KAAKgZ,EAAe7I,EAASI,kBAAkBE,YAAY,SAACgK,GACjE,IAAME,EAAK,EAAKjD,QAAQ+C,EAAI1B,GACtB6B,EAAc7B,EAAS3C,MACzBuE,EAAGhW,EAAI,IAAGgW,EAAGhW,EAAI,GACjBgW,EAAGhW,EAAIiW,EAAYhV,QAAO+U,EAAGhW,EAAIiW,EAAYhV,OACjD,EAAKiV,QAAQF,EAAGhW,EAAGiW,EAAYhV,OAC/BmO,EAAO4D,YAAYzH,EAAElK,WAAW,SAAC8U,GAC/B,IAAMH,EAAK,EAAKjD,QAAQoD,EAAI/B,GACtB6B,EAAc7B,EAAS3C,MACzBuE,EAAGhW,EAAI,IAAGgW,EAAGhW,EAAI,GACjBgW,EAAGhW,EAAIiW,EAAYhV,QAAO+U,EAAGhW,EAAIiW,EAAYhV,OACjD,EAAKmV,QAAQJ,EAAGhW,EAAGiW,EAAYhV,UAEjC6U,EAAG7F,qBAELb,EAAO/T,KAAK0Y,EAAkBvI,EAASI,kBAAkBE,YAAY,SAACgK,GACpE,IAAME,EAAK,EAAKjD,QAAQ+C,EAAI9R,GACtBqS,EAAYrS,EAAOyN,MACrBuE,EAAGhW,EAAI,IAAGgW,EAAGhW,EAAI,GACjBgW,EAAGhW,EAAIqW,EAAUpV,QAAO+U,EAAGhW,EAAIqW,EAAUpV,OACzC+U,EAAG/V,EAAI,IAAG+V,EAAG/V,EAAI,GACjB+V,EAAG/V,EAAIoW,EAAUlV,SAAQ6U,EAAG/V,EAAIoW,EAAUlV,QAC9C,EAAKmV,WAAWN,EAAGhW,EAAGgW,EAAG/V,EAAGoW,EAAUpV,MAAOoV,EAAUlV,QACvDiO,EAAO4D,YAAYzH,EAAElK,WAAW,SAAC8U,GAC/B,IAAMH,EAAK,EAAKjD,QAAQoD,EAAInS,GACxBgS,EAAGhW,EAAI,IAAGgW,EAAGhW,EAAI,GACjBgW,EAAGhW,EAAIqW,EAAUpV,QAAO+U,EAAGhW,EAAIqW,EAAUpV,OACzC+U,EAAG/V,EAAI,IAAG+V,EAAG/V,EAAI,GACjB+V,EAAG/V,EAAIoW,EAAUlV,SAAQ6U,EAAG/V,EAAIoW,EAAUlV,QAC9C,EAAKoV,WAAWP,EAAGhW,EAAGgW,EAAG/V,EAAGoW,EAAUpV,MAAOoV,EAAUlV,WAEzD2U,EAAG7F,qBAELb,EAAO/T,KAAKiZ,EAAc9I,EAASI,kBAAkBc,OAAO,WAC1D,EAAK+F,WAEPrD,EAAO/T,KAAKkZ,EAAc/I,EAASI,kBAAkBc,OAAO,WAAM,IACxDxH,EAAU,EAAVA,MACFmQ,EAAM5B,EAAY+C,OAAO,CAC7BjL,EAAG9L,SAASyF,EAAM,GAAI,IACtBtJ,EAAG6D,SAASyF,EAAM,GAAI,IACtBlF,EAAGP,SAASyF,EAAM,GAAI,MAElB2P,EAAMpB,EAAYoC,SAASR,GACjC,EAAKrD,QAAQ0B,SAAb,cAA6BmB,EAAIla,EAAjC,YAAsCka,EAAII,EAA1C,YAA+CJ,EAAIK,EAAnD,MACA,EAAKzC,a,2BAIJgC,GAGH,GAFsBjX,KAAdmW,UACE8C,OACNhC,EAAK,CACP,GAAIhB,EAAYiD,MAAMjC,GAAM,CAC1B,IAAMI,EAAMpB,EAAY0B,SAASV,GAEjCA,EAAMhB,EAAYmC,SAASf,GAE7BrX,KAAKuY,SAAStB,QAEdjX,KAAKmZ,SAEP,OAAOnZ,O,8BAMP,OAFsBA,KAAdmW,UACElB,QACHjV,O,qCAGM6X,GAAK,IAEVjB,EAA4B5W,KAA5B4W,SAAUC,EAAkB7W,KAAlB6W,cACZuC,EAAmBvC,EAAc5C,MACjCwE,EAAc7B,EAAS3C,MACzBoF,EAAoBpX,SAASwW,EAAYhV,MAAQgV,EAAYhV,MAAQoU,EAAI9J,EAAI,IAAK,IACtFsL,GAAqBD,EAAiB3V,MAAQ,EAC9CoT,EAAcnB,OAAO,CACnB5O,KAAMuS,IARU,IAWV7S,EAA6BxG,KAA7BwG,OAAQ+P,EAAqBvW,KAArBuW,iBACV+C,EAAsB/C,EAAiBtC,MACvC4E,EAAYrS,EAAOyN,MACrBsF,EAAuBtX,SAAS4W,EAAUpV,MAAQoU,EAAIzZ,EAAI,IAAK,IAC/Dob,EAAsBvX,SAAS4W,EAAUlV,QAAU,IAAMkU,EAAIrV,GAAK,IAAK,IAC3E+W,GAAwBD,EAAoB7V,MAAQ,EACpD+V,GAAuBF,EAAoB3V,OAAS,EACpD4S,EAAiBb,OAAO,CACtB5O,KAAMyS,EACN3S,IAAK4S,M,kCAIG,IACF9R,EAAU1H,KAAV0H,MACFmQ,EAAM5B,EAAY+C,OAAO,CAC7BjL,EAAG9L,SAASyF,EAAM,GAAI,IACtBtJ,EAAG6D,SAASyF,EAAM,GAAI,IACtBlF,EAAGP,SAASyF,EAAM,GAAI,MAGtBmP,EACE7W,KADF6W,cAAeN,EACbvW,KADauW,iBAAkBH,EAC/BpW,KAD+BoW,kBAAmBI,EAClDxW,KADkDwW,iBAAkBF,EACpEtW,KADoEsW,WAElEmD,EAAaxD,EAAYyD,SAAS7B,GAClC8B,EAAiB1D,EAAYyD,SAAS,CAAE3L,EAAG8J,EAAI9J,EAAG3P,EAAG,IAAKoE,EAAG,MACnE+T,EAAiB5M,IAAI,kBAArB,WAA4C8P,IAC5CrD,EAAkBzM,IAAI,kBAAtB,WAA6C8P,IAC7C5C,EAAclN,IAAI,kBAAlB,WAAyCgQ,IACzCnD,EAAiB7M,IAAI,kBAArB,WAA4CgQ,IAC5CrD,EAAWxU,IAAX,WAAmB2X,IACnBzZ,KAAK4Z,eAAe/B,K,qCAGP,IACLnQ,EAAU1H,KAAV0H,MACFmQ,EAAM5B,EAAY+C,OAAO,CAC7BjL,EAAG9L,SAASyF,EAAM,GAAI,IACtBtJ,EAAG6D,SAASyF,EAAM,GAAI,IACtBlF,EAAGP,SAASyF,EAAM,GAAI,MAEhB0O,EAAoDpW,KAApDoW,kBAAmBG,EAAiCvW,KAAjCuW,iBAAkBD,EAAetW,KAAfsW,WACvCmD,EAAaxD,EAAYyD,SAAS7B,GACxCtB,EAAiB5M,IAAI,kBAArB,WAA4C8P,IAC5CrD,EAAkBzM,IAAI,kBAAtB,WAA6C8P,IAC7CnD,EAAWxU,IAAX,WAAmB2X,IACnBzZ,KAAK4Z,eAAe/B,K,+BAIpB7X,KAAK6Z,YACL7Z,KAAK8Z,iB,iCAGItX,EAAGC,EAAGgB,EAAOE,GAAQ,IACtB+D,EAAU1H,KAAV0H,MACRA,EAAM,GAAKzF,SAAS,IAAMO,EAAIiB,EAAO,IACrCiE,EAAM,GAAKzF,SAAS,KAAO0B,EAASlB,GAAKkB,EAAQ,IACjD3D,KAAK8Z,iB,iCAGItX,EAAGC,EAAGgB,EAAOE,GAAQ,IACtB+D,EAAU1H,KAAV0H,MACRA,EAAM,GAAKzF,SAAS,IAAO3D,KAAK8Y,IAAI,EAAG9Y,KAAK2E,IAAIQ,EAAOjB,IAAOiB,EAAO,IACrEiE,EAAM,GAAKzF,SAAS,KAAO0B,EAASrF,KAAK8Y,IAAI,EAAG9Y,KAAK2E,IAAIU,EAAQlB,KAAOkB,EAAQ,IAChF3D,KAAK8Z,iB,8BAGCtX,EAAGiB,GACSzD,KAAV0H,MACF,GAAKzF,SAAS,KAAOwB,EAAQjB,GAAKiB,EAAO,IAC/CzD,KAAK6Z,c,8BAGCrX,EAAGiB,GACSzD,KAAV0H,MACF,GAAKzF,SAAS,KAAOwB,EAAQnF,KAAK8Y,IAAI,EAAG9Y,KAAK2E,IAAIQ,EAAOjB,KAAOiB,EAAO,IAC7EzD,KAAK6Z,c,+BAGE5C,GAAK,IACJvP,EAAU1H,KAAV0H,MACFsF,EAASiJ,EAAY8D,SAAS9D,EAAY+D,OAAO/C,IACvDvP,EAAM,GAAKsF,EAAOe,EAClBrG,EAAM,GAAKsF,EAAO5O,EAClBsJ,EAAM,GAAKsF,EAAOxK,EAClBxC,KAAKmZ,W,gCAIL,4CACAnZ,KAAK2R,SACL3R,KAAKmW,UAAU8D,e,8BAjQO3G,G,izBCFpB4G,G,YAEJ,WAAY1F,GAAS,a,4FAAA,UACnB,oCNTc,UMSd,wBACKA,QAAU9U,EAAWwB,KAAK,CAC7BwG,MAAO,KACPyS,KAAM,MACL3F,GACH,EAAK2F,KAAO,EAAK3F,QAAQ2F,KACzB,EAAKzS,MAAQhI,EAAW0a,WAAW,EAAK5F,QAAQ9M,OAC5C,EAAKyS,MACP,EAAK3Q,cAAc,EAAKgL,QAAQ2F,MAE9B,EAAKzS,QACP,EAAKiC,IAAI,kBAAmB,EAAKjC,OAC7BuO,EAAYoE,OAAO,EAAK7F,QAAQ9M,QAClC,EAAK4S,YAAc,IAAIlG,EAAK,gBAC5B,EAAK5K,cAAc,EAAK8Q,eAExB,EAAKA,YAAc,IAAIlG,EAAK,iBAC5B,EAAK5K,cAAc,EAAK8Q,cAE1B,EAAKA,YAAYC,QApBA,E,kSAwBXC,GACJxa,KAAKsa,cACHE,EACFxa,KAAKsa,YAAYG,OAEjBza,KAAKsa,YAAYC,a,gCA/BDjH,G,8lCCAlBoH,G,YAEJ,WAAYlG,GAAS,a,4FAAA,UACnB,oCPTc,UOSd,mBACKA,QAAU9U,EAAWwB,KAAK,CAC7ByZ,OAAQ,CACN,IAAIT,GAAU,CAAExS,MAAO,iBACvB,IAAIwS,GAAU,CAAExS,MAAO,oBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBAEvB,IAAIwS,GAAU,CAAExS,MAAO,mBACvB,IAAIwS,GAAU,CAAExS,MAAO,mBACvB,IAAIwS,GAAU,CAAExS,MAAO,qBACvB,IAAIwS,GAAU,CAAExS,MAAO,qBACvB,IAAIwS,GAAU,CAAExS,MAAO,mBACvB,IAAIwS,GAAU,CAAExS,MAAO,qBACvB,IAAIwS,GAAU,CAAExS,MAAO,sBACvB,IAAIwS,GAAU,CAAExS,MAAO,mBACvB,IAAIwS,GAAU,CAAExS,MAAO,qBACvB,IAAIwS,GAAU,CAAExS,MAAO,qBAEvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBAEvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBAEvB,IAAIwS,GAAU,CAAExS,MAAO,qBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBACvB,IAAIwS,GAAU,CAAExS,MAAO,uBAEvB,IAAIwS,GAAU,CAAExS,MAAO,oBACvB,IAAIwS,GAAU,CAAExS,MAAO,mBACvB,IAAIwS,GAAU,CAAExS,MAAO,sBACvB,IAAIwS,GAAU,CAAExS,MAAO,sBACvB,IAAIwS,GAAU,CAAExS,MAAO,sBACvB,IAAIwS,GAAU,CAAExS,MAAO,sBACvB,IAAIwS,GAAU,CAAExS,MAAO,sBACvB,IAAIwS,GAAU,CAAExS,MAAO,sBACvB,IAAIwS,GAAU,CAAExS,MAAO,sBACvB,IAAIwS,GAAU,CAAExS,MAAO,sBAEvB,IAAIwS,GAAU,CAAExS,MAAO,qBACvB,IAAIwS,GAAU,CAAExS,MAAO,mBACvB,IAAIwS,GAAU,CAAExS,MAAO,oBACvB,IAAIwS,GAAU,CAAExS,MAAO,qBACvB,IAAIwS,GAAU,CAAExS,MAAO,qBACvB,IAAIwS,GAAU,CAAExS,MAAO,oBACvB,IAAIwS,GAAU,CAAExS,MAAO,qBACvB,IAAIwS,GAAU,CAAExS,MAAO,qBACvB,IAAIwS,GAAU,CAAExS,MAAO,qBACvB,IAAIwS,GAAU,CAAExS,MAAO,qBAEvB,IAAIwS,GAAU,CAAExS,MAAO,mBACvB,IAAIwS,GAAU,CAAExS,MAAO,mBACvB,IAAIwS,GAAU,CAAExS,MAAO,oBACvB,IAAIwS,GAAU,CAAExS,MAAO,oBACvB,IAAIwS,GAAU,CAAExS,MAAO,oBACvB,IAAIwS,GAAU,CAAExS,MAAO,oBACvB,IAAIwS,GAAU,CAAExS,MAAO,qBACvB,IAAIwS,GAAU,CAAExS,MAAO,mBACvB,IAAIwS,GAAU,CAAExS,MAAO,oBACvB,IAAIwS,GAAU,CAAExS,MAAO,qBAEzBwO,SAAU,cACT1B,GACH,EAAKmG,OAAS,GACd,EAAKC,YAAc,KACnB,EAAKpG,QAAQmG,OAAO/Z,SAAQ,SAACa,GAC3B,EAAKyI,IAAIzI,MAEP,EAAKkZ,OAAOxa,OAAS,GACvB,EAAK0a,iBAAiB,EAAKF,OAAO,GAAGnG,QAAQ9M,OAnG5B,E,4RAuGjBjG,IAEY,IADDzB,KAAK2a,OAAOG,WAAU,SAAApT,GAAK,OAAIA,EAAMA,QAAUjG,EAAKiG,WAE5C1H,KAAX2a,OACD9R,KAAKpH,GACZzB,KAAKwJ,cAAc/H,GACnBzB,KAAKnC,KAAK4D,M,+BAKZzB,KAAK2a,OAAO/Z,SAAQ,SAACa,GACnBmQ,EAAOD,OAAOlQ,Q,2BAIbA,GAAM,WACTmQ,EAAO/T,KAAK4D,EAAMuM,EAASI,kBAAkBE,YAAY,WACvD,EAAKkG,QAAQ0B,SAASzU,GAClBA,EAAK+S,QAAQ9M,OACf,EAAKmT,iBAAiBpZ,EAAK+S,QAAQ9M,Y,sCAKzBA,GAEd,OADAA,EAAQhI,EAAW0a,WAAW1S,GACvB1H,KAAK2a,OAAOnQ,MAAK,SAAA/I,GAAI,OAAIA,EAAKiG,QAAUA,O,uCAGhCA,GAAO,WACtBA,EAAQhI,EAAW0a,WAAW1S,GAC9B1H,KAAK2a,OAAO/Z,SAAQ,SAACa,GACfA,EAAKiG,QAAUA,GACjBjG,EAAKsZ,WAAU,GACf,EAAKH,YAAcnZ,EAAKiG,OAExBjG,EAAKsZ,WAAU,Q,8BAMnB/a,KAAK2R,SACL3R,KAAK2a,OAAS,GACd3a,KAAKgb,U,gCAIL,8CACAhb,KAAK2R,c,gCA3JgB2B,G,uKAgKzBoH,GAAWO,MAAQ,eACnBP,GAAWQ,MAAQ,qB,IChKbC,G,WAkBJ,cAcG,QAbD7U,aAaC,MAbOJ,EAASK,MAAMO,KAatB,MAZDJ,qBAYC,MAZeR,EAASS,eAAeH,OAYvC,MAXDwB,gBAWC,MAXU9B,EAASc,UAAUG,SAW7B,MAVDU,qBAUC,aATDC,iBASC,aARDJ,aAQC,MAROgT,GAAWO,MAQlB,MAPDre,YAOC,MAPM,QAON,MANDiF,YAMC,MANM,GAMN,MALD8F,YAKC,aAJDC,cAIC,aAHDG,aAGC,MAHO,EAGP,MAFDE,iBAEC,MAFW/B,EAASkB,eAAeC,WAEnC,MADDZ,eACC,MADS,EACT,G,4FAAA,SACDzG,KAAKsG,MAAQA,EACbtG,KAAK0G,cAAgBA,EACrB1G,KAAKgI,SAAWA,EAChBhI,KAAK6H,cAAgBA,EACrB7H,KAAK8H,UAAYA,EACjB9H,KAAK0H,MAAQA,EACb1H,KAAKpD,KAAOA,EACZoD,KAAK6B,KAAOA,EACZ7B,KAAK2H,KAAOA,EACZ3H,KAAK4H,OAASA,EACd5H,KAAKiI,UAAYA,EACjBjI,KAAK+H,MAAQA,EACb/H,KAAKyG,QAAUA,E,uDAmBf,OAAO,IAAI0U,EAAS,CAClB7U,MAFEtG,KAbFsG,MAgBAI,cAHE1G,KAZF0G,cAgBAsB,SAJEhI,KAXFgI,SAgBAH,cALE7H,KAVF6H,cAgBAC,UANE9H,KATF8H,UAgBAJ,MAPE1H,KARF0H,MAgBA9K,KAREoD,KAPFpD,KAgBAiF,KATE7B,KANF6B,KAgBA8F,KAVE3H,KALF2H,KAgBAC,OAXE5H,KAJF4H,OAgBAG,MAZE/H,KAHF+H,MAgBAE,UAbEjI,KAFFiI,UAgBAxB,QAdEzG,KADFyG,Y,8BAoBFzG,KAAKsG,MAAQJ,EAASK,MAAMO,KAC5B9G,KAAK0G,cAAgBR,EAASS,eAAeH,OAC7CxG,KAAKgI,SAAW9B,EAASc,UAAUG,SACnCnH,KAAK6H,eAAgB,EACrB7H,KAAK8H,WAAY,EACjB9H,KAAK0H,MAAQgT,GAAWO,MACxBjb,KAAKpD,KAAO,QACZoD,KAAK6B,KAAO,GACZ7B,KAAK2H,MAAO,EACZ3H,KAAK4H,QAAS,EACd5H,KAAK+H,MAAQ,EACb/H,KAAKiI,UAAY/B,EAASkB,eAAeC,WACzCrH,KAAKyG,QAAU,I,6BAGVkH,GACL,IAAIyN,EAAQre,OAAO+D,KAAKd,MACpBqb,EAAQte,OAAO+D,KAAK6M,GACxB,GAAIyN,EAAMjb,SAAWkb,EAAMlb,OACzB,OAAO,EAET,cAAgBib,EAAhB,eAAuB,CAAlB,IAAIxd,EAAG,KACV,IAAKyd,EAAM1S,SAAS/K,GAClB,OAAO,EAGX,cAAgBwd,EAAhB,eAAuB,CAAlB,IAAIxd,EAAG,KACV,GAAIoC,KAAKpC,KAAS+P,EAAM/P,GACtB,OAAO,EAGX,OAAO,O,00EAKXud,GAASG,aAAe,KC1HxB,IAAIC,GAAM7b,EAAW8b,WAAa,EAAIC,iBAClCC,GAAiBpd,KAAK4Z,MAAMqD,IAC5BI,GAAoBD,GAAiB,EACrCE,GAAkBD,GAAoB,EACtCE,GAAoBH,GAAiB,EAEnCI,G,WA0CJ,WAAYC,GAAQ,WAClB/b,KAAK+b,OAASA,EACd/b,KAAKgc,IAAMD,EAAOE,WAAW,M,8CA1ClBC,GACX,OAAOA,EAAKlc,KAAKmc,Q,4BAGND,GACX,OAAOlc,KAAKoc,MAAMpc,KAAKqc,QAAQH,M,8BAGlBA,GACb,OAAOlc,KAAKkY,MAAMgE,EAAKlc,KAAKmc,S,4BAGjBra,GACX,OAAOxD,KAAK4Z,MAAMpW,K,2BAGRA,GACV,OAAOxD,KAAKge,KAAKxa,K,4BAGNA,GACX,OAAOxD,KAAKie,MAAMza,K,6BAGNiG,GACZ,OAAQA,GAASzJ,KAAKke,GAAK,O,4BAI3B,OAAOjB,K,gCAGe,IAATzZ,EAAS,uDAAH,EACnByZ,GAAM7b,EAAW8b,WAAa1Z,EAAM2Z,iBACpCC,GAAiBpd,KAAK4Z,MAAMqD,IAE5BK,IADAD,GAAoBD,GAAiB,GACC,EACtCG,GAAoBH,GAAiB,M,iCAQlClH,GACH,IAAK,IAAM5W,KAAO4W,EAChB,GAAIA,EAAQtW,eAAeN,GAAM,CAC/B,IAAIN,EAAQkX,EAAQ5W,IACC,iBAAVN,GAAsBA,aAAiBsB,UAChDtB,EAAQA,EAAM8C,QAEZJ,KAAKgc,IAAIpe,KAASN,IACpB0C,KAAKgc,IAAIpe,GAAON,GAItB,OAAO0C,O,6BAGFyD,EAAOE,GAAQ,IACZoY,EAAW/b,KAAX+b,OAKR,OAJAA,EAAOtY,MAAQqY,EAAKO,QAAQ5Y,GAC5BsY,EAAOpY,OAASmY,EAAKO,QAAQ1Y,GAC7BoY,EAAOpQ,MAAMlI,MAAb,UAAwBsY,EAAOtY,MAAQqY,EAAKK,MAA5C,MACAJ,EAAOpQ,MAAMhI,OAAb,UAAyBoY,EAAOpY,OAASmY,EAAKK,MAA9C,MACOnc,S,KAmLLyc,G,YAoBJ,WAAYV,GAAQ,yBAClB,0BAAMA,KACDW,cAAgBD,EAASE,gBAAgBC,IAC9C,EAAKC,UAAY,aAHC,E,mEAlBM/a,GACxB,OAAO4Z,GAAiB,EACpB5Z,EAAM+Z,GACN/Z,EAAM4Z,K,yCAGcxb,GACxB,OAAQA,GACN,KAAKuc,EAASE,gBAAgBG,OAC5B,OAAOnB,GACT,KAAKc,EAASE,gBAAgBC,IAC5B,OAAOlB,GACT,KAAKe,EAASE,gBAAgBI,KAC5B,OAAOnB,GAEX,OAAO,M,0CASoB,qBAAnBoB,EAAmB,KAAfC,EAAe,eAATC,EAAS,KAALC,EAAK,KAEzBT,EACE1c,KADF0c,cAAeG,EACb7c,KADa6c,UAEbO,EAAY1B,GAChB,OAAQgB,GACN,KAAKD,EAASE,gBAAgBG,OAC5BM,EAAYzB,GACZ,MACF,KAAKc,EAASE,gBAAgBC,IAC5BQ,EAAY1B,GACZ,MACF,KAAKe,EAASE,gBAAgBI,KAC5BK,EAAYxB,GAGhB5b,KAAKqG,KAAK,CACRgX,YAAaR,EACbO,cAEFpd,KAAKsd,YAAW,SAACC,GAAQ,SACRA,EADQ,GAChB/a,EADgB,KACbC,EADa,KAEvB,MAAO,CACLqZ,GAAK5D,MAAM1V,EAAI,EAAKgb,cAAgB3B,GACpCC,GAAK5D,MAAMzV,EAAI,EAAKgb,cAAgB5B,MAErC,CAACmB,EAAIC,GAAK,CAACC,EAAIC,M,mCAGPzV,GACX1H,KAAK6c,UAAYnV,I,uCAGFxH,GACfF,KAAK0c,cAAgBxc,I,uCAGS,cAAnB8c,EAAmB,KAAfC,EAAe,eAATC,EAAS,KAALC,EAAK,KAC9B,GAAIF,IAAOE,EACT,MAAM,IAAIO,UAAU,sBAEtB1d,KAAK2d,SAAS,CAACX,EAAIC,GAAK,CAACC,EAAIC,M,wCAGE,cAAnBH,EAAmB,KAAfC,EAAe,eAATC,EAAS,KAALC,EAAK,KAC/B,GAAIH,IAAOE,EACT,MAAM,IAAIQ,UAAU,uBAEtB1d,KAAK2d,SAAS,CAACX,EAAIC,GAAK,CAACC,EAAIC,Q,qIA9FlB,kCAALI,EAAK,yBAALA,EAAK,gBAMX,OALAvd,KAAKsd,WAAL,MAAAtd,KAAA,CAAgB,SAACud,GAAQ,SACRA,EADQ,GAChB/a,EADgB,KACbC,EADa,KAEvB,MAAO,CAAC,EAAKmb,OAAO9B,GAAK5D,MAAM1V,EAAI,EAAKgb,eACtC,EAAKI,OAAO9B,GAAK5D,MAAMzV,EAAI,EAAKgb,kBAHpC,OAIMF,IACCvd,O,6BAGF6d,GAKL,OAJgB7d,KAARgc,IAENoB,UAEiB,GAAM,EACrBS,EAAQA,EAAQ,O,eAtDtB,WAAY9B,GAAQ,yBAClB,0BAAMA,KACD+B,QAAU,EACf,EAAKC,QAAU,EAHG,E,kDAMbvb,EAAGC,GACRzC,KAAK8d,QAAUtb,EACfxC,KAAK+d,QAAUtb,I,mCAIf,OAAOzC,KAAK8d,U,mCAIZ,OAAO9d,KAAK+d,U,iCAIZ,MAAML,UAAU,gB,iCAIhB,MAAMA,UAAU,gB,6BAIhB,MAAMA,UAAU,gB,kCAIhB,MAAMA,UAAU,kB,2IA5E6B,IAApCM,EAAoC,uDAApB,SAAAT,GAAG,OAAIA,GACxBvB,EAAQhc,KAARgc,IACR,IAAI,0CAAa,EAAG,CAClBhc,KAAKie,YADa,MAEHD,EAAc,UAAD,+BAFV,UAEXxb,EAFW,KAERC,EAFQ,KAGlBuZ,EAAIkC,OAAO1b,EAAGC,GACd,IAAK,IAAIpG,EAAI,EAAGmF,EAAM,UAAH,+BAAenF,EAAImF,EAAKnF,GAAK,EAAG,OAClC2hB,EAAkB3hB,EAAL,uBAAKA,EAAL,mBAAKA,EAAL,IADqB,UAC1CmG,EAD0C,KACvCC,EADuC,KAEjDuZ,EAAImC,OAAO3b,EAAGC,GAEhBuZ,EAAIoC,Y,mCAIuC,IAApCJ,EAAoC,uDAApB,SAAAT,GAAG,OAAIA,GACxBvB,EAAQhc,KAARgc,IACR,IAAI,0CAAa,EAAG,CAClBhc,KAAKie,YADa,MAEHD,EAAc,UAAD,+BAFV,UAEXxb,EAFW,KAERC,EAFQ,KAGlBuZ,EAAIkC,OAAO1b,EAAGC,GACd,IAAK,IAAIpG,EAAI,EAAGmF,EAAM,UAAH,+BAAenF,EAAImF,EAAKnF,GAAK,EAAG,OAClC2hB,EAAkB3hB,EAAL,uBAAKA,EAAL,mBAAKA,EAAL,IADqB,UAC1CmG,EAD0C,KACvCC,EADuC,KAEjDuZ,EAAImC,OAAO3b,EAAGC,GAEhBuZ,EAAIqC,U,iCAIG,IACDtC,EAAW/b,KAAX+b,OACAtY,EAAkBsY,EAAlBtY,MAAOE,EAAWoY,EAAXpY,OAEf,OADA3D,KAAKgc,IAAIsC,SAAS,EAAG,EAAG7a,EAAOE,GACxB3D,O,6BAGF+H,GAEL,OADA,4CAAa+T,GAAKyC,OAAOxW,IAClB/H,S,eA1GT,WAAY+b,GAAQ,yBAClB,0BAAMA,KACDyC,KAAO,GAFM,E,uDAQlB,OAFgBxe,KAARgc,IACJiC,YACGje,O,kCAGG8I,GAEV,OADgB9I,KAARgc,IACGyC,YAAY3V,K,6BAMvB,OAFgB9I,KAARgc,IACJ0C,OACG1e,O,gCAMP,OAFgBA,KAARgc,IACJ2C,UACG3e,O,6BAMP,OAFgBA,KAARgc,IACJqC,OACGre,O,6BAMP,OAFgBA,KAARgc,IACJ4C,OACG5e,O,oCAGc,IAAXwe,EAAW,uDAAJ,GACTxC,EAAQhc,KAARgc,IAGR,OAFAhc,KAAKwe,KAAOA,EACZxC,EAAI6C,YAAYL,GACTxe,O,4BAGHwC,EAAGC,GAGP,OAFgBzC,KAARgc,IACJ8C,MAAMtc,EAAGC,GACNzC,O,gCAGCwC,EAAGC,GAGX,OAFgBzC,KAARgc,IACJ+C,UAAUvc,EAAGC,GACVzC,O,6BAGFgf,GAGL,OAFgBhf,KAARgc,IACJiD,OAAOD,GACJhf,S,GAhEY8b,QA4PvBW,GAASE,gBAAkB,CACzBC,IAAK,MACLE,OAAQ,SACRC,KAAM,Q,IAGFmC,G,oIAEKpW,EAAMtG,EAAGC,GAIhB,OAHAD,GAAKxC,KAAKwd,aACV/a,GAAKzC,KAAKyd,aACVzd,KAAKgc,IAAImD,SAASrW,EAAMoW,EAAMhH,MAAM1V,GAAI0c,EAAMhH,MAAMzV,IAC7CzC,O,+BAGAof,GAAM,WAKb,OAJApf,KAAKqf,WAAL,MAAArf,KAAA,CAAgB,SAACud,GAAQ,IACf/a,EAAS+a,EAAT/a,EAAGC,EAAM8a,EAAN9a,EACX,MAAO,CAACqZ,GAAK5D,MAAM1V,EAAI,EAAKgb,cAAe1B,GAAK5D,MAAMzV,EAAI,EAAKgb,iBAFjE,UAGM2B,EAAKE,UACJtf,O,+BAGAwC,EAAGC,EAAG8c,EAAGxR,GAKhB,OAJAvL,GAAKxC,KAAKwd,aACV/a,GAAKzC,KAAKyd,aACVzd,KAAKgc,IAAIsC,SAASY,EAAMhH,MAAM1V,GAAI0c,EAAMhH,MAAMzV,GAC5Cyc,EAAMhH,MAAMqH,GAAIL,EAAMhH,MAAMnK,IACvB/N,O,2BAGJwC,EAAGC,EAAG8c,EAAGxR,GAKZ,OAJAvL,GAAKxC,KAAKwd,aACV/a,GAAKzC,KAAKyd,aACVzd,KAAKgc,IAAIwD,KAAKN,EAAMhH,MAAM1V,GAAI0c,EAAMhH,MAAMzV,GACxCyc,EAAMhH,MAAMqH,GAAIL,EAAMhH,MAAMnK,IACvB/N,O,gCAGCgd,EAAIC,EAAIwC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,GAAI,IAChC9D,EAAQhc,KAARgc,IAUR,OATA2D,GAAM3f,KAAKwd,aACXR,GAAMhd,KAAKwd,aACXoC,GAAM5f,KAAKyd,aACXR,GAAMjd,KAAKyd,aACXzB,EAAI+D,UAAU/f,KAAK+b,OACjBmD,EAAMhH,MAAM8E,GAAKkC,EAAMhH,MAAM+E,GAC7BiC,EAAMhH,MAAMuH,GAAKP,EAAMhH,MAAMwH,GAC7BR,EAAMhH,MAAMyH,GAAKT,EAAMhH,MAAM0H,GAC7BV,EAAMhH,MAAM2H,GAAKX,EAAMhH,MAAM4H,IACxB9f,O,gCAGCmE,EAAI6Y,EAAIC,EAAIwC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,GAAI,IACpC9D,EAAQhc,KAARgc,IAQR,OAPA2D,GAAM3f,KAAKwd,aACXoC,GAAM5f,KAAKyd,aACXzB,EAAI+D,UAAU5b,EACZ+a,EAAMhH,MAAM8E,GAAKkC,EAAMhH,MAAM+E,GAC7BiC,EAAMhH,MAAMuH,GAAKP,EAAMhH,MAAMwH,GAC7BR,EAAMhH,MAAMyH,GAAKT,EAAMhH,MAAM0H,GAC7BV,EAAMhH,MAAM2H,GAAKX,EAAMhH,MAAM4H,IACxB9f,S,GAxDSyc,I,kUCjVpB,IAAMuD,GACQ,EADRA,GAIS,EA8GTC,G,WAEJ,WAAY9Z,EAAME,GAAM,WACtBrG,KAAKmG,KAAOA,EACZzG,EAAWwB,KAAKlB,KAAM,CACpB0H,MAAO,aACPwY,UAAWhB,GAAMvC,gBAAgBC,IACjCnW,QAAS,EACT0Z,QAASF,EAAWE,QACpBC,SAAU,kBAAM,GAChBC,QAAS,kBAAM,GACfC,UAAW,kBAAM,GACjBC,WAAY,kBAAM,GAClBC,QAAS,kBAAM,GACfC,gBAAiB,kBAAM,GACvBC,eAAgB,kBAAM,GACtBC,gBAAiB,kBAAM,GACvBC,eAAgB,kBAAM,IACrBva,G,gDAGQ6Z,GACXlgB,KAAKkgB,UAAYA,I,+BAGVxY,GACP1H,KAAK0H,MAAQA,I,qCAGAsV,EAAIC,EAAIC,EAAIC,EAAI0D,EAAKC,EAAKC,GACvC,IAAMC,EAAW,GACTZ,EAA6CpgB,KAA7CogB,SAAUC,EAAmCrgB,KAAnCqgB,QAASC,EAA0BtgB,KAA1BsgB,UAAWC,EAAevgB,KAAfugB,WAC9BC,EAA8ExgB,KAA9EwgB,QAASC,EAAqEzgB,KAArEygB,gBAAiBC,EAAoD1gB,KAApD0gB,eAAgBC,EAAoC3gB,KAApC2gB,gBAAiBC,EAAmB5gB,KAAnB4gB,eAC3DT,EAAYngB,KAAZmgB,QACJc,EAAU,KACVC,EAAW,KACXC,EAAU,KACVC,EAAW,KACXC,EAAU,KACd,OAAQN,GACN,IAAK,QACHE,EAAUT,EAAQK,EAAKC,EAAM,MAE3BI,EAAWT,EAAgBI,EAAKC,EAAM,GACtCK,EAAUT,EAAeG,EAAKC,EAAM,GACpCM,EAAWT,EAAgBE,EAAKC,EAAM,GACtCO,EAAUT,EAAeC,EAAKC,EAAM,IAEtC,MACF,IAAK,OACHG,EAAUT,EAAQK,EAAM,EAAGC,MAEzBI,EAAWT,EAAgBI,EAAM,EAAGC,GACpCK,EAAUT,EAAeG,EAAM,EAAGC,GAClCM,EAAWT,EAAgBE,EAAM,EAAGC,GACpCO,EAAUT,EAAeC,EAAM,EAAGC,IAEpC,MACF,IAAK,SACHG,EAAUT,EAAQK,EAAKC,EAAM,MAE3BI,EAAWT,EAAgBI,EAAKC,EAAM,GACtCK,EAAUT,EAAeG,EAAKC,EAAM,GACpCM,EAAWT,EAAgBE,EAAKC,EAAM,GACtCO,EAAUT,EAAeC,EAAKC,EAAM,IAEtC,MACF,IAAK,UACHG,EAAUT,EAAQK,EAAM,EAAGC,MAEzBI,EAAWT,EAAgBI,EAAM,EAAGC,GACpCK,EAAUT,EAAeG,EAAM,EAAGC,GAClCM,EAAWT,EAAgBE,EAAM,EAAGC,GACpCO,EAAUT,EAAeC,EAAM,EAAGC,IAKxC,GAAIG,EAAS,CACX,OAAQF,GACN,IAAK,OACHC,EAAShE,GAAKA,EAAKmD,EACnBa,EAAS9D,GAAKA,EAAKiD,EAEnB,IAAMmB,EAAiBf,EAAWM,EAAM,EAAGC,EAAM,IAAMT,EAAQQ,EAAKC,EAAM,GACpES,EAAOlB,EAAQQ,EAAKC,GACpBU,EAAUjB,EAAWM,EAAM,EAAGC,GACpCE,EAAS/D,GAAKA,GACVsE,GAAQC,KAASR,EAAS/D,GAAKA,EAAKkD,GACpCmB,GAAkBJ,IAAUF,EAAS/D,GAAKA,EAAKkD,GAEnD,IAAMsB,EAAoBpB,EAAQQ,EAAM,EAAGC,EAAM,IAAMP,EAAWM,EAAKC,EAAM,GACvEY,EAAUnB,EAAWM,EAAKC,GAC1Ba,EAAOtB,EAAQQ,EAAM,EAAGC,GAC9BE,EAAS7D,GAAKA,GACVuE,GAAWC,KAAMX,EAAS7D,GAAKA,EAAKgD,GACpCsB,GAAqBN,IAASH,EAAS7D,GAAKA,EAAKgD,GACrD,MAEF,IAAK,MACHa,EAAS/D,GAAKA,EAAKkD,EACnBa,EAAS7D,GAAKA,EAAKgD,EAEnB,IAAMmB,EAAiBhB,EAAUO,EAAM,EAAGC,EAAM,IAAMV,EAASS,EAAM,EAAGC,GAClEc,EAAQxB,EAASS,EAAKC,GACtBe,EAASvB,EAAUO,EAAKC,EAAM,GACpCE,EAAShE,GAAKA,GACV4E,GAASC,KAAQb,EAAShE,GAAKA,EAAKmD,GACpCmB,GAAkBF,IAAUJ,EAAShE,GAAKA,EAAKmD,GAEnD,IAAM2B,EAAkB1B,EAASS,EAAM,EAAGC,EAAM,IAAMR,EAAUO,EAAM,EAAGC,GACnEiB,EAASzB,EAAUO,EAAKC,GACxBkB,EAAQ5B,EAASS,EAAKC,EAAM,GAClCE,EAAS9D,GAAKA,GACV6E,GAAUC,KAAOhB,EAAS9D,GAAKA,EAAKiD,GACpC2B,GAAmBT,IAASL,EAAS9D,GAAKA,EAAKiD,GACnD,MAEF,IAAK,QACHa,EAAShE,GAAKA,EAAKmD,EACnBa,EAAS9D,GAAKA,EAAKiD,EAEnB,IAAM8B,EAAkB1B,EAAWM,EAAM,EAAGC,EAAM,IAAMT,EAAQQ,EAAKC,EAAM,GACrES,EAAOlB,EAAQQ,EAAKC,GACpBU,EAAUjB,EAAWM,EAAM,EAAGC,GACpCE,EAAS/D,GAAKA,GACVsE,GAAQC,KAASR,EAAS/D,GAAKA,EAAKkD,GACpC8B,GAAmBf,IAAUF,EAAS/D,GAAKA,EAAKkD,GAEpD,IAAM+B,EAAqB7B,EAAQQ,EAAM,EAAGC,EAAM,IAAMP,EAAWM,EAAKC,EAAM,GACxEY,EAAUnB,EAAWM,EAAKC,GAC1Ba,EAAOtB,EAAQQ,EAAM,EAAGC,GAC9BE,EAAS7D,GAAKA,GACVuE,GAAWC,KAAMX,EAAS7D,GAAKA,EAAKgD,GACpC+B,GAAsBf,IAASH,EAAS7D,GAAKA,EAAKgD,GACtD,MAEF,IAAK,SACHa,EAAS/D,GAAKA,EAAKkD,EACnBa,EAAS7D,GAAKA,EAAKgD,EAEnB,IAAMgC,EAAoB7B,EAAUO,EAAM,EAAGC,EAAM,IAAMV,EAASS,EAAM,EAAGC,GACrEc,EAAQxB,EAASS,EAAKC,GACtBe,EAASvB,EAAUO,EAAKC,EAAM,GACpCE,EAAShE,GAAKA,GACV4E,GAASC,KAAQb,EAAShE,GAAKA,EAAKmD,GACpCgC,GAAqBf,IAAUJ,EAAShE,GAAKA,EAAKmD,GAEtD,IAAM+B,EAAqB9B,EAASS,EAAM,EAAGC,EAAM,IAAMR,EAAUO,EAAM,EAAGC,GACtEiB,EAASzB,EAAUO,EAAKC,GACxBkB,EAAQ5B,EAASS,EAAKC,EAAM,GAClCE,EAAS9D,GAAKA,GACV6E,GAAUC,KAAOhB,EAAS9D,GAAKA,EAAKiD,GACpC+B,GAAsBb,IAASL,EAAS9D,GAAKA,EAAKiD,GAK1D,OAAOa,EAET,OAAQD,GACN,IAAK,OACHC,EAAShE,GAAKA,EAAKmD,EACnBa,EAAS9D,GAAKA,EAAKiD,EAEnB,IAAMmB,EAAiBf,EAAWM,EAAM,EAAGC,EAAM,IAAMT,EAAQQ,EAAKC,EAAM,GACpES,EAAOlB,EAAQQ,EAAKC,GACpBU,EAAUjB,EAAWM,EAAM,EAAGC,GACpCE,EAAS/D,GAAKA,GACVsE,GAAQC,KAASR,EAAS/D,GAAKA,EAAKkD,GACpCmB,IAAgBN,EAAS/D,GAAKA,EAAKkD,GAEvC,IAAMsB,EAAoBpB,EAAQQ,EAAM,EAAGC,EAAM,IAAMP,EAAWM,EAAKC,EAAM,GACvEY,EAAUnB,EAAWM,EAAKC,GAC1Ba,EAAOtB,EAAQQ,EAAM,EAAGC,GAC9BE,EAAS7D,GAAKA,GACVuE,GAAWC,KAAMX,EAAS7D,GAAKA,EAAKgD,GACpCsB,IAAmBT,EAAS7D,GAAKA,EAAKgD,GAC1C,MAEF,IAAK,MACHa,EAAS/D,GAAKA,EAAKkD,EACnBa,EAAS7D,GAAKA,EAAKgD,EAEnB,IAAMmB,EAAiBhB,EAAUO,EAAM,EAAGC,EAAM,IAAMV,EAASS,EAAM,EAAGC,GAClEc,GAAQxB,EAASS,EAAKC,GACtBe,GAASvB,EAAUO,EAAKC,EAAM,GACpCE,EAAShE,GAAKA,GACV4E,IAASC,MAAQb,EAAShE,GAAKA,EAAKmD,GACpCmB,IAAgBN,EAAShE,GAAKA,EAAKmD,GAEvC,IAAM2B,GAAkB1B,EAASS,EAAM,EAAGC,EAAM,IAAMR,EAAUO,EAAM,EAAGC,GACnEiB,GAASzB,EAAUO,EAAKC,GACxBkB,GAAQ5B,EAASS,EAAKC,EAAM,GAClCE,EAAS9D,GAAKA,GACV6E,IAAUC,MAAOhB,EAAS9D,GAAKA,EAAKiD,GACpC2B,KAAiBd,EAAS9D,GAAKA,EAAKiD,GACxC,MAEF,IAAK,QACHa,EAAShE,GAAKA,EAAKmD,EACnBa,EAAS9D,GAAKA,EAAKiD,EAEnB,IAAM8B,GAAkB1B,EAAWM,EAAM,EAAGC,EAAM,IAAMT,EAAQQ,EAAKC,EAAM,GACrES,GAAOlB,EAAQQ,EAAKC,GACpBU,GAAUjB,EAAWM,EAAM,EAAGC,GACpCE,EAAS/D,GAAKA,GACVsE,IAAQC,MAASR,EAAS/D,GAAKA,EAAKkD,GACpC8B,KAAiBjB,EAAS/D,GAAKA,EAAKkD,GAExC,IAAM+B,GAAqB7B,EAAQQ,EAAM,EAAGC,EAAM,IAAMP,EAAWM,EAAKC,EAAM,GACxEY,GAAUnB,EAAWM,EAAKC,GAC1Ba,GAAOtB,EAAQQ,EAAM,EAAGC,GAC9BE,EAAS7D,GAAKA,GACVuE,IAAWC,MAAMX,EAAS7D,GAAKA,EAAKgD,GACpC+B,KAAoBlB,EAAS7D,GAAKA,EAAKgD,GAC3C,MAEF,IAAK,SACHa,EAAS/D,GAAKA,EAAKkD,EACnBa,EAAS7D,GAAKA,EAAKgD,EAEnB,IAAMgC,GAAoB7B,EAAUO,EAAM,EAAGC,EAAM,IAAMV,EAASS,EAAM,EAAGC,GACrEc,GAAQxB,EAASS,EAAKC,GACtBe,GAASvB,EAAUO,EAAKC,EAAM,GACpCE,EAAShE,GAAKA,GACV4E,IAASC,MAAQb,EAAShE,GAAKA,EAAKmD,GACpCgC,KAAmBnB,EAAShE,GAAKA,EAAKmD,GAE1C,IAAM+B,GAAqB9B,EAASS,EAAM,EAAGC,EAAM,IAAMR,EAAUO,EAAM,EAAGC,GACtEiB,GAASzB,EAAUO,EAAKC,GACxBkB,GAAQ5B,EAASS,EAAKC,EAAM,GAClCE,EAAS9D,GAAKA,GACV6E,IAAUC,MAAOhB,EAAS9D,GAAKA,EAAKiD,GACpC+B,KAAoBlB,EAAS9D,GAAKA,EAAKiD,GAK/C,OAAOa,I,qCAGMhE,EAAIC,EAAIC,EAAIC,EAAI0D,EAAKC,EAAKC,GACvC,IAAMqB,EAAW,GACThC,EAA6CpgB,KAA7CogB,SAAUC,EAAmCrgB,KAAnCqgB,QAASC,EAA0BtgB,KAA1BsgB,UAAWC,EAAevgB,KAAfugB,WAC9BC,EAA8ExgB,KAA9EwgB,QAASC,EAAqEzgB,KAArEygB,gBAAiBC,EAAoD1gB,KAApD0gB,eAAgBC,EAAoC3gB,KAApC2gB,gBAAiBC,EAAmB5gB,KAAnB4gB,eAC3DT,EAAYngB,KAAZmgB,QAGR,GAFgBK,EAAQK,EAAKC,GAEhB,CACX,IAAMI,EAAWT,EAAgBI,EAAKC,GAChCK,EAAUT,EAAeG,EAAKC,GAC9BM,EAAWT,EAAgBE,EAAKC,GAChCO,EAAUT,EAAeC,EAAKC,GACpC,OAAQC,GACN,IAAK,OACHqB,EAASpF,GAAKA,EAAKmD,EACnBiC,EAASlF,GAAKA,EAAKiD,EAEnB,IAAMmB,EAAiBf,EAAWM,EAAM,EAAGC,EAAM,IAAMT,EAAQQ,EAAKC,EAAM,GACpES,EAAOlB,EAAQQ,EAAKC,GACpBU,EAAUjB,EAAWM,EAAM,EAAGC,GACpCsB,EAASnF,GAAKA,EACVqE,IAAgBc,EAASnF,GAAKA,EAAKkD,IAClCoB,GAAQC,IAAYN,IAAUkB,EAASnF,GAAKA,EAAKkD,GAEtD,IAAMsB,EAAoBpB,EAAQQ,EAAM,EAAGC,EAAM,IAAMP,EAAWM,EAAKC,EAAM,GACvEY,EAAUnB,EAAWM,EAAKC,GAC1Ba,EAAOtB,EAAQQ,EAAM,EAAGC,GAC9BsB,EAASjF,GAAKA,EACVsE,IAAmBW,EAASjF,GAAKA,EAAKgD,IACrCuB,GAAWC,IAASR,IAASiB,EAASjF,GAAKA,EAAKgD,GACrD,MAEF,IAAK,MACHiC,EAASnF,GAAKA,EAAKkD,EACnBiC,EAASjF,GAAKA,EAAKgD,EAEnB,IAAMmB,EAAiBhB,EAAUO,EAAM,EAAGC,EAAM,IAAMV,EAASS,EAAM,EAAGC,GAClEc,EAAQxB,EAASS,EAAKC,GACtBe,EAASvB,EAAUO,EAAKC,EAAM,GACpCsB,EAASpF,GAAKA,EACVsE,IAAgBc,EAASpF,GAAKA,EAAKmD,IAClCyB,GAASC,IAAWT,IAAUgB,EAASpF,GAAKA,EAAKmD,GAEtD,IAAM2B,EAAkB1B,EAASS,EAAM,EAAGC,EAAM,IAAMR,EAAUO,EAAM,EAAGC,GACnEiB,EAASzB,EAAUO,EAAKC,GACxBkB,EAAQ5B,EAASS,EAAKC,EAAM,GAClCsB,EAASlF,GAAKA,EACV4E,IAAiBM,EAASlF,GAAKA,EAAKiD,IACnC4B,GAAUC,IAAUX,IAASe,EAASlF,GAAKA,EAAKiD,GACrD,MAEF,IAAK,QACHiC,EAASpF,GAAKA,EAAKmD,EACnBiC,EAASlF,GAAKA,EAAKiD,EAEnB,IAAM8B,EAAkB1B,EAAWM,EAAM,EAAGC,EAAM,IAAMT,EAAQQ,EAAKC,EAAM,GACrES,EAAOlB,EAAQQ,EAAKC,GACpBU,EAAUjB,EAAWM,EAAM,EAAGC,GACpCsB,EAASnF,GAAKA,EACVgF,IAAiBG,EAASnF,GAAKA,EAAKkD,IACnCoB,GAAQC,IAAYN,IAAUkB,EAASnF,GAAKA,EAAKkD,GAEtD,IAAM+B,EAAqB7B,EAAQQ,EAAM,EAAGC,EAAM,IAAMP,EAAWM,EAAKC,EAAM,GACxEY,EAAUnB,EAAWM,EAAKC,GAC1Ba,EAAOtB,EAAQQ,EAAM,EAAGC,GAC9BsB,EAASjF,GAAKA,EACV+E,IAAoBE,EAASjF,GAAKA,EAAKgD,IACtCuB,GAAWC,IAASR,IAASiB,EAASjF,GAAKA,EAAKgD,GACrD,MAEF,IAAK,SACHiC,EAASnF,GAAKA,EAAKkD,EACnBiC,EAASjF,GAAKA,EAAKgD,EAEnB,IAAMgC,EAAoB7B,EAAUO,EAAM,EAAGC,EAAM,IAAMV,EAASS,EAAM,EAAGC,GACrEc,EAAQxB,EAASS,EAAKC,GACtBe,EAASvB,EAAUO,EAAKC,EAAM,GACpCsB,EAASpF,GAAKA,EACVmF,IAAmBC,EAASpF,GAAKA,EAAKmD,IACrCyB,GAASC,IAAWT,IAAUgB,EAASpF,GAAKA,EAAKmD,GAEtD,IAAM+B,EAAqB9B,EAASS,EAAM,EAAGC,EAAM,IAAMR,EAAUO,EAAM,EAAGC,GACtEiB,EAASzB,EAAUO,EAAKC,GACxBkB,EAAQ5B,EAASS,EAAKC,EAAM,GAClCsB,EAASlF,GAAKA,EACVgF,IAAoBE,EAASlF,GAAKA,EAAKiD,IACtC4B,GAAUC,IAAUX,IAASe,EAASlF,GAAKA,EAAKiD,GAKzD,OAAOiC,EAET,OAAQrB,GACN,IAAK,OACHqB,EAASpF,GAAKA,EAAKmD,EACnBiC,EAASlF,GAAKA,EAAKiD,EAEnB,IAAMmB,EAAiBf,EAAWM,EAAM,EAAGC,EAAM,IAAMT,EAAQQ,EAAKC,EAAM,GACpES,EAAOlB,EAAQQ,EAAKC,GACpBU,EAAUjB,EAAWM,EAAM,EAAGC,GACpCsB,EAASnF,GAAKA,EACVqE,IAAgBc,EAASnF,GAAKA,EAAKkD,IACnCoB,GAAQC,KAASY,EAASnF,GAAKA,EAAKkD,GAExC,IAAMsB,EAAoBpB,EAAQQ,EAAM,EAAGC,EAAM,IAAMP,EAAWM,EAAKC,EAAM,GACvEY,EAAUnB,EAAWM,EAAKC,GAC1Ba,EAAOtB,EAAQQ,EAAM,EAAGC,GAC9BsB,EAASjF,GAAKA,EACVsE,IAAmBW,EAASjF,GAAKA,EAAKgD,IACtCuB,GAAWC,KAAMS,EAASjF,GAAKA,EAAKgD,GACxC,MAEF,IAAK,MACHiC,EAASnF,GAAKA,EAAKkD,EACnBiC,EAASjF,GAAKA,EAAKgD,EAEnB,IAAMmB,EAAiBhB,EAAUO,EAAM,EAAGC,EAAM,IAAMV,EAASS,EAAM,EAAGC,GAClEc,EAAQxB,EAASS,EAAKC,GACtBe,GAASvB,EAAUO,EAAKC,EAAM,GACpCsB,EAASpF,GAAKA,EACVsE,IAAgBc,EAASpF,GAAKA,EAAKmD,IACnCyB,GAASC,MAAQO,EAASpF,GAAKA,EAAKmD,GAExC,IAAM2B,GAAkB1B,EAASS,EAAM,EAAGC,EAAM,IAAMR,EAAUO,EAAM,EAAGC,GACnEiB,GAASzB,EAAUO,EAAKC,GACxBkB,GAAQ5B,EAASS,EAAKC,EAAM,GAClCsB,EAASlF,GAAKA,EACV4E,KAAiBM,EAASlF,GAAKA,EAAKiD,IACpC4B,IAAUC,MAAOI,EAASlF,GAAKA,EAAKiD,GACxC,MAEF,IAAK,QACHiC,EAASpF,GAAKA,EAAKmD,EACnBiC,EAASlF,GAAKA,EAAKiD,EAEnB,IAAM8B,GAAkB1B,EAAWM,EAAM,EAAGC,EAAM,IAAMT,EAAQQ,EAAKC,EAAM,GACrES,GAAOlB,EAAQQ,EAAKC,GACpBU,GAAUjB,EAAWM,EAAM,EAAGC,GACpCsB,EAASnF,GAAKA,EACVgF,KAAiBG,EAASnF,GAAKA,EAAKkD,IACpCoB,IAAQC,MAASY,EAASnF,GAAKA,EAAKkD,GAExC,IAAM+B,GAAqB7B,EAAQQ,EAAM,EAAGC,EAAM,IAAMP,EAAWM,EAAKC,EAAM,GACxEY,GAAUnB,EAAWM,EAAKC,GAC1Ba,GAAOtB,EAAQQ,EAAM,EAAGC,GAC9BsB,EAASjF,GAAKA,EACV+E,KAAoBE,EAASjF,GAAKA,EAAKgD,IACvCuB,IAAWC,MAAMS,EAASjF,GAAKA,EAAKgD,GACxC,MAEF,IAAK,SACHiC,EAASnF,GAAKA,EAAKkD,EACnBiC,EAASjF,GAAKA,EAAKgD,EAEnB,IAAMgC,GAAoB7B,EAAUO,EAAM,EAAGC,EAAM,IAAMV,EAASS,EAAM,EAAGC,GACrEc,GAAQxB,EAASS,EAAKC,GACtBe,GAASvB,EAAUO,EAAKC,EAAM,GACpCsB,EAASpF,GAAKA,EACVmF,KAAmBC,EAASpF,GAAKA,EAAKmD,IACtCyB,IAASC,MAAQO,EAASpF,GAAKA,EAAKmD,GAExC,IAAM+B,GAAqB9B,EAASS,EAAM,EAAGC,EAAM,IAAMR,EAAUO,EAAM,EAAGC,GACtEiB,GAASzB,EAAUO,EAAKC,GACxBkB,GAAQ5B,EAASS,EAAKC,EAAM,GAClCsB,EAASlF,GAAKA,EACVgF,KAAoBE,EAASlF,GAAKA,EAAKiD,IACvC4B,IAAUC,MAAOI,EAASlF,GAAKA,EAAKiD,GAK5C,OAAOiC,I,kCAGGpF,EAAIC,EAAIC,EAAIC,EAAI0D,EAAKC,EAAKC,GAAK,IACjC5a,EAASnG,KAATmG,KAEN+Z,EACElgB,KADFkgB,UAAWxY,EACT1H,KADS0H,MAEbvB,EAAKkc,aAAa3a,GAClBvB,EAAKmc,iBAAiBpC,GACtB/Z,EAAK0Y,YAAY,IACjB,IAAMmC,EAAWhhB,KAAKuiB,eAAevF,EAAIC,EAAIC,EAAIC,EAAI0D,EAAKC,EAAKC,GACzDqB,EAAWpiB,KAAKwiB,eAAexF,EAAIC,EAAIC,EAAIC,EAAI0D,EAAKC,EAAKC,GAC1DrhB,EAAWI,cAAcsiB,IAC5Bjc,EAAKsc,YAAY,CAACL,EAASpF,GAAIoF,EAASnF,IAAK,CAACmF,EAASlF,GAAIkF,EAASjF,KAEjEzd,EAAWI,cAAckhB,IAC5B7a,EAAKsc,YAAY,CAACzB,EAAShE,GAAIgE,EAAS/D,IAAK,CAAC+D,EAAS9D,GAAI8D,EAAS7D,O,mCAI3DH,EAAIC,EAAIC,EAAIC,EAAI0D,EAAKC,EAAKC,GAAK,IAClC5a,EAASnG,KAATmG,KAEN+Z,EACElgB,KADFkgB,UAAWxY,EACT1H,KADS0H,MAEbvB,EAAKkc,aAAa3a,GAClBvB,EAAKmc,iBAAiBpC,GACtB/Z,EAAK0Y,YAAY,IACjB,IAAMmC,EAAWhhB,KAAKuiB,eAAevF,EAAIC,EAAIC,EAAIC,EAAI0D,EAAKC,EAAKC,GACzDqB,EAAWpiB,KAAKwiB,eAAexF,EAAIC,EAAIC,EAAIC,EAAI0D,EAAKC,EAAKC,GAC1DrhB,EAAWI,cAAcsiB,IAC5Bjc,EAAKuc,aAAa,CAACN,EAASpF,GAAIoF,EAASnF,IAAK,CAACmF,EAASlF,GAAIkF,EAASjF,KAElEzd,EAAWI,cAAckhB,IAC5B7a,EAAKuc,aAAa,CAAC1B,EAAShE,GAAIgE,EAAS/D,IAAK,CAAC+D,EAAS9D,GAAI8D,EAAS7D,O,kCAK7DH,EAAIC,EAAIC,EAAIC,EAAI0D,EAAKC,EAAKC,Q,KAMxCd,GAAWE,QAAUjB,GAAM/C,OAAS,EAAI,EAAI,E,mOC7jB5C,IAAIwG,GAAW,EAMTC,G,WAgBJ,cAOG,QAND1C,iBAMC,MANWhB,GAAMvC,gBAAgBC,IAMjC,MALDnZ,aAKC,OALQ,EAKR,MAJDiE,aAIC,MAJO,aAIP,MAHDmb,cAGC,MAHQ,EAGR,MAFDxW,eAEC,aADDnM,YACC,MADM8f,GACN,G,4FAAA,SACDhgB,KAAK6iB,OAASA,EACd7iB,KAAKqM,QAAUA,EACfrM,KAAK0H,MAAQA,EACb1H,KAAKE,KAAOA,EAEVF,KAAKkgB,UADO,IAAVzc,EACeyb,GAAMvC,gBAAgBC,IACpB,IAAVnZ,EACQyb,GAAMvC,gBAAgBG,OACpB,IAAVrZ,EACQyb,GAAMvC,gBAAgBI,KAEtBmD,EAEf2C,EAASF,KACXA,GAAWE,G,oDAlCb,OADAF,IAAY,M,yCAuCDrlB,GACX0C,KAAK6iB,OAASD,EAAOE,YACrB9iB,KAAKkgB,UAAY5iB,I,+BAGVA,GACP0C,KAAK6iB,OAASD,EAAOE,YACrB9iB,KAAK0H,MAAQpK,I,iCAGJA,GACT0C,KAAK6iB,OAASD,EAAOE,YACrB9iB,KAAKqM,QAAU/O,I,8BAGTA,GACN0C,KAAK6iB,OAASD,EAAOE,YACrB9iB,KAAKE,KAAO5C,I,gCAGJA,GACR0C,KAAK6iB,OAASvlB,I,+BAGPylB,GACP,GAAIrjB,EAAWO,QAAQ8iB,GACrB,OAAQ,EAEV,IAAMC,EAAShjB,KAAK6iB,OACdthB,EAASwhB,EAAOF,OACtB,OAAIG,EAASzhB,EACJ,EAELA,EAASyhB,GACH,EAEH,I,8BAIP,OAAO,IAAIJ,EAAO,CAChB1C,UAAWlgB,KAAKkgB,UAChBxY,MAAO1H,KAAK0H,MACZmb,OAAQ7iB,KAAK6iB,OACb3iB,KAAMF,KAAKE,KACXmM,QAASrM,KAAKqM,Y,4BAIZ9K,GACJ,IAAM2e,EAAYlgB,KAAKkgB,YAAc3e,EAAO2e,UACtCxY,EAAQ1H,KAAK0H,QAAUnG,EAAOmG,MAC9BxH,EAAOF,KAAKE,OAASqB,EAAOrB,KAClC,OAAOwH,GAASwY,GAAahgB,M,gLClG3B+iB,G,WAUJ,cAKG,QAJDnc,YAIC,MAJM,GAIN,MAHDD,cAGC,MAHQ,GAGR,MAFDD,WAEC,MAFK,GAEL,MADDG,aACC,MADO,GACP,G,4FAAA,SACD/G,KAAK8G,KAAO,IAAI8b,GAAO9b,GACvB9G,KAAK6G,OAAS,IAAI+b,GAAO/b,GACzB7G,KAAK4G,IAAM,IAAIgc,GAAOhc,GACtB5G,KAAK+G,MAAQ,IAAI6b,GAAO7b,G,2DAGd,IACFH,EAA6B5G,KAA7B4G,IAAKE,EAAwB9G,KAAxB8G,KAAMC,EAAkB/G,KAAlB+G,MAAOF,EAAW7G,KAAX6G,OAC1B,OAAID,EAAI1G,OAAS8f,IAGblZ,EAAK5G,OAAS8f,IAGdjZ,EAAM7G,OAAS8f,IAGZnZ,EAAO3G,OAAS8f,K,kCAIvB,OAAOhgB,KAAK8G,KAAKuF,SAAWrM,KAAK4G,IAAIyF,SAChCrM,KAAK6G,OAAOwF,SAAWrM,KAAK+G,MAAMsF,U,oCAG3BA,GACZrM,KAAKkjB,YAAY7W,GACjBrM,KAAKmjB,YAAY9W,GACjBrM,KAAKojB,YAAY/W,GACjBrM,KAAKqjB,YAAYhX,K,kCAGPA,GACVrM,KAAK8G,KAAKwc,WAAWjX,K,kCAGXA,GACVrM,KAAK4G,IAAI0c,WAAWjX,K,kCAGVA,GACVrM,KAAK+G,MAAMuc,WAAWjX,K,kCAGZA,GACVrM,KAAK6G,OAAOyc,WAAWjX,K,kCAGb3E,GACV1H,KAAKujB,UAAU7b,GACf1H,KAAKwjB,UAAU9b,GACf1H,KAAKyjB,UAAU/b,GACf1H,KAAK0jB,UAAUhc,K,gCAGPA,GACR1H,KAAK8G,KAAK6c,SAASjc,K,gCAGXA,GACR1H,KAAK4G,IAAI+c,SAASjc,K,gCAGVA,GACR1H,KAAK+G,MAAM4c,SAASjc,K,gCAGZA,GACR1H,KAAK6G,OAAO8c,SAASjc,K,sCAGPwY,GACdlgB,KAAK4jB,cAAc1D,GACnBlgB,KAAK6jB,cAAc3D,GACnBlgB,KAAK8jB,cAAc5D,GACnBlgB,KAAK+jB,cAAc7D,K,oCAGPA,GACZlgB,KAAK8G,KAAKkd,aAAa9D,K,oCAGXA,GACZlgB,KAAK4G,IAAIod,aAAa9D,K,oCAGVA,GACZlgB,KAAK+G,MAAMid,aAAa9D,K,oCAGZA,GACZlgB,KAAK6G,OAAOmd,aAAa9D,K,iCAGhBhgB,GACTF,KAAKikB,SAAS/jB,GACdF,KAAKkkB,SAAShkB,GACdF,KAAKmkB,SAASjkB,GACdF,KAAKokB,SAASlkB,K,+BAGPA,GACPF,KAAK8G,KAAKud,QAAQnkB,K,+BAGXA,GACPF,KAAK4G,IAAIyd,QAAQnkB,K,+BAGVA,GACPF,KAAK+G,MAAMsd,QAAQnkB,K,+BAGZA,GACPF,KAAK6G,OAAOwd,QAAQnkB,K,uCAIpB,IAAM2iB,EAASD,GAAOE,YACtB9iB,KAAK8G,KAAKwd,UAAUzB,GACpB7iB,KAAK6G,OAAOyd,UAAUzB,GACtB7iB,KAAK4G,IAAI0d,UAAUzB,GACnB7iB,KAAK+G,MAAMud,UAAUzB,K,8BAGf,IACE/b,EAA6B9G,KAA7B8G,KAAMF,EAAuB5G,KAAvB4G,IAAKG,EAAkB/G,KAAlB+G,MAAOF,EAAW7G,KAAX6G,OAC1B,OAAO,IAAIoc,EAAW,CACpBnc,KAAMA,EAAKyd,QACX3d,IAAKA,EAAI2d,QACTxd,MAAOA,EAAMwd,QACb1d,OAAQA,EAAO0d,e,6MC1JfC,G,WASJ,cAEG,IADDhiB,EACC,EADDA,EAAGC,EACF,EADEA,EAAGgB,EACL,EADKA,MAAOE,EACZ,EADYA,Q,4FACZ,SACD3D,KAAKwC,EAAIA,EACTxC,KAAKyC,EAAIA,EACTzC,KAAKyD,MAAQA,EACbzD,KAAK2D,OAASA,E,wDAQPgK,GACP,OAAO3N,KAAKwC,EAAImL,EAAMnL,EAAImL,EAAMlK,OAC3BzD,KAAKyC,EAAIzC,KAAKyC,EAAIkL,EAAMhK,QACxBgK,EAAMnL,EAAIxC,KAAKwC,EAAIxC,KAAKyD,OACxBkK,EAAMlL,EAAIzC,KAAKyC,EAAIzC,KAAK2D,S,iCAQpB9B,GAGT,OAFA7B,KAAKyD,OAAS5B,EACd7B,KAAK2D,QAAU9B,EACR7B,O,mCASIwC,EAAGC,GACd,OAAOD,GAAKxC,KAAKwC,GAAKA,GAAKxC,KAAKwC,EAAIxC,KAAKyD,OACpChB,GAAKzC,KAAKyC,GAAKA,GAAKzC,KAAKyC,EAAIzC,KAAK2D,S,kCAQ7B6b,GAAM,IACRhd,EAAwBgd,EAAxBhd,EAAGC,EAAqB+c,EAArB/c,EAAGgB,EAAkB+b,EAAlB/b,MAAOE,EAAW6b,EAAX7b,OACrB,OAAO3D,KAAKwC,GAAKA,GAAKxC,KAAKwC,EAAIxC,KAAKyD,OAASjB,EAAIiB,GAC5CzD,KAAKyC,GAAKA,GAAKzC,KAAKyC,EAAIzC,KAAK2D,QAAUlB,EAAIkB,I,qCAQnC6b,GACb,OAAO,IAAIgF,EAAK,CACdhiB,EAAGxC,KAAKwC,EAAIgd,EAAKhd,EACjBC,EAAGzC,KAAKyC,EAAI+c,EAAK/c,EACjBgB,MAAOzD,KAAKyD,MACZE,OAAQ3D,KAAK2D,W,8BAUf,OAAO,IAAI6gB,EAAK,CAAEhiB,EADcxC,KAAxBwC,EACaC,EADWzC,KAArByC,EACagB,MADQzD,KAAlByD,MACiBE,OADC3D,KAAX2D,c,qIC9EnB8gB,GAOJ,aAAmC,6DAAJ,GAAI,IAArBjiB,SAAqB,MAAjB,EAAiB,MAAdC,SAAc,MAAV,EAAU,aACjCzC,KAAKwC,EAAIA,EACTxC,KAAKyC,EAAIA,G,2KCbPiiB,G,WAEJ,cAEG,IADDlF,EACC,EADDA,KAAMrZ,EACL,EADKA,KACL,IADWuP,cACX,MADoB,EACpB,G,4FAAA,SACD1V,KAAKwf,KAAOA,EACZxf,KAAKmG,KAAOA,EACZnG,KAAK0V,OAASA,E,sDAGT,IAEH8J,EACExf,KADFwf,KAAMrZ,EACJnG,KADImG,KAAMuP,EACV1V,KADU0V,OAGZlT,EACEgd,EADFhd,EAAGC,EACD+c,EADC/c,EAAGgB,EACJ+b,EADI/b,MAAOE,EACX6b,EADW7b,OAMf,OAJAwC,EAAKuY,OACFc,KAAKhd,EAAGC,EAAGgB,EAAQiS,EAAQ/R,EAAS+R,GACpCkJ,OACAX,YACIje,O,8BAMP,OAFiBA,KAATmG,KACHwY,UACE3e,U,yQCfL2kB,G,WAiCJ,cAeG,QAdDC,gBAcC,MAdUD,EAAME,cAAclQ,OAc9B,MAbDmQ,kBAaC,MAbYH,EAAMI,gBAAgBjP,MAalC,MAZD5V,YAYC,MAZMykB,EAAMK,UAAUC,MAYtB,MAXDA,aAWC,MAXOvlB,EAAWoG,IAWlB,MAVDof,iBAUC,MAVW,KAUX,MATDvhB,cASC,MATQ,GASR,MARDF,aAQC,MARO,GAQP,MAPDiE,aAOC,MAPO,mBAOP,MANDgO,cAMC,MANQ,CAAElT,EAAG,EAAGC,EAAG,GAMnB,MALD0iB,cAKC,MALQ,aAKR,MAJDC,eAIC,MAJS,aAIT,MAHDC,cAGC,MAHQ,aAGR,MAFDC,cAEC,MAFQ,aAER,MADDC,eACC,MADS,aACT,G,4FAAA,SACDvlB,KAAK4kB,SAAWA,EAChB5kB,KAAK8kB,WAAaA,EAClB9kB,KAAKyD,MAAQA,EACbzD,KAAK2D,OAASA,EACd3D,KAAKE,KAAOA,EACZF,KAAKilB,MAAQA,EACbjlB,KAAK0H,MAAQA,EACb1H,KAAKklB,UAAYA,EACjBllB,KAAK0V,OAAS,IAAI+O,GAAY/O,GAC9B1V,KAAKolB,QAAUA,EACfplB,KAAKqlB,OAASA,EACdrlB,KAAKmlB,OAASA,EACdnlB,KAAKslB,OAASA,EACdtlB,KAAKulB,QAAUA,EACfvlB,KAAKwf,KAAO,K,uDAtDZ,IAF8B,IAAZgG,EAAY,uDAAJ,GACpBlR,EAAY,GACTjY,EAAI,EAAGA,EAAImpB,EAAMrlB,OAAQ9D,GAAK,EAAG,CACxC,IAAM8d,EAAOqL,EAAMnpB,GACnBiY,EAAUzL,KAAK,IAAI8b,EAAMxK,IAE3B,OAAO7F,M,qCA0DAkL,GAEP,IAAMiG,EAAiBzlB,KAAK8kB,WACtBY,EAAe1lB,KAAK4kB,SACpBe,EAAczG,GAAM7C,QAAQrc,KAAK0V,OAAOlT,GACxCojB,EAAc1G,GAAM7C,QAAQrc,KAAK0V,OAAOjT,GACxCojB,EAAY3G,GAAM7C,QAAQrc,KAAKyD,OAC/BqiB,EAAa5G,GAAM7C,QAAQrc,KAAK2D,QAEhCoiB,EAAQvG,EAAKhd,EACbwjB,EAAQxG,EAAK/c,EACbwjB,EAAYzG,EAAK/b,MACjByiB,EAAa1G,EAAK7b,OAEpBuY,EAAK,EACLiK,EAAK,EACT,OAAQV,GACN,KAAKd,EAAMI,gBAAgBpQ,OACzBuH,EAAM6J,EAAQE,EAAY,EAAMJ,EAAY,EAC5C,MACF,KAAKlB,EAAMI,gBAAgBlP,KACzBqG,EAAK6J,EACL,MACF,KAAKpB,EAAMI,gBAAgBjP,MACzBoG,EAAK6J,EAAQE,EAAYJ,EAG7B,OAAQH,GACN,KAAKf,EAAME,cAAclQ,OACvBwR,EAAMH,EAAQE,EAAa,EAAMJ,EAAa,EAC9C,MACF,KAAKnB,EAAME,cAAc9O,IACvBoQ,EAAKH,EACL,MACF,KAAKrB,EAAME,cAAcuB,OACvBD,EAAKH,EAAQE,EAAaJ,EAK9B,OAAO,IAAItB,GAAK,CACdhiB,EAHF0Z,GAAMyJ,EAGGljB,EAFT0jB,GAAMP,EAEUniB,MAAOoiB,EAAWliB,OAAQmiB,M,mCAWzC,WADDO,EACC,EADDA,KAAMC,EACL,EADKA,KAEErB,EAAgBjlB,KAAhBilB,MACR,OADwBjlB,KAATE,MAEb,KAAKykB,EAAMK,UAAUC,MACnB,GAAIA,aAAiBsB,MACnBD,EAAKrB,OACA,CACL,IAAMuB,EAAU,IAAID,MACpBC,EAAQjkB,IAAM0iB,EACVuB,EAAQC,UACVzmB,KAAKilB,MAAQuB,EACbF,EAAKtmB,KAAKilB,SAEVuB,EAAQE,OAAS,WACf,EAAKzB,MAAQuB,EACbH,EAAKG,IAEPA,EAAQG,QAAU,WAEhBC,QAAQC,MAAR,gBAAuB5B,MAI7B,MACF,KAAKN,EAAMK,UAAU7e,KACnBmgB,O,kCAYH,IADD9G,EACC,EADDA,KAAMrZ,EACL,EADKA,KAEEjG,EAASF,KAATE,KAER,OADAF,KAAKwf,KAAOA,EACJtf,GACN,KAAKykB,EAAMK,UAAUC,MACnBjlB,KAAK+f,UAAU,CACbP,OAAMrZ,SAER,MACF,KAAKwe,EAAMK,UAAU7e,KACnBnG,KAAK8mB,WAAW,CACdtH,OAAMrZ,Y,oCAcX,IADDqZ,EACC,EADDA,KAAMrZ,EACL,EADKA,KAENnG,KAAKmlB,OAAO,CACV3F,OAAMrZ,W,mCAYP,IADDqZ,EACC,EADDA,KAAMrZ,EACL,EADKA,KAEA8e,EAAQjlB,KAAKilB,MACbvd,EAAQ1H,KAAK0H,MACbqf,EAAe/mB,KAAKyU,SAAS+K,GAEjChd,EACEukB,EADFvkB,EAAGC,EACDskB,EADCtkB,EAAGgB,EACJsjB,EADItjB,MAAOE,EACXojB,EADWpjB,OAETqjB,EAAUxH,EAAKyH,YAAYF,GAC3BG,EAAO,IAAIxC,GAAK,CACpBlF,OAAMrZ,UAEQ,IAAZ6gB,GACFE,EAAKjO,OAEHvR,IACFvB,EAAKE,KAAK,CAAE8gB,UAAWzf,IACvBvB,EAAKmY,SAAS9b,EAAGC,EAAGgB,EAAOE,IAE7BwC,EAAK4Z,UAAUkF,EAAO,EAAG,EAAGA,EAAMxhB,MAAOwhB,EAAMthB,OAAQnB,EAAGC,EAAGgB,EAAOE,IACpD,IAAZqjB,GACFE,EAAKjS,U,qCAaN,IADD/U,EACC,EADDA,KAAMsC,EACL,EADKA,EAAGC,EACR,EADQA,EAAG2kB,EACX,SACO5H,EAAoBxf,KAApBwf,KAAM0F,EAAcllB,KAAdklB,UACd,GAAI1F,EAAM,CACR,IAAM/K,EAAWzU,KAAKyU,SAAS+K,GACzB6H,EAAW5S,EAAS6S,eAAe9H,GACjC+H,EAAarC,EAAbqC,SACR,OAAQrnB,GACN,KAAKykB,EAAM6C,gBAAgBlZ,WACrB+Y,EAASI,aAAajlB,EAAGC,KAC3ByiB,EAAUwC,YAAY1nB,MACtBA,KAAKslB,OAAO,CACV8B,SAAQ3S,cAGZ,MACF,KAAKkQ,EAAM6C,gBAAgBnZ,WACrBgZ,EAASI,aAAajlB,EAAGC,IACvB8kB,IAAavnB,MACfA,KAAKulB,QAAQ,CACX6B,SAAQ3S,aAGZyQ,EAAUwC,YAAY1nB,MACtBA,KAAKqlB,OAAO,CACV+B,SAAQ3S,cAED8S,IACTrC,EAAUwC,YAAY,MACtB1nB,KAAKolB,QAAQ,CACXgC,SAAQ3S,kB,gCAYVxD,GACRjR,KAAKmlB,OAASlU,I,gCAONA,GACRjR,KAAKslB,OAASrU,I,gCAONA,GACRjR,KAAKqlB,OAASpU,I,iCAOLA,GACTjR,KAAKulB,QAAUtU,I,iCAONA,GACTjR,KAAKolB,QAAUnU,I,+BAORiU,GACPllB,KAAKklB,UAAYA,M,4KAIrBP,GAAMI,gBAAkB,CACtBlP,KAAM,EACNC,MAAO,EACPnB,OAAQ,GAEVgQ,GAAME,cAAgB,CACpB9O,IAAK,EACLqQ,OAAQ,EACRzR,OAAQ,GAEVgQ,GAAMK,UAAY,CAChBC,MAAO,EACP0C,OAAQ,GAEVhD,GAAM6C,gBAAkB,CACtBlZ,WAAY,EACZD,WAAY,G,IC1VRuZ,G,uLAEcC,EAAKC,GACrB,KAAMA,aAAgBtoB,MACpB,OAAOsoB,EAET,IAAMhrB,EAAI,CACR,KAAMgrB,EAAKC,WAAa,EACxB,KAAMD,EAAKE,UACX,KAAMF,EAAKG,WACX,KAAMH,EAAKI,aACX,KAAMJ,EAAKK,aACX,KAAM7pB,KAAK8pB,OAAON,EAAKC,WAAa,GAAK,GACzCM,EAAGP,EAAKQ,mBAGJC,EADS,OACWC,KAAKX,GAC/B,GAAIU,EAAY,CACd,IAAME,EAAiBF,EAAW,GAC5BG,EAAWZ,EAAKa,cAAcnqB,WAAYoqB,OAAO,EAAIH,EAAetoB,QAC1E0nB,EAAMA,EAAI3iB,QAAQujB,EAAgBC,GAGpC,IAAK,IAAMhf,KAAK5M,EAAG,CACjB,IACM+rB,EADK,IAAIC,OAAJ,WAAepf,EAAf,MACI8e,KAAKX,GACpB,GAAIgB,EAAK,CACP,IAAME,EAAMjsB,EAAE4M,GAAGlL,WACXwqB,EAAaH,EAAI,GACjBI,EAAoC,IAAtBD,EAAW7oB,OAAiB4oB,EAAQ,YAAMA,GAAOH,OAAOG,EAAI5oB,QAChF0nB,EAAMA,EAAI3iB,QAAQ8jB,EAAYC,IAGlC,OAAOpB,I,4BAGI/e,GACX,IAAIkE,EAASlE,EACb,OAAIkE,aAAkBxN,OAItBwN,EAAS4a,EAAUsB,aAAapgB,EAAM,iBAItCkE,EAAS4a,EAAUsB,aAAapgB,EAAM,YAItCkE,EAAS4a,EAAUsB,aAAapgB,EAAM,0BAKtCkE,EAAS4a,EAAUsB,aAAapgB,EAAM,iBAItCkE,EAAS4a,EAAUsB,aAAapgB,EAAM,YAItCkE,EAAS4a,EAAUsB,aAAapgB,EAAM,0BAKtCkE,EAAS4a,EAAUsB,aAAapgB,EAAM,eAKtCkE,EAAS4a,EAAUsB,aAAapgB,EAAM,eAItCkE,EAAS4a,EAAUsB,aAAapgB,EAAM,WAtC7BkE,GA0CTA,EAAS4a,EAAUsB,aAAapgB,EAAM,0BAK/BA,I,mCAGWqgB,EAAUC,GAC5B,IAAKD,EACH,OAAO,KA0BT,IAxBA,IAAME,EAAa,IAAI7pB,KAAK,uBACtB1C,EAAI,CAAC,CACTwsB,IAAK,MACJ,CACDA,IAAK,MACJ,CACDA,IAAK,MACJ,CACDA,IAAK,MACJ,CACDA,IAAK,MACJ,CACDA,IAAK,MACJ,CACDA,IAAK,MAEHC,EAAOF,EAAWV,cAClBa,EAAQH,EAAWtB,WAAa,EAChC0B,EAAMJ,EAAWrB,UACjB0B,EAAQL,EAAWpB,WACnB0B,EAAUN,EAAWnB,aACrB0B,EAAUP,EAAWlB,aACrB0B,EAAeR,EAAWf,kBAC1BpmB,EAAQ,EACH4nB,EAAI,EAAGA,EAAIV,EAAOjpB,OAAQ2pB,GAAK,EAEtC,IADA,IAAMC,EAAUX,EAAOU,GACdztB,EAAI,EAAGA,EAAIS,EAAEqD,OAAQ9D,GAAK,EAAG,CACpC,IAAM2tB,EAAUltB,EAAET,GAElB,GADmB2tB,EAAQV,IACZ,KAAOS,EAAS,CACxBC,EAAQ9nB,QACX8nB,EAAQ9nB,MAAQA,EAChBA,GAAS,GAEX,OAIN,IAAK,IAAI7F,EAAI,EAAGA,EAAIS,EAAEqD,OAAQ9D,GAAK,EAAG,CACpC,IACM4tB,EADUntB,EAAET,GACSitB,IAErBT,EADK,IAAIC,OAAJ,WAAemB,EAAf,MACIzB,KAAKY,GACpB,GAAIP,EAAK,CACP,IAAMG,EAAaH,EAAI,GACjBI,EAAa,YAAH,OAAeD,EAAW7oB,OAA1B,MAEhBipB,EAASA,EAAOlkB,QAAQ8jB,EAAYC,IAGxC,IAAMiB,EAAW,GAEXrB,EADK,IAAIC,OAAOM,GACPZ,KAAKW,GACpB,IAAIN,EAKF,OAAO,KAJP,IAAK,IAAIxsB,EAAI,EAAGA,EAAIwsB,EAAI1oB,OAAQ9D,GAAK,EACnC6tB,EAAS7tB,GAAKwsB,EAAIxsB,GAiCtB,OA5BIS,EAAE,GAAGoF,QAEPqnB,EAAOW,EADWptB,EAAE,GAAZoF,QAGNpF,EAAE,GAAGoF,QAEPsnB,EAAQU,EADUptB,EAAE,GAAZoF,QAGNpF,EAAE,GAAGoF,QAEPunB,EAAMS,EADYptB,EAAE,GAAZoF,QAGNpF,EAAE,GAAGoF,QAEPwnB,EAAQQ,EADUptB,EAAE,GAAZoF,QAGNpF,EAAE,GAAGoF,QAEPynB,EAAUO,EADQptB,EAAE,GAAZoF,QAGNpF,EAAE,GAAGoF,QAEP0nB,EAAUM,EADQptB,EAAE,GAAZoF,QAGNpF,EAAE,GAAGoF,QAEP2nB,EAAeK,EADGptB,EAAE,GAAZoF,QAGH,IAAI1C,KAAK+pB,EAAMC,EAAQ,EAAGC,EAAKC,EAAOC,EAASC,EAASC,O,sNCvD7DT,GAAS,I,uLAzHH9rB,GACR,OAAIoC,EAAWqC,SAASzE,GACPoC,EAAWsC,WAAW1E,GACvB6sB,cAAc,GAEvB7sB,I,8BAGDA,GACN,OAAOA,EAAQA,EAAMkB,WAAa,K,2BAG/BlB,GACH,OAAOA,I,8BAGDA,GACN,GAAIoC,EAAWqC,SAASzE,GAAQ,CAC9B,IAAMuH,EAAUvH,EAAMkB,WAAWqG,QAAQ,KACzC,OAAiB,IAAbA,EACKvH,EAAMkB,WAAWC,UAAU,EAAGoG,EAAU,GAEjD,UAAUvH,EAAV,OAEF,OAAOA,I,6BAGFA,GACL,OAAIoC,EAAWqC,SAASzE,GACfoC,EAAWsC,WAAW1E,GAExBA,I,iCAGEA,GACT,OAAIoC,EAAWqC,SAASzE,GACtB,UAAUA,EAAV,KAEKA,I,+BAGAA,GACP,GAAIoC,EAAW0qB,WAAW9sB,GAAQ,CAChC,IAAMwJ,EAAOxJ,EAAM+sB,MAAM,KAAK,GACxBtjB,EAAQzJ,EAAM+sB,MAAM,KAAK,GAC/B,OAAO3qB,EAAWuC,SAAS6E,GAAQpH,EAAWuC,SAAS8E,GAEzD,OAAOzJ,I,0BAGLA,GACF,OAAIoC,EAAWqC,SAASzE,GACtB,WAAWA,GAENA,I,yBAGNA,GACD,OAAIoC,EAAWqC,SAASzE,GACtB,YAAYA,GAEPA,I,2BAGJA,GACH,IAAM0P,EAAS4a,GAAUtmB,MAAMhE,GAC/B,OAAI0P,EACK4a,GAAU0C,WAAW,WAAYtd,GAEnC1P,I,4BAGHA,GACJ,IAAM0P,EAAS4a,GAAUtmB,MAAMhE,GAC/B,OAAI0P,EACK4a,GAAU0C,WAAW,aAActd,GAErC1P,I,4BAGHA,GACJ,IAAM0P,EAAS4a,GAAUtmB,MAAMhE,GAC/B,OAAI0P,EACK4a,GAAU0C,WAAW,SAAUtd,GAEjC1P,I,4BAGHA,GACJ,IAAM0P,EAAS4a,GAAUtmB,MAAMhE,GAC/B,OAAI0P,EACK4a,GAAU0C,WAAW,WAAYtd,GAEnC1P,I,4BAGHA,GACJ,IAAM0P,EAAS4a,GAAUtmB,MAAMhE,GAC/B,OAAI0P,EACK4a,GAAU0C,WAAW,cAAetd,GAEtC1P,I,4BAGHA,GACJ,IAAM0P,EAAS4a,GAAUtmB,MAAMhE,GAC/B,OAAI0P,EACK4a,GAAU0C,WAAW,sBAAuBtd,GAE9C1P,I,6BAGFA,GACL,OAAIoC,EAAWqC,SAASzE,GACtB,WAAWA,GAENA,O,mCAOI,YAAC4C,EAAM5C,GAAP,OAAiB8rB,GAAOlpB,GAAM5C,I,0QC7HvCitB,G,WAEJ,aAUQ,6DAAJ,GAAI,IATNzhB,YASM,MATC,GASD,MARNpB,aAQM,MAREgT,GAAWO,MAQb,MAPNre,YAOM,MAPC,QAOD,MANNiF,YAMM,MANC,GAMD,MALN8F,YAKM,aAJNC,cAIM,aAHNC,qBAGM,aAFNC,iBAEM,SADNwT,EACM,EADNA,aACM,WACNtb,KAAK8I,KAAOA,EACZ9I,KAAK0H,MAAQA,EACb1H,KAAKpD,KAAOA,EACZoD,KAAK6B,KAAOA,EACZ7B,KAAK4H,OAASA,EACd5H,KAAK2H,KAAOA,EACZ3H,KAAK6H,cAAgBA,EACrB7H,KAAK8H,UAAYA,EACjB9H,KAAKsb,aAAeA,E,uDAOpB,OAAO,IAAIiP,EAAS,CAClBzhB,KAJkC9I,KAA5B8I,KAIApB,MAJ4B1H,KAAtB0H,MAIC9K,KAJqBoD,KAAfpD,KAIAiF,KAJe7B,KAAT6B,KAIA+F,OAHS5H,KAA5B4H,OAG2BD,KAHC3H,KAApB2H,KAGyBG,UAHL9H,KAAd8H,UAG8BD,cAFZ7H,KAAhC6H,cAE2DyT,aAF3Btb,KAAjBsb,iB,8BAOvBtb,KAAK0H,MAAQgT,GAAWO,MACxBjb,KAAKpD,KAAO,QACZoD,KAAK6B,KAAO,GACZ7B,KAAK2H,MAAO,EACZ3H,KAAK4H,QAAS,EACd5H,KAAK6H,eAAgB,EACrB7H,KAAK8H,WAAY,I,8BAGI,IAAjBoJ,EAAiB,uDAAR,SAAAnQ,GAAC,OAAIA,GAClB,OAAOmQ,EAAOlR,KAAKukB,W,6BAGd5W,GACL,OAAIjO,EAAWO,QAAQ0N,IAGnBA,EAAM7E,OAAS9I,KAAK8I,MAGpB6E,EAAMjG,QAAU1H,KAAK0H,OAGrBiG,EAAM/Q,OAASoD,KAAKpD,MAGpB+Q,EAAM9L,OAAS7B,KAAK6B,MAGpB8L,EAAM/F,SAAW5H,KAAK4H,QAGtB+F,EAAMhG,OAAS3H,KAAK2H,MAGpBgG,EAAM9F,gBAAkB7H,KAAK6H,eAG1B8F,EAAM7F,YAAc9H,KAAK8H,e,4SCxE9B0iB,G,WAEJ,aAEQ,6DAAJ,GAAI,IADNC,YACM,MADC,GACD,aACNzqB,KAAKyqB,KAAOA,EAAKjiB,KAAI,SAAAkiB,GAAI,OAAI,IAAIH,GAASG,M,yDAGzB,IAAXD,EAAW,uDAAJ,GACbzqB,KAAKyqB,KAAOA,I,gCAIZ,OAAOzqB,KAAKyqB,O,8BAIZ,IAAMA,EAAO,GAIb,OAHAzqB,KAAKyqB,KAAK7pB,SAAQ,SAAC8pB,GACjBD,EAAK5hB,KAAK6hB,EAAKnG,YAEV,IAAIiG,EAAU,CACnBC,W,8BAKFzqB,KAAK2qB,MAAK,SAACtuB,GACTA,EAAEuuB,a,kCAKJ,OAAO5qB,KAAKyqB,KAAKtqB,OAAS,I,6BAGR,IAAfwB,EAAe,uDAAV,aACR3B,KAAKyqB,KAAK7pB,SAAQ,SAAC8pB,GACjB/oB,EAAG+oB,Q,4BAIDxZ,GACJ,IAAMlE,EAAS,GAIf,OAHAhN,KAAKyqB,KAAK7pB,SAAQ,SAAC8pB,GACjB1d,EAAOnE,KAAK6hB,EAAKG,MAAM3Z,OAElBlE,I,6BAGFW,GACL,GAAIjO,EAAWO,QAAQ0N,GACrB,OAAO,EAET,GAAIA,EAAM8c,KAAKtqB,SAAWH,KAAKyqB,KAAKtqB,OAClC,OAAO,EAET,IAAK,IAAI9D,EAAI,EAAGA,EAAI2D,KAAKyqB,KAAKtqB,OAAQ9D,IAAK,CACzC,IAAIyuB,EAAQ9qB,KAAKyqB,KAAKpuB,GAClB0uB,EAAQpd,EAAM8c,KAAKpuB,GACvB,IAAKyuB,EAAMld,OAAOmd,GAChB,OAAO,EAGX,OAAO,O,wWCvBLC,GAAY,I,WAnChB,aAAc,WACZhrB,KAAKirB,UAAY,G,0CAOZruB,UACEoD,KAAKirB,UAAUruB,K,kCAQZA,GACV,OAAOoD,KAAKirB,UAAUruB,EAAKsuB,oB,+BAQpBtuB,EAAMuuB,GACbnrB,KAAKirB,UAAUruB,EAAKsuB,kBAAoBC,M,MAatCC,G,WAKJ,aAAc,WACZprB,KAAKqrB,SAAW,G,iDAUhB,IAHY,IACNA,EAAarrB,KAAbqrB,SAECA,EAASC,SADL,SACqB,KACxBnrB,EAAWkrB,EAAXlrB,OACNkrB,EAAWA,EAAS5sB,UAAU,EAAG0B,EAHxB,OAGsCA,QAEjD,OAAOkrB,I,mCAOI/tB,GACX0C,KAAKqrB,UAAL,gBAA0B/tB,EAA1B,U,oCAOYiuB,GACZvrB,KAAKqrB,UAAL,UAAoBE,EAApB,U,kCAOUjuB,GACV0C,KAAKqrB,UAAL,gBAA0B/tB,EAA1B,U,kCAOUA,GACV0C,KAAKqrB,UAAL,gBAA0B/tB,EAA1B,Y,KAOEkuB,G,WAMJ,aAEQ,6DAAJ,GAAI,IADNC,mBACM,oBACNzrB,KAAKyrB,YAAcA,E,2CAQbC,GAaN,IAZA,IAAIC,EAAW,6CACXC,EAAU,SACVC,EAAU,cAER1rB,EAAWurB,EAAXvrB,OAEF2rB,EAAgB,GAEhB1Y,EAAU,EAEV2Y,EAAS,GAEN3Y,EAAUjT,GAAQ,CAEvB,IAAI6rB,EAAON,EAAMtY,GAEb6Y,EAAQ,KACZ,GAAIA,EAAMtsB,KAAKqsB,GAAO,CACpB,IAAME,EAAOR,EAAMtY,EAAU,GAC7B,GAAI6Y,EAAMtsB,KAAKusB,GAAO,CACpB9Y,IACA,UAIJ,GAAI6Y,EAAMtsB,KAAKqsB,GAAf,CACE,IAAMG,EAAOT,EAAMtY,EAAU,GACvB8Y,EAAOR,EAAMtY,EAAU,GACzByY,EAAQlsB,KAAKwsB,IAASN,EAAQlsB,KAAKusB,IACrCH,EAAOljB,KAAK,CACV3I,KAAM,WACN5C,MAAO0uB,IAGX5Y,SAIF,GAAa,MAAT4Y,EAYJ,GAAa,MAATA,EAiBJ,GAAa,MAATA,EAYJ,GAAa,MAATA,EASJ,GAAa,MAATA,EAqBJ,GAAa,MAATA,EAsBJ,GAAIL,EAAShsB,KAAKqsB,GAAlB,CACE,IAAIE,EAAOR,EAAMtY,EAAU,GACvBpG,EAAS,GAAH,OAAMgf,GAAN,OAAaE,GACnBP,EAAShsB,KAAKqN,IAChB+e,EAAOljB,KAAK,CACV3I,KAAM,WACN5C,MAAO0P,IAEToG,KAEA2Y,EAAOljB,KAAK,CACV3I,KAAM,WACN5C,MAAO0uB,IAGX5Y,SAIF,GAAIwY,EAAQjsB,KAAKqsB,GAAjB,CAEE,IADA,IAAIhf,EAAS,GACN4e,EAAQjsB,KAAKqsB,IACd5Y,EAAUjT,GACZ6M,GAAUgf,EAEVA,EAAON,IADPtY,GAMJ2Y,EAAOljB,KAAK,CACV3I,KAAM,SACN5C,MAAO0P,QAbX,CAkBA,IAAI6e,EAAQlsB,KAAKqsB,GAmCjB,MAAM,IAAItO,UAAJ,qBAA4BsO,EAA5B,MAjCJ,IADA,IAAIhf,EAAS,GACN6e,EAAQlsB,KAAKqsB,IACd5Y,EAAUjT,GACZ6M,GAAUgf,EAEVA,EAAON,IADPtY,GAOS,MAAT4Y,GACFD,EAAOljB,KAAK,CACV3I,KAAM,WACN5C,MAAO0P,IAET+e,EAAOljB,KAAK,CACV3I,KAAM,WACN5C,MAAO,MAETwuB,EAAcjjB,KAAK,CACjB3I,KAAM,WACN5C,MAAO,MAET8V,KAEA2Y,EAAOljB,KAAK,CACV3I,KAAM,UACN5C,MAAO0P,QAxFb,CACE,IAAIA,EAAS,GAGb,IADAgf,EAAON,IADPtY,GAEgB,MAAT4Y,GACD5Y,EAAUjT,GACZ6M,GAAUgf,EAEVA,EAAON,IADPtY,GAOJ4Y,EAAON,IADPtY,GAEA2Y,EAAOljB,KAAK,CACV3I,KAAM,SACN5C,MAAO0P,QAtCX,CACE,IAAIA,EAAS,GAGb,IADAgf,EAAON,IADPtY,GAEgB,MAAT4Y,GACD5Y,EAAUjT,GACZ6M,GAAUgf,EAEVA,EAAON,IADPtY,GAOJ4Y,EAAON,IADPtY,GAEA2Y,EAAOljB,KAAK,CACV3I,KAAM,SACN5C,MAAO0P,SAzBT+e,EAAOljB,KAAK,CACV3I,KAAM,QACN5C,MAAO,MAET8V,SAhBA2Y,EAAOljB,KAAK,CACV3I,KAAM,QACN5C,MAAO,UAETyuB,EAAOljB,KAAK,CACV3I,KAAM,QACN5C,MAAO,MAET8V,QA1BF,CACE,IAAMgZ,EAAWN,EAAcO,MAC3BD,GAA8B,aAAlBA,EAASlsB,KACvB6rB,EAAOljB,KAAK,CACV3I,KAAM,WACN5C,MAAO,MAGTyuB,EAAOljB,KAAK,CACV3I,KAAM,WACN5C,MAAO,MAGX8V,SAxBA2Y,EAAOljB,KAAK,CACV3I,KAAM,WACN5C,MAAO,MAETwuB,EAAcjjB,KAAK,CACjB3I,KAAM,WACN5C,MAAO,MAET8V,IA+JJ,OAAIpT,KAAKyrB,YACAzrB,KAAKssB,OAAOP,GAEdA,I,6BAOFA,GA8VL,IA5VA,IAAIQ,EAAe,GAEfC,EAAe,GAEfC,EAAY,GAEZC,EAAa,GAEbZ,EAAgB,GAEhB1Y,EAAU,EAERjT,EAAW4rB,EAAX5rB,OAEFwsB,EAAc,SAACC,GACjB,MAAmB,UAAfA,EAAM1sB,MACe,UAAhB0sB,EAAMtvB,OAKbuvB,EAAa,SAACD,GAChB,MAAmB,aAAfA,EAAM1sB,OACe,MAAhB0sB,EAAMtvB,OAAiC,MAAhBsvB,EAAMtvB,QAKpCwvB,EAAkB,SAACC,EAAK7qB,GAC1B,GAAY,SAAR6qB,EACF,KAAO7qB,GAAS,GAAG,CACjB,IAAI0qB,EAAQb,EAAO7pB,GACnB,GAAI2qB,EAAWD,GACb1qB,QADF,CAIA,IAAIyqB,EAAYC,GAIhB,OAAOA,EAHL1qB,KAMN,GAAY,SAAR6qB,EACF,KAAO7qB,EAAQ/B,GAAQ,CACrB,IAAIysB,EAAQb,EAAO7pB,GACnB,GAAI2qB,EAAWD,GACb1qB,QADF,CAIA,IAAIyqB,EAAYC,GAIhB,OAAOA,EAHL1qB,KAMN,OAAO,MAGL8qB,EAAa,SAACD,EAAKxrB,GACrB,IAAIqrB,EAAQb,EAAO3Y,GACf6Z,EAAgB,SAARF,EAAiB,KAAO,KACpC,GAAoB,MAAhBH,EAAMtvB,MAAe,CACvB,GAAY,SAARyvB,EACF,OAAQxrB,EAAOrB,MACb,IAAK,QACH,GAAqB,MAAjBqB,EAAOjE,MACT,OAEF,MAEF,IAAK,WAML,IAAK,WACH,GAAqB,MAAjBiE,EAAOjE,MACT,OAEF,MAEF,IAAK,WAIH,YAHIiE,EAAOjE,MAOjB,GAAY,SAARyvB,EACF,OAAQxrB,EAAOrB,MACb,IAAK,SACL,IAAK,QACL,IAAK,SACL,IAAK,UACH,OAEF,IAAK,WAML,IAAK,WACH,GAAqB,MAAjBqB,EAAOjE,MACT,QAOV,GAAoB,MAAhBsvB,EAAMtvB,MAAe,CACvB,GAAY,SAARyvB,EACF,OAAQxrB,EAAOrB,MACb,IAAK,SACL,IAAK,SACL,IAAK,QACL,IAAK,UACH,OAEF,IAAK,WAML,IAAK,WACH,GAAqB,MAAjBqB,EAAOjE,MACT,OAMR,GAAY,SAARyvB,EACF,OAAQxrB,EAAOrB,MACb,IAAK,QACH,GAAqB,MAAjBqB,EAAOjE,MACT,OAEF,MAEF,IAAK,WAML,IAAK,WACH,GAAqB,MAAjBiE,EAAOjE,MACT,OAEF,MAEF,IAAK,WAIH,YAHIiE,EAAOjE,OAQnB,MAAMogB,UAAU,SAAD,OAAUkP,EAAMtvB,MAAhB,YAAyB2vB,EAAzB,YAAkC1rB,EAAOjE,SAGtD4vB,EAAa,SAACH,EAAKxrB,GACrB,IAAIqrB,EAAQb,EAAO3Y,GACf6Z,EAAgB,SAARF,EAAiB,KAAO,KACpC,OAAQxrB,EAAOrB,MACb,IAAK,QACH,GAAY,SAAR6sB,GACmB,MAAjBxrB,EAAOjE,MACT,OAGJ,GAAY,SAARyvB,GACmB,MAAjBxrB,EAAOjE,MACT,OAGJ,MAEF,IAAK,WAaL,IAAK,WACH,GAAY,SAARyvB,GACmB,MAAjBxrB,EAAOjE,MACT,OAGJ,GAAY,SAARyvB,GACmB,MAAjBxrB,EAAOjE,MACT,OAGJ,MAEF,IAAK,WACH,OAGJ,MAAMogB,UAAU,SAAD,OAAUkP,EAAMtvB,MAAhB,YAAyB2vB,EAAzB,YAAkC1rB,EAAOjE,SAGtD6vB,EAAgB,SAACJ,EAAKxrB,GACxB,IAAIqrB,EAAQb,EAAO3Y,GACf6Z,EAAgB,SAARF,EAAiB,KAAO,KACpC,OAAQxrB,EAAOrB,MACb,IAAK,WACL,IAAK,WACL,IAAK,SACL,IAAK,SACL,IAAK,UACH,OAEF,IAAK,QACH,GAAoB,MAAhB0sB,EAAMtvB,MACR,OAKN,MAAMogB,UAAU,SAAD,OAAUkP,EAAMtvB,MAAhB,YAAyB2vB,EAAzB,YAAkC1rB,EAAOjE,SAGtD8vB,EAAgB,SAACL,EAAKxrB,GACxB,IAAIqrB,EAAQb,EAAO3Y,GACf6Z,EAAgB,SAARF,EAAiB,KAAO,KACpC,GAAoB,MAAhBH,EAAMtvB,MAAe,CACvB,GAAY,SAARyvB,EACF,OAAQxrB,EAAOrB,MACb,IAAK,QACH,GAAqB,MAAjBqB,EAAOjE,MACT,OAEF,MAEF,IAAK,WAML,IAAK,WACH,GAAqB,MAAjBiE,EAAOjE,MACT,OAEF,MAEF,IAAK,WACH,OAIN,GAAY,SAARyvB,EACF,OAAQxrB,EAAOrB,MACb,IAAK,WACL,IAAK,SACL,IAAK,SACL,IAAK,UACH,OAEF,IAAK,QACH,GAAqB,MAAjBqB,EAAOjE,MACT,OAEF,MAEF,IAAK,WACH,GAAqB,MAAjBiE,EAAOjE,MACT,QAOV,GAAoB,MAAhBsvB,EAAMtvB,MAAe,CACvB,GAAY,SAARyvB,EACF,OAAQxrB,EAAOrB,MACb,IAAK,WACL,IAAK,SACL,IAAK,SACL,IAAK,UACH,OAEF,IAAK,QACH,GAAqB,MAAjBqB,EAAOjE,MACT,OAEF,MAEF,IAAK,WACH,GAAqB,MAAjBiE,EAAOjE,MACT,OAMR,GAAY,SAARyvB,EACF,OAAQxrB,EAAOrB,MACb,IAAK,QACH,GAAqB,MAAjBqB,EAAOjE,MACT,OAEF,MAEF,IAAK,WAML,IAAK,WACH,GAAqB,MAAjBiE,EAAOjE,MACT,OAEF,MAEF,IAAK,WAIH,YAHIiE,EAAOjE,OAQnB,MAAMogB,UAAU,SAAD,OAAUkP,EAAMtvB,MAAhB,YAAyB2vB,EAAzB,YAAkC1rB,EAAOjE,SAGnD8V,EAAUjT,GAAQ,CAEvB,IAAIysB,EAAQb,EAAO3Y,GAEnB,GAAIuZ,EAAYC,GACdxZ,SAGF,GAAIyZ,EAAWD,GACbxZ,QADF,CARuB,IAYjBlT,EAAgB0sB,EAAhB1sB,KAAM5C,EAAUsvB,EAAVtvB,MAwBZ,GAtBa,MAAT4C,IACEqsB,EAAapsB,OACfosB,EAAaF,MAGRG,EAAarsB,QAChBosB,EAAa1jB,KAAK,MAKX,MAAT3I,IACEssB,EAAarsB,OACfqsB,EAAaH,MAGRE,EAAapsB,QAChBqsB,EAAa3jB,KAAK,MAKX,WAAT3I,EAAmB,CACrB,IAAIisB,EAAOW,EAAgB,OAAQ1Z,EAAU,GACzC8Y,EAAOY,EAAgB,OAAQ1Z,EAAU,GACzC+Y,GACFe,EAAW,OAAQf,GAEjBD,GACFgB,EAAW,OAAQhB,GAIvB,GAAa,WAAThsB,EAAmB,CACrB,IAAIisB,EAAOW,EAAgB,OAAQ1Z,EAAU,GACzC8Y,EAAOY,EAAgB,OAAQ1Z,EAAU,GACzC+Y,GACFe,EAAW,OAAQf,GAEjBD,GACFgB,EAAW,OAAQhB,GAIvB,GAAa,UAAThsB,EAAkB,CAIpB,GAHc,MAAV5C,GACFovB,EAAW7jB,KAAK+jB,GAEJ,MAAVtvB,EAAe,CACjB,GAA0B,IAAtBovB,EAAWvsB,OACb,MAAM,IAAIud,UAAU,YAEtBgP,EAAWL,MAEb,IAAIF,EAAOW,EAAgB,OAAQ1Z,EAAU,GACzC8Y,EAAOY,EAAgB,OAAQ1Z,EAAU,GACzC+Y,GACFa,EAAW,OAAQb,GAEjBD,GACFc,EAAW,OAAQd,GAIvB,GAAa,aAAThsB,EAAqB,CACT,MAAV5C,GACFmvB,EAAU5jB,KAAK+jB,GAEH,MAAVtvB,GACFmvB,EAAUJ,MAEZ,IAAIF,EAAOW,EAAgB,OAAQ1Z,EAAU,GACzC8Y,EAAOY,EAAgB,OAAQ1Z,EAAU,GACzC+Y,GACFiB,EAAc,OAAQjB,GAEpBD,GACFkB,EAAc,OAAQlB,GAI1B,GAAa,aAAThsB,EAAqB,CACvB,IAAIisB,EAAOW,EAAgB,OAAQ1Z,EAAU,GACzC8Y,EAAOY,EAAgB,OAAQ1Z,EAAU,GAE7C,IAAI+Y,EAGF,MAAMzO,UAAU,UAAD,OAAWkP,EAAMtvB,MAAjB,QAEjB,GAJE6vB,EAAc,OAAQhB,IAIpBD,EAGF,MAAMxO,UAAU,UAAD,OAAWkP,EAAMtvB,MAAjB,QAFf6vB,EAAc,OAAQjB,GAM1B,GAAa,aAAThsB,IACY,MAAV5C,GACFwuB,EAAcjjB,KAAK+jB,GAEP,MAAVtvB,GAAe,CACjB,GAA6B,IAAzBwuB,EAAc3rB,OAChB,MAAM,IAAIud,UAAU,YAEtBoO,EAAcO,MAIlBjZ,KAGF,GAAIsZ,EAAWvsB,OACb,MAAM,IAAIud,UAAU,YAEtB,GAAI+O,EAAUtsB,OACZ,MAAM,IAAIud,UAAU,YAEtB,GAAI6O,EAAapsB,OACf,MAAM,IAAIud,UAAU,aAEtB,GAAI8O,EAAarsB,OACf,MAAM,IAAIud,UAAU,aAEtB,GAAIoO,EAAc3rB,OAChB,MAAM,IAAIud,UAAU,YAEtB,OAAOqO,M,KAOLsB,G,WAOJ,aAEQ,6DAAJ,GADFtB,EACM,EADNA,OAAQuB,EACF,EADEA,OACF,WACNttB,KAAKstB,OAASA,EACdttB,KAAK+rB,OAASA,EACd/rB,KAAKutB,WAAa,GAClBvtB,KAAKkC,OAAS,EACdlC,KAAKwtB,OAAS,CAAC,KAEfxtB,KAAKytB,KAAO,CACV,IAAK,OACL,IAAK,OACL,IAAK,OACL,KAAM,YACN,KAAM,YACN,KAAM,QAERztB,KAAK0tB,MAAQ,CACX,IAAK,MACL,IAAK,MACL,IAAK,QAEP1tB,KAAK2tB,MAAQ,CACX,IAAK,MACL,IAAK,MACL,IAAK,MACL,IAAK,SAEP3tB,KAAK4tB,SAAW,CACd,IAAK,UAEP5tB,KAAK6tB,MAAQ,CACX,IAAK,MACL,IAAK,OAEP7tB,KAAK8tB,MAAQ,CACX9oB,MAAO,YAEThF,KAAK+tB,OAAS,CACZC,SAAU,U,8CAUZ,OAF0BhuB,KAAlBkC,OAAkBlC,KAAX+rB,OACP5rB,OACiB,I,kCASzB,OAFAH,KAAKkC,QACLlC,KAAK4sB,MAAQ5sB,KAAK+rB,OAAO/rB,KAAKkC,OACvBlC,KAAK4sB,Q,kCASZ,OAFA5sB,KAAKkC,QACLlC,KAAK4sB,MAAQ5sB,KAAK+rB,OAAO/rB,KAAKkC,OACvBlC,KAAK4sB,Q,oCAMA,IACJW,EAAevtB,KAAfutB,WACAptB,EAAWotB,EAAXptB,OACR,GAAIA,EAAS,EAAG,CACd,IAAMgsB,EAAOoB,EAAWptB,EAAS,GAC3B8tB,EAAS9B,EAAK8B,OACpB9B,EAAK8B,OAASA,EAAS,K,sCAOX,IACNV,EAAevtB,KAAfutB,WACAptB,EAAWotB,EAAXptB,OACR,GAAIA,EAAS,EAAG,CACd,IAAMgsB,EAAOoB,EAAWptB,EAAS,GAC3B8tB,EAAS9B,EAAK8B,OACpB9B,EAAK8B,OAASA,EAAS,K,iCAQzB,OAAOjuB,KAAKutB,WAAWlB,Q,+BAMhBO,GAGP,OAFAA,EAAMqB,OAAS,EACfjuB,KAAKutB,WAAW1kB,KAAK+jB,GACdA,I,wCAQP,IAAK5sB,KAAKkuB,WAAY,KACZV,EAAWxtB,KAAXwtB,OACRxtB,KAAKmuB,YAFe,IAGZvB,EAAU5sB,KAAV4sB,MACR5sB,KAAKouB,YAJe,IAKZ9wB,EAAUsvB,EAAVtvB,MACR,OAAOkwB,EAAO7kB,SAASrL,GAEzB,OAAO,I,gCAMC,IACAgwB,EAAWttB,KAAXstB,OAER,IADAttB,KAAKquB,cACEruB,KAAKsuB,mBACVtuB,KAAKmuB,YACLnuB,KAAKquB,cAEP,OAAOf,EAAOiB,gB,oCAQd,IADAvuB,KAAKwuB,cACGxuB,KAAKkuB,YAAY,CACvB,IAAMtB,EAAQ5sB,KAAKmuB,YACXjuB,EAAgB0sB,EAAhB1sB,KAAM5C,EAAUsvB,EAAVtvB,MACd,GAAa,aAAT4C,EAAqB,CACvBF,KAAKouB,YACL,MAEF,IAAKpuB,KAAKytB,KAAKnwB,GAAQ,CACrB0C,KAAKouB,YACL,MAEF,IAAIK,EAAWzuB,KAAKytB,KAAKnwB,GACzB0C,KAAKwuB,aACLxuB,KAAK0uB,cACL1uB,KAAKstB,OAAOqB,cAAcF,M,mCAS5B,IADAzuB,KAAK4uB,cACG5uB,KAAKkuB,YAAY,CACvB,IAAMtB,EAAQ5sB,KAAKmuB,YACXjuB,EAAgB0sB,EAAhB1sB,KAAM5C,EAAUsvB,EAAVtvB,MACd,GAAa,aAAT4C,EAAqB,CACvBF,KAAKouB,YACL,MAEF,IAAKpuB,KAAK0tB,MAAMpwB,GAAQ,CACtB0C,KAAKouB,YACL,MAEF,IAAIK,EAAWzuB,KAAK0tB,MAAMpwB,GAC1B0C,KAAK4uB,aACL5uB,KAAK0uB,cACL1uB,KAAKstB,OAAOqB,cAAcF,M,mCAS5B,IADAzuB,KAAK6uB,iBACG7uB,KAAKkuB,YAAY,CACvB,IAAMtB,EAAQ5sB,KAAKmuB,YACXjuB,EAAgB0sB,EAAhB1sB,KAAM5C,EAAUsvB,EAAVtvB,MACd,GAAa,aAAT4C,EAAqB,CACvBF,KAAKouB,YACL,MAEF,IAAKpuB,KAAK2tB,MAAMrwB,GAAQ,CACtB0C,KAAKouB,YACL,MAEF,IAAIK,EAAWzuB,KAAK2tB,MAAMrwB,GAC1B0C,KAAK6uB,gBACL7uB,KAAK0uB,cACL1uB,KAAKstB,OAAOqB,cAAcF,M,sCAS5B,IADAzuB,KAAK8uB,cACG9uB,KAAKkuB,YAAY,CACvB,IAAMtB,EAAQ5sB,KAAKmuB,YACXjuB,EAAgB0sB,EAAhB1sB,KAAM5C,EAAUsvB,EAAVtvB,MACd,GAAa,aAAT4C,EAAqB,CACvBF,KAAKouB,YACL,MAEF,IAAKpuB,KAAK4tB,SAAStwB,GAAQ,CACzB0C,KAAKouB,YACL,MAEF,IAAIK,EAAWzuB,KAAK4tB,SAAStwB,GAC7B0C,KAAK8uB,aACL9uB,KAAK0uB,cACL1uB,KAAKstB,OAAOqB,cAAcF,M,mCAS5B,IADAzuB,KAAK+uB,gBACG/uB,KAAKkuB,YAAY,CACvB,IAAMtB,EAAQ5sB,KAAKmuB,YACXjuB,EAAgB0sB,EAAhB1sB,KAAM5C,EAAUsvB,EAAVtvB,MACd,GAAa,aAAT4C,EAAqB,CACvBF,KAAKouB,YACL,MAEF,IAAKpuB,KAAK6tB,MAAMvwB,GAAQ,CACtB0C,KAAKouB,YACL,MAEF,IAAIK,EAAWzuB,KAAK6tB,MAAMvwB,GAC1B0C,KAAK+uB,eACL/uB,KAAK0uB,cACL1uB,KAAKstB,OAAOqB,cAAcF,M,qCAS5B,IADAzuB,KAAKgvB,mBACGhvB,KAAKkuB,YAAY,CACvB,IAAMtB,EAAQ5sB,KAAKmuB,YACXjuB,EAAgB0sB,EAAhB1sB,KAAM5C,EAAUsvB,EAAVtvB,MACd,GAAa,UAAT4C,EAAkB,CACpBF,KAAKouB,YACL,MAGF,GAAc,MAAV9wB,EAAe,CACjB0C,KAAKouB,YACL,MASF,IAPApuB,KAAKivB,SAASrC,GAEd5sB,KAAKmuB,YAELnuB,KAAKquB,cAGEruB,KAAKsuB,mBACVtuB,KAAKmuB,YACLnuB,KAAKquB,cAIPruB,KAAKkvB,WAzBkB,IA0BfjB,EAAWrB,EAAXqB,OACFQ,EAAWzuB,KAAK8tB,MAAM5tB,GAC5BF,KAAKstB,OAAOqB,cAAZ,UAA6BF,EAA7B,YAAyCR,IAEzCjuB,KAAKmuB,e,wCASP,IADAnuB,KAAKmvB,oBACGnvB,KAAKkuB,YAAY,CACvB,IAAMtB,EAAQ5sB,KAAKmuB,YACXjuB,EAAgB0sB,EAAhB1sB,KAAM5C,EAAUsvB,EAAVtvB,MACd,GAAa,aAAT4C,EAAqB,CACvBF,KAAKouB,YACL,MAGF,GAAc,MAAV9wB,EAAe,CACjB0C,KAAKouB,YACL,MASF,IAPApuB,KAAKivB,SAASrC,GAEd5sB,KAAKmuB,YAELnuB,KAAKquB,cAGEruB,KAAKsuB,mBACVtuB,KAAKmuB,YACLnuB,KAAKquB,cAIPruB,KAAKkvB,WAzBkB,IA0BfjB,EAAWrB,EAAXqB,OACFQ,EAAWzuB,KAAK+tB,OAAO7tB,GAC7BF,KAAKstB,OAAOqB,cAAZ,UAA6BF,EAA7B,YAAyCnxB,EAAzC,YAAkD2wB,IAElDjuB,KAAKmuB,e,yCAQP,IAAKnuB,KAAKkuB,WAAY,CACpB,IAAMtB,EAAQ5sB,KAAKmuB,YACXb,EAAWttB,KAAXstB,OACAptB,EAAgB0sB,EAAhB1sB,KAAM5C,EAAUsvB,EAAVtvB,MAGd,OAAQ4C,GACN,IAAK,SAGH,OAFAF,KAAKovB,qBACL9B,EAAO+B,YAAP,UAAsB/xB,IAGxB,IAAK,SAGH,OAFA0C,KAAKovB,qBACL9B,EAAOgC,YAAP,UAAsBhyB,IAGxB,IAAK,UAGH,OAFA0C,KAAKovB,qBACL9B,EAAOiC,aAAajyB,GAKxB,OAAQ4C,GACN,IAAK,WACH,GAAc,MAAV5C,EAAe,CAIjB,IAHA0C,KAAKquB,cAGEruB,KAAKsuB,mBACVtuB,KAAKmuB,YACLnuB,KAAKquB,cAGPruB,KAAKmuB,YAEP,OAIJ,OAAQjuB,GACN,IAAK,QAMH,MAJc,MAAV5C,GACF0C,KAAKovB,qBAEPpvB,KAAKouB,YAGP,IAAK,WAMH,MAJc,MAAV9wB,GACF0C,KAAKovB,qBAEPpvB,KAAKouB,YAKT,OAAQluB,GACN,IAAK,WAEH,YADAF,KAAKouB,YAKT,MAAM,IAAI1Q,UAAJ,qBAA4Bxd,EAA5B,YAAoC5C,EAApC,W,KAQNkyB,G,WAMJ,WAAYC,GAAU,WACpBzvB,KAAKyvB,SAAWA,EAASpF,MAAM,QAC/BrqB,KAAK0vB,OAAS,G,0CAMT,WACCC,EAAW,YACXC,EAAS,UACTC,EAAc,SACdC,EAAc,SACdC,EAAc,SAoGpB,OAnGqB/vB,KAAbyvB,SACC7uB,SAAQ,SAAChE,GAChB,OAAQA,GACN,IAAK,YACH,EAAKozB,WACL,MAEF,IAAK,YACH,EAAKC,WACL,MAEF,IAAK,OACH,EAAKC,OACL,MAEF,IAAK,OACH,EAAKC,OACL,MAEF,IAAK,OACH,EAAKC,OACL,MAEF,IAAK,OACH,EAAKC,OACL,MAEF,IAAK,MACH,EAAKnmB,MACL,MAEF,IAAK,MACH,EAAKomB,MACL,MAEF,IAAK,MACH,EAAKC,MACL,MAEF,IAAK,MACH,EAAKC,MACL,MAEF,IAAK,MACH,EAAKC,MACL,MAEF,IAAK,QACH,EAAKC,QACL,MAEF,IAAK,MACH,EAAKC,MACL,MAEF,IAAK,OACH,EAAKC,OACL,MAEF,IAAK,MACH,EAAKC,MACL,MAEF,IAAK,SACH,EAAKC,SACL,MAEF,QACE,GAAInB,EAAShwB,KAAK/C,GAAO,CACvB,IACMsF,EADQtF,EAAKytB,MAAM,KACL,GACpB,EAAKrlB,MAAM9C,GACX,MAEF,GAAI0tB,EAAOjwB,KAAK/C,GAAO,CACrB,IAAMm0B,EAAQn0B,EAAKytB,MAAM,KACnBc,EAAO4F,EAAM,GACb7uB,EAAQ6uB,EAAM,GACpB,EAAKnB,OAAOzE,EAAMjpB,GAClB,MAEF,GAAI2tB,EAAYlwB,KAAK/C,GAAO,CAC1B,IAAMU,EAAQV,EAAKytB,MAAM,KAAK,GAC9B,EAAK2G,MAAM1zB,GACX,MAEF,GAAIwyB,EAAYnwB,KAAK/C,GAAO,CAC1B,IAAMU,EAAQV,EAAKytB,MAAM,KAAK,GAC9B,EAAK4G,MAAM3zB,GACX,MAEF,GAAIyyB,EAAYpwB,KAAK/C,GAAO,CAC1B,IAAMU,EAAQV,EAAKytB,MAAM,KAAK,GAC9B,EAAK6G,MAAM5zB,GACX,WAKD0C,KAAK0vB,OAAOrD,Q,4BAOf/uB,GACJ0C,KAAK0vB,OAAO7mB,KAAKvL,K,4BAObA,GACJA,EAAQ0E,WAAW1E,GACnB0C,KAAK0vB,OAAO7mB,KAAKvL,K,4BAObA,GACJ0C,KAAK0vB,OAAO7mB,KAAKvL,K,6BAOjB,IAAMoa,EAAI1X,KAAK0vB,OAAOrD,MAChB8E,EAAInxB,KAAK0vB,OAAOrD,MACtBrsB,KAAK0vB,OAAO7mB,KAAKsoB,EAAIzZ,K,6BAOrB,IAAMA,EAAI1X,KAAK0vB,OAAOrD,MAChB8E,EAAInxB,KAAK0vB,OAAOrD,MACtBrsB,KAAK0vB,OAAO7mB,KAAKsoB,EAAIzZ,K,6BAOrB,IAAMA,EAAI1X,KAAK0vB,OAAOrD,MAChB8E,EAAInxB,KAAK0vB,OAAOrD,MACtBrsB,KAAK0vB,OAAO7mB,KAAKsoB,IAAMzZ,K,6BAOvB,IAAMA,EAAI1X,KAAK0vB,OAAOrD,MAChB8E,EAAInxB,KAAK0vB,OAAOrD,MACtBrsB,KAAK0vB,OAAO7mB,KAAKsoB,IAAMzZ,K,iCAOvB,IAAMA,EAAI1X,KAAK0vB,OAAOrD,MAChB8E,EAAInxB,KAAK0vB,OAAOrD,MACtBrsB,KAAK0vB,OAAO7mB,KAAKsoB,GAAKzZ,K,iCAOtB,IAAMA,EAAI1X,KAAK0vB,OAAOrD,MAChB8E,EAAInxB,KAAK0vB,OAAOrD,MACtBrsB,KAAK0vB,OAAO7mB,KAAKsoB,GAAKzZ,K,4BAOtB,IAAMA,EAAI1X,KAAK0vB,OAAOrD,MAChB8E,EAAInxB,KAAK0vB,OAAOrD,MACtBrsB,KAAK0vB,OAAO7mB,KAAKsoB,EAAIzZ,K,4BAOrB,IAAMA,EAAI1X,KAAK0vB,OAAOrD,MAChB8E,EAAInxB,KAAK0vB,OAAOrD,MACtBrsB,KAAK0vB,OAAO7mB,KAAKsoB,EAAIzZ,K,4BAOrB,IAAMA,EAAI1X,KAAK0vB,OAAOrD,MAChB8E,EAAInxB,KAAK0vB,OAAOrD,MACtBrsB,KAAK0vB,OAAO7mB,KAAKsoB,EAAIzZ,K,4BAOrB,IAAMA,EAAI1X,KAAK0vB,OAAOrD,MAChB8E,EAAInxB,KAAK0vB,OAAOrD,MACtBrsB,KAAK0vB,OAAO7mB,KAAKsoB,EAAIzZ,K,4BAOrB,IAAMA,EAAI1X,KAAK0vB,OAAOrD,MAChB8E,EAAInxB,KAAK0vB,OAAOrD,MACtBrsB,KAAK0vB,OAAO7mB,KAAKsoB,EAAIzZ,K,6HA+BrB,IAAMA,EAAI1X,KAAK0vB,OAAOrD,MAChB8E,EAAInxB,KAAK0vB,OAAOrD,MACtBrsB,KAAK0vB,OAAO7mB,KAAZ,UAAoBsoB,GAApB,OAAwBzZ,M,8BAOxB,IAAMA,EAAI1X,KAAK0vB,OAAOrD,MAChB8E,EAAInxB,KAAK0vB,OAAOrD,MACtBrsB,KAAK0vB,OAAO7mB,KAAKvK,KAAK8yB,IAAID,EAAGzZ,M,4BAOzBxV,GAEJ,IADA,IAAM8C,EAAQ,GACL3I,EAAI,EAAGA,GAAK6F,EAAO7F,IAAK,CAC/B,IAAMoF,EAAOzB,KAAK0vB,OAAOrD,MACzBrnB,EAAM6D,KAAKpH,GAEbuD,EAAM4F,UACN5K,KAAK0vB,OAAO7mB,KAAK7D,K,6BAQZmmB,EAAMjpB,GAEX,IADA,IAAM8C,EAAQ,GACL3I,EAAI,EAAGA,GAAK6F,EAAO7F,IAAK,CAC/B,IAAMoF,EAAOzB,KAAK0vB,OAAOrD,MACzBrnB,EAAM6D,KAAKpH,GAEbuD,EAAM4F,UACN,IACMoC,EADUge,GAAUqG,YAAYlG,GACfmG,MAAMtxB,KAAMgF,GACnChF,KAAK0vB,OAAO7mB,KAAKmE,O,KAUfukB,GAAU,SAAC7F,GACXA,EAAMpU,WAAW,OACnBoU,EAAQA,EAAMjtB,UAAU,IAE1B,IAAM+yB,EAAY,IAAIhG,GAChB8B,EAAS,IAAIlC,GACbW,EAASyF,EAAUC,QAAQ/F,GAIjC,OAHiB,IAAI2B,GAAS,CAC5BC,SAAQvB,WAEM2F,WASZC,GAAW,SAACC,GAEhB,OADmB,IAAIpC,GAAWoC,GAChBC,Q,0QCjkDdC,G,WAMJ,aAEQ,6DAAJ,GAAI,IADNC,YACM,MADCryB,EAAWyF,MACZ,aACNnF,KAAK+xB,KAAOA,EACZ/xB,KAAK8U,QAAUpV,EAAWoG,IAC1B9F,KAAKyvB,SAAW/vB,EAAWoG,I,0DAOlB,IACHisB,EAAS/xB,KAAT+xB,KACAjd,EAAY9U,KAAZ8U,QACA2a,EAAazvB,KAAbyvB,SASN,OARK3a,IACE2a,IACHA,EAAW8B,GAAQQ,IAErBjd,EAAU6c,GAASlC,IAErBzvB,KAAK8U,QAAUA,EACf9U,KAAKyvB,SAAWA,EACT3a,I,gCAOC,IACFid,EAAS/xB,KAAT+xB,KACN,OAAQryB,EAAW6D,QAAQwuB,K,gCAQ3B,OAAO/xB,KAAK+xB,O,8BAONA,GACN/xB,KAAK+xB,KAAOA,EACZ/xB,KAAK8U,QAAUpV,EAAWoG,IAC1B9F,KAAKyvB,SAAW/vB,EAAWoG,M,8BAQ3B,OAAO,IAAIgsB,EAAQ,CACjBC,KAAM/xB,KAAK+xB,Y,4SC5DXC,G,WAkBJ,aAcQ,6DAAJ,GAAI,IAbN5rB,aAaM,MAbE1G,EAAWqG,MAab,MAZNqjB,cAYM,MAZG,UAYH,MAXN5D,aAWM,MAXE,GAWF,MAVNyM,gBAUM,MAVK,GAUL,MATNtK,cASM,MATG,GASH,MARNuK,kBAQM,MARO,GAQP,MAPNC,eAOM,MAPI,GAOJ,MANNC,gBAMM,MANK,GAML,MALNC,kBAKM,MALO3yB,EAAWqG,MAKlB,MAJN+C,YAIM,MAJCpJ,EAAWyF,MAIZ,MAHNmtB,oBAGM,MAHS,EAGT,MAFNC,qBAEM,MAFU,EAEV,MADNC,mBACM,MADQR,EAAKS,KAAKC,OAClB,aAEN1yB,KAAKqyB,WAAaA,EAElBryB,KAAKwlB,MAAQb,GAAMgO,aAAanN,GAEhCxlB,KAAK2nB,OAASA,EAEd3nB,KAAKoG,MAAQA,EAEbpG,KAAKopB,OAASA,EAEdppB,KAAKmyB,QAAU,IAAIL,GAAQK,GAE3BnyB,KAAK8I,KAAOA,EAEZ9I,KAAKoyB,SAAW,IAAI5H,GAAU4H,GAE9BpyB,KAAK4yB,WAAalzB,EAAWyF,MAE7BnF,KAAKuyB,cAAgBA,EAErBvyB,KAAKsyB,aAAeA,EAEpBtyB,KAAKiyB,SAAW,IAAI9W,GAAS8W,GAE7BjyB,KAAKkyB,WAAa,IAAIjP,GAAWiP,GAEjClyB,KAAK6yB,eAAeL,G,wDAObhN,GAEP,OADAxlB,KAAKwlB,MAAQA,EACNxlB,O,8BAOD8I,GAMN,OALA9I,KAAK4yB,WAAa,KAClB5yB,KAAK8I,KAAOA,EACZ9I,KAAKmyB,QAAQW,QAAQ,MACrB9yB,KAAKoyB,SAASW,QAAQ,IACtB/yB,KAAKgzB,gBAAgB,GACdhzB,O,kCAMGyqB,GAMV,OALAzqB,KAAK4yB,WAAa,KAClB5yB,KAAK8I,KAAO,KACZ9I,KAAKmyB,QAAQW,QAAQ,MACrB9yB,KAAKoyB,SAASW,QAAQtI,GACtBzqB,KAAKgzB,gBAAgB,GACdhzB,O,8BAMD+xB,GAMN,OALA/xB,KAAK4yB,WAAa,KAClB5yB,KAAK8I,KAAO,KACZ9I,KAAKmyB,QAAQW,QAAQf,GACrB/xB,KAAKoyB,SAASW,QAAQ,IACtB/yB,KAAKgzB,gBAAgB,GACdhzB,O,gCAOP,OAAOA,KAAKmyB,QAAQc,Y,kCAOQ,IAApB7J,EAAoB,uDAAX,UAIjB,OAHAppB,KAAKopB,OAASA,EACdppB,KAAK4yB,WAAa,KAClB5yB,KAAKgzB,gBAAgB,GACdhzB,O,+BAOAoG,GAEP,OADApG,KAAKoG,MAAQA,EACNpG,O,uCAO+B,IAAzBE,EAAyB,uDAAlB8xB,EAAKS,KAAKC,OACtB5pB,EAAS9I,KAAT8I,KACR,OAAQ5I,GACN,KAAK8xB,EAAKS,KAAKC,OACb1yB,KAAKwyB,YAAcR,EAAKS,KAAKC,OAC7B,MAEF,KAAKV,EAAKS,KAAKS,OACblzB,KAAKwyB,YAActyB,EACfR,EAAWqC,SAAS+G,IACtB9I,KAAKwyB,YAAcR,EAAKS,KAAKS,OAC7BlzB,KAAK8I,KAAOpJ,EAAWsC,WAAW8G,KAElC9I,KAAKwyB,YAAcR,EAAKS,KAAKC,OAC7B1yB,KAAK8I,KAAL,UAAeA,IAEjB,MAEF,KAAKkpB,EAAKS,KAAKU,UACb,IAAM7xB,EAAQsmB,GAAUtmB,MAAMwH,GAC1BpJ,EAAW0zB,OAAO9xB,IACpBtB,KAAKwyB,YAAcR,EAAKS,KAAKU,UAC7BnzB,KAAK8I,KAAOpJ,EAAWsC,WAAW8G,KAElC9I,KAAKwyB,YAAcR,EAAKS,KAAKC,OAC7B1yB,KAAK8I,KAAL,UAAeA,IAEjB,MAEF,KAAKkpB,EAAKS,KAAKY,UACbrzB,KAAKwyB,YAAcR,EAAKS,KAAKY,UAIjC,OAAOrzB,O,gCAQP,OAAON,EAAW6D,QAAQvD,KAAKszB,oB,mCAO/B,OAAOtzB,KAAKmyB,QAAQoB,Y,sCAON,IACRzqB,EAA0B9I,KAA1B8I,KAAMqpB,EAAoBnyB,KAApBmyB,QAAS/I,EAAWppB,KAAXopB,OACfwJ,EAAe5yB,KAAf4yB,WACAJ,EAAgBxyB,KAAhBwyB,YAEN,GAAIL,EAAQoB,UAAW,CACrB,IAAIj2B,EAAQ60B,EAAQqB,WAOpB,OANIl2B,GACEoC,EAAW6D,QAAQqvB,KACrBA,EAAaa,GAAarK,EAAQ9rB,IAGtC0C,KAAK4yB,WAAaA,EACXA,EAGT,OAAQJ,GACN,KAAKR,EAAKS,KAAKC,OACf,KAAKV,EAAKS,KAAKS,OACf,KAAKlB,EAAKS,KAAKU,UACb,OAAI/J,GACE1pB,EAAW6D,QAAQqvB,IACrB5yB,KAAK4yB,WAAaa,GAAarK,EAAQtgB,GAChC9I,KAAK4yB,YAGTA,EAIX,OAAOlzB,EAAWyF,Q,uCAOH,IACT2D,EAAkB9I,KAAlB8I,KAAMqpB,EAAYnyB,KAAZmyB,QACNC,EAAapyB,KAAboyB,SACAI,EAAgBxyB,KAAhBwyB,YAEN,GAAIL,EAAQoB,UACV,OAAOpB,EAAQqB,WAGjB,OAAQhB,GACN,KAAKR,EAAKS,KAAKC,OACf,KAAKV,EAAKS,KAAKS,OACf,KAAKlB,EAAKS,KAAKU,UACb,OAAOrqB,EAET,KAAKkpB,EAAKS,KAAKY,UACb,OAAOjB,EAIX,OAAO1yB,EAAWyF,Q,kCAORkB,GAEV,OADArG,KAAKiyB,SAAW5rB,EACTrG,O,oCAOKqG,GAEZ,OADArG,KAAKkyB,WAAa7rB,EACXrG,O,8BAOD,IACEqyB,EAAqCryB,KAArCqyB,WAAYvpB,EAAyB9I,KAAzB8I,KAAMsgB,EAAmBppB,KAAnBopB,OAAQzB,EAAW3nB,KAAX2nB,OAC1BnC,EAAgCxlB,KAAhCwlB,MAAOgN,EAAyBxyB,KAAzBwyB,YAAaL,EAAYnyB,KAAZmyB,QACpBC,EAAmCpyB,KAAnCoyB,SACR,OAAO,IAAIJ,EAAK,CACdK,aACAvpB,OACA6e,SACA6K,cACApJ,SACA6I,SAPyCjyB,KAAzBiyB,SAQhBC,WARyClyB,KAAfkyB,WAS1B1M,QACA2M,UACAC,e,+BAOK,IACCC,EAAqCryB,KAArCqyB,WAAYvpB,EAAyB9I,KAAzB8I,KAAMsgB,EAAmBppB,KAAnBopB,OAAQzB,EAAW3nB,KAAX2nB,OAC1BnC,EAAgCxlB,KAAhCwlB,MAAOgN,EAAyBxyB,KAAzBwyB,YAAaL,EAAYnyB,KAAZmyB,QACpBC,EAAmCpyB,KAAnCoyB,SAAUH,EAAyBjyB,KAAzBiyB,SAAUC,EAAelyB,KAAfkyB,WAC5B,MAAO,CACLvK,SACAoK,KAAMI,EAAQc,UACdxI,KAAM2H,EAASsB,UACflB,cACA1pB,OACA0c,QACA6M,aACAjJ,SACA6I,WACAC,gB,iCASF,OAAOlyB,KAAK2zB,kB,sCAOElwB,GAEd,OADAzD,KAAKsyB,aAAe7uB,EACbzD,O,uCAOQ2D,GAEf,OADA3D,KAAKuyB,cAAgB5uB,EACd3D,U,yMAQXgyB,GAAKS,KAAO,CAEVS,OAAQ,EAERR,OAAQ,EAERW,UAAW,EAEXF,UAAW,G,IC7WPS,G,WAEJ,WAAYpf,GACV,G,4FADmB,SACfA,EAAS,KACHqf,EAASrf,EAATqf,KACR7zB,KAAK6zB,KAAOn0B,EAAWo0B,UAAUD,EAAMrf,QAEvCxU,KAAK6zB,UAAO7tB,E,yDAIN,IACA6tB,EAAS7zB,KAAT6zB,KACR,OAAIA,aAAgB7B,GACX6B,GAELn0B,EAAWuF,SAAS4uB,GACtB7zB,KAAK6zB,KAAO,IAAI7B,GAAK,CACnBlpB,KAAM+qB,IAGR7zB,KAAK6zB,KAAO,IAAI7B,GAAK6B,GAEhB7zB,KAAK6zB,Q,8BAGNA,GAEN,OADA7zB,KAAK6zB,KAAOA,EACL7zB,O,8BAIP,OAAO,IAAI4zB,EAAe,CACxBG,QAAS/zB,KAAK+zB,QACdF,KAAM7zB,KAAK6zB,Y,6MCrCXG,G,WAEJ,c,4FAAc,SACZh0B,KAAKgR,KAAO,G,uDAGN,WACNjU,OAAO+D,MAAK,SAAClD,UACJ,EAAKoT,KAAKpT,Q,mCAIRA,UACJoC,KAAKgR,KAAKpT,K,qCAGJA,EAAKpB,GAClBwD,KAAKgR,KAAKpT,GAAOpB,I,8BAGXoB,GACN,GAAIoC,KAAKgR,KAAKpT,GAAM,8BADN0O,EACM,iCADNA,EACM,mBAClB,EAAAtM,KAAKgR,MAAKpT,GAAV,QAAkB0O,S,6MCjBlB2nB,G,WAKJ,c,4FAAc,SAEZj0B,KAAKk0B,UAAY,GAEjBl0B,KAAKm0B,UAAY,GAEjBn0B,KAAKo0B,MAAQ,CACXphB,MAAO,GACPa,KAAM,IAGR7T,KAAKsxB,OAAQ,EAEbtxB,KAAKq0B,OAAS,IAAIL,G,yDAQlB,OAAOh0B,KAAKm0B,UAAUh0B,OAAS,I,gCAQ/B,OAAOH,KAAKk0B,UAAU/zB,OAAS,I,6BAQ/B,IADA,IAAMi0B,EAAQp0B,KAAKk0B,UAAU7H,MACpBhwB,EAAI+3B,EAAMvgB,KAAK1T,OAAS,EAAG9D,GAAK,EAAGA,IAC3B+3B,EAAMvgB,KAAKxX,GACnBi4B,OAETt0B,KAAKm0B,UAAUtrB,KAAKurB,GACpBp0B,KAAKq0B,OAAOE,QAAQ,SAAUH,EAAMphB,MAAO,U,6BAQ3C,IADA,IAAMohB,EAAQp0B,KAAKm0B,UAAU9H,MACpBhwB,EAAI,EAAGmF,EAAM4yB,EAAMvgB,KAAK1T,OAAQ9D,EAAImF,EAAKnF,IACjC+3B,EAAMvgB,KAAKxX,GACnBm4B,OAETx0B,KAAKk0B,UAAUrrB,KAAKurB,GACpBp0B,KAAKq0B,OAAOE,QAAQ,SAAUH,EAAMphB,MAAO,U,6BAO3ChT,KAAKo0B,MAAQ,CACXphB,MAAO,GACPa,KAAM,IAER7T,KAAKsxB,OAAQ,I,4BAMTte,GACAhT,KAAKo0B,MAAMvgB,KAAK1T,SAClBH,KAAKo0B,MAAMphB,MAAQA,EACnBhT,KAAKm0B,UAAY,GACjBn0B,KAAKk0B,UAAUrrB,KAAK7I,KAAKo0B,QAE3Bp0B,KAAKo0B,MAAQ,CACXphB,MAAO,GACPa,KAAM,IAER7T,KAAKsxB,OAAQ,EACbtxB,KAAKq0B,OAAOE,QAAQ,SAAUvhB,EAAO,W,kCAUpC,IAHOyhB,EAGP,uDAHgB,CACjBH,KAAM,aACNE,KAAM,cAEFx0B,KAAKsxB,OACPtxB,KAAKo0B,MAAMvgB,KAAKhL,KAAK4rB,Q,4SCtGrBC,G,WAEJ,aAGQ,6DAAJ,GAAI,IAFNC,gBAEM,MAFK,IAAIV,GAET,MADNW,aACM,MADE,GACF,aACN50B,KAAK40B,MAAQA,EACb50B,KAAK20B,SAAWA,E,wDAGTE,EAAIC,GACX,IAAMtqB,EAAOxK,KAAK9C,IAAI23B,EAAIC,GAC1B,GAAItqB,EACF,OAAOA,EAET,IAAM/I,EAAO,IAAImyB,GAEjB,OADA5zB,KAAK+0B,IAAIF,EAAIC,EAAIrzB,GACVA,I,iCAIP,OAAOzB,KAAK40B,Q,4BAGRI,EAAKC,EAAKC,EAAKC,GAEnB,OADan1B,KAAK40B,MAAM/uB,MAAMmvB,EAAKE,EAAM,GAC7B1sB,KAAI,SAACqY,GACf,OAAIA,EACKA,EAAIhb,MAAMovB,EAAKE,EAAM,GAEvBtU,O,0BAIPgU,EAAIC,GACN,IAAMM,EAAOp1B,KAAK40B,MAAMC,GACxB,OAAOO,GAAQA,EAAKN,GAChB90B,KAAKq1B,KAAKD,EAAMN,QAChB9uB,I,0BAGF6uB,EAAIC,EAAIrzB,GACV,IAAM2zB,EAAOp1B,KAAK40B,MAAMC,IAAO,GAC/BO,EAAKN,GAAMrzB,EACXzB,KAAK40B,MAAMC,GAAMO,I,2BAGdA,EAAMN,GACT,IAAIrzB,EAAO2zB,EAAKN,GAChB,OAAIrzB,GACFA,EAAOA,aAAgBmyB,GACnBnyB,EAAO,IAAImyB,GAAenyB,GAC9B2zB,EAAKN,GAAMrzB,EACJA,GAEFA,I,2BAGJwP,GAGH,IAHa,IACL2jB,EAAU50B,KAAV40B,MACAz0B,EAAWy0B,EAAXz0B,OACC9D,EAAI,EAAGA,EAAI8D,EAAQ9D,IAAK,CAC/B,IAAIoF,EAAOmzB,EAAMv4B,GACjB,GAAIoF,EAEF,IAFQ,IACAtB,EAAWsB,EAAXtB,OACC2pB,EAAI,EAAGA,EAAI3pB,EAAQ2pB,IAE1B7Y,EADWjR,KAAK9C,IAAIb,EAAGytB,O,4BAOzBwL,GAEE,6DAAJ,GAAI,IADNC,oBACM,SACAP,EAAaM,EAAbN,IAAKE,EAAQI,EAARJ,IACLD,EAAaK,EAAbL,IAAKE,EAAQG,EAARH,IACLP,EAAU50B,KAAV40B,MACAD,EAAa30B,KAAb20B,SACAx0B,EAAWy0B,EAAXz0B,OACFq1B,EAAW,GACXC,EAAcP,EAAMF,EAAM,EAC1BU,EAAcP,EAAMF,EAAM,EAC1BR,EAAS,CACXH,KAAM,WACJ,IAAK,IAAIO,EAAKG,EAAKH,GAAMK,KACnBL,GAAM10B,GADkB00B,IAAM,CAIlC,IAAIc,EAAaH,EAASX,GACtBe,EAAUhB,EAAMC,GACpB,GAAIe,EACF,IAAK,IAAId,EAAKG,EAAKH,GAAMK,KACnBL,GAAM30B,GADkB20B,IAI5B,GAAIS,EAAc,CAGhB,GAFcV,IAAOG,GACPF,IAAOG,EAEnB,SAEFW,EAAQd,GAAMa,EAAWb,QAEzBc,EAAQd,GAAMa,EAAWb,KAMnCN,KAAM,WACJgB,EAAW,IAAIz2B,MAAM02B,GACrB,IAAK,IAAIZ,EAAKG,EAAKH,GAAMK,KACnBL,GAAM10B,GADkB00B,IAAM,CAIlC,IAAIe,EAAUhB,EAAMC,GACpB,GAAIe,EAAS,CAGX,IAFA,IAAID,EAAa,IAAI52B,MAAM22B,GACrBv1B,EAAWy1B,EAAXz1B,OACG20B,EAAKG,EAAKH,GAAMK,KACnBL,GAAM30B,GADkB20B,IAI5B,GAAIS,EAAc,CAGhB,GAFcV,IAAOG,GACPF,IAAOG,EAEnB,SAEFU,EAAWb,GAAMc,EAAQd,GACzBc,EAAQd,QAAM9uB,OAEd2vB,EAAWb,GAAMc,EAAQd,GACzBc,EAAQd,QAAM9uB,EAGlBwvB,EAASX,GAAMc,MAKvBhB,EAASkB,UAAUpB,GACnBA,EAAOD,S,+BAGAK,EAAIC,EAAIrzB,GACf,IAAM2zB,EAAOp1B,KAAK40B,MAAMC,GACpBO,IACFA,EAAKN,GAAMrzB,K,gCAILozB,GAAI,IAERiB,EAFQ,OAGRrB,EAAS,CACXH,KAAM,WACAwB,GACF,EAAKlB,MAAMmB,OAAOlB,EAAI,EAAGiB,IAG7BtB,KAAM,WACJsB,EAAa,EAAKlB,MAAMmB,OAAOlB,EAAI,GAAG,KATvB70B,KAAb20B,SAYGkB,UAAUpB,GACnBA,EAAOD,S,gCAGCM,GAAI,WACNH,EAAa30B,KAAb20B,SACFmB,EAAa,GACbrB,EAAS,CACXH,KAAM,WAEJ,IAFU,IACJn0B,EAAW21B,EAAX31B,OACG9D,EAAI,EAAGA,EAAI8D,EAAQ9D,IAAK,CAC/B,IAAMiB,EAAQw4B,EAAWz5B,GACjBw4B,EAAav3B,EAAbu3B,GAAIpzB,EAASnE,EAATmE,KACK,EAAKmzB,MAAMC,GACnBkB,OAAOjB,EAAI,EAAGrzB,KAG3B+yB,KAAM,WAAM,IACJr0B,EAAW,EAAKy0B,MAAhBz0B,OACN21B,EAAa,GACb,IAAK,IAAIjB,EAAK,EAAGA,EAAK10B,EAAQ00B,IAAM,CAClC,IAAMmB,EAAW,EAAKpB,MAAMC,GAC5B,GAAImB,EAAU,CACZ,IAAMv0B,EAAOu0B,EAASD,OAAOjB,EAAI,GAAG,GACpCgB,EAAWjtB,KAAK,CACdgsB,KAAIpzB,aAMdkzB,EAASkB,UAAUpB,GACnBA,EAAOD,S,qCAGMK,GAAI,WAEbJ,EAAS,CACXH,KAAM,WACJ,EAAKM,MAAMmB,OAAOlB,EAAK,EAAG,IAE5BL,KAAM,WACJ,IAAMwB,EAAW,EAAKpB,MAAMC,GAC5B,GAAImB,EAAU,CAEZ,IADA,IAAMC,EAAc,GACX55B,EAAI,EAAGmF,EAAMw0B,EAAS71B,OAAQ9D,EAAImF,EAAKnF,IAAK,CACnD,IAAMoF,EAAOu0B,EAAS35B,GACtB,GAAIoF,EAAM,KACAsyB,EAAYtyB,EAAZsyB,QACRkC,EAAY55B,GAAK,CAAE03B,YAGvB,EAAKa,MAAMmB,OAAOlB,EAAK,EAAG,EAAGoB,QAE7B,EAAKrB,MAAMmB,OAAOlB,EAAK,EAAG,EAAG,MAlBhB70B,KAAb20B,SAsBGkB,UAAUpB,GACnBA,EAAOD,S,qCAGMM,GAAI,WAEbL,EAAS,CACXH,KAAM,WACJ,IAAK,IAAIj4B,EAAI,EAAGmF,EAAM,EAAKozB,MAAMz0B,OAAQ9D,EAAImF,EAAKnF,IAAK,CACrD,IAAM25B,EAAW,EAAKpB,MAAMv4B,GACxB25B,GACFA,EAASD,OAAOjB,EAAK,EAAG,KAI9BN,KAAM,WACJ,IAAK,IAAIn4B,EAAI,EAAGmF,EAAM,EAAKozB,MAAMz0B,OAAQ9D,EAAImF,EAAKnF,IAAK,CACrD,IAAM25B,EAAW,EAAKpB,MAAMv4B,GAC5B,GAAI25B,EAAU,CACZ,IAAMv0B,EAAOu0B,EAASlB,GACtB,GAAIrzB,EAAM,KACAsyB,EAAYtyB,EAAZsyB,QACRiC,EAASD,OAAOjB,EAAK,EAAG,EAAG,CAAEf,iBAE7BiC,EAASD,OAAOjB,EAAK,EAAG,EAAG,QAnBlB90B,KAAb20B,SAyBGkB,UAAUpB,GACnBA,EAAOD,S,sCAGOK,GAAI,WAEdJ,EAAS,CACXH,KAAM,WACJ,EAAKM,MAAMmB,OAAOlB,EAAI,IAExBL,KAAM,WACJ,IAAMwB,EAAW,EAAKpB,MAAMC,GAC5B,GAAImB,EAAU,CAEZ,IADA,IAAMC,EAAc,GACX55B,EAAI,EAAGmF,EAAMw0B,EAAS71B,OAAQ9D,EAAImF,EAAKnF,IAAK,CACnD,IAAMoF,EAAOu0B,EAAS35B,GACtB,GAAIoF,EAAM,KACAsyB,EAAYtyB,EAAZsyB,QACRkC,EAAY55B,GAAK,CAAE03B,YAGvB,EAAKa,MAAMmB,OAAOlB,EAAI,EAAGoB,QAEzB,EAAKrB,MAAMmB,OAAOlB,EAAI,EAAG,MAlBZ70B,KAAb20B,SAsBGkB,UAAUpB,GACnBA,EAAOD,S,sCAGOM,GAAI,WAEdL,EAAS,CACXH,KAAM,WACJ,IAAK,IAAIj4B,EAAI,EAAGmF,EAAM,EAAKozB,MAAMz0B,OAAQ9D,EAAImF,EAAKnF,IAAK,CACrD,IAAM25B,EAAW,EAAKpB,MAAMv4B,GACxB25B,GACFA,EAASD,OAAOjB,EAAI,KAI1BN,KAAM,WACJ,IAAK,IAAIn4B,EAAI,EAAGmF,EAAM,EAAKozB,MAAMz0B,OAAQ9D,EAAImF,EAAKnF,IAAK,CACrD,IAAM25B,EAAW,EAAKpB,MAAMv4B,GAC5B,GAAI25B,EAAU,CACZ,IAAMv0B,EAAOu0B,EAASlB,GACtB,GAAIrzB,EAAM,KACAsyB,EAAYtyB,EAAZsyB,QACRiC,EAASD,OAAOjB,EAAI,EAAG,CAAEf,iBAEzBiC,EAASD,OAAOjB,EAAI,EAAG,QAnBd90B,KAAb20B,SAyBGkB,UAAUpB,GACnBA,EAAOD,Y,kCCxTXpjB,iBAAiB,WAAW,SAAC4B,GAAU,IAC7Ba,EAASb,EAATa,KACF+gB,EAAQ,IAAIF,GAAgB,CAChCE,MAAO/gB,IAELjS,EAAQ,EACRqsB,EAAS,EACb2G,EAAMjK,MAAK,SAAAlpB,GACT,GAAIA,EAAM,CACR,IAAMoyB,EAAOpyB,EAAKy0B,UAClB,GAAIrC,EAAKsC,aAAc,CACrB,IAAM74B,EAAQu2B,EAAKP,iBACf5zB,EAAWqC,SAASzE,KACtBsE,GAASlC,EAAWsC,WAAW1E,GAC/B2wB,UAGF,OAAQ4F,EAAKrB,aACX,KAAKR,GAAKS,KAAKS,OACbtxB,GAASiyB,EAAKP,iBACdrF,SAMVmI,YAAY,CACVx0B,QAAOqsB","file":"js/sumtotal.worker.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","/* global navigator document window self */\nfunction S4() {\n  // eslint-disable-next-line no-bitwise\n  return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);\n}\n\nconst alphabets = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];\n\nconst DATA_TYPE = {\n  String: 1,\n  Boolean: 2,\n  Number: 3,\n  Object: 4,\n  Array: 5,\n  Function: 6,\n  Null: 7,\n  Undefined: 8,\n  Promise: 9,\n  GeneratorFunction: 10,\n  AsyncFunction: 11,\n  BigInt: 12,\n  Symbol: 13,\n  DedicatedWorkerGlobalScope: 14,\n  Date: 15,\n  Un: 0,\n};\n\nclass SheetUtils {\n\n  static isWindows() {\n    return /windows|win32/i.test(navigator.userAgent);\n  }\n\n  static isMac() {\n    return /macintosh|mac os x/i.test(navigator.userAgent);\n  }\n\n  static isNotEmptyObject(object) {\n    return !SheetUtils.isEmptyObject(object);\n  }\n\n  static isEmptyObject(object) {\n    // eslint-disable-next-line no-restricted-syntax\n    for (const key in object) {\n      // eslint-disable-next-line no-prototype-builtins\n      if (object.hasOwnProperty(key)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  static isUnDef(e) {\n    return e === undefined || e === null;\n  }\n\n  static isDef(e) {\n    return !this.isUnDef(e);\n  }\n\n  static isNumber(e) {\n    return /^(-?\\d+.\\d+)$|^(-?\\d+)$/.test(e);\n  }\n\n  static isFraction(e) {\n    return /^\\d+\\/\\d+$/.test(e);\n  }\n\n  static isDate(e) {\n    return SheetUtils.type(e) === DATA_TYPE.Date;\n  }\n\n  static isFunction(e) {\n    const type = SheetUtils.type(e);\n    return type === DATA_TYPE.Function;\n  }\n\n  static isArray(e) {\n    return SheetUtils.type(e) === DATA_TYPE.Array;\n  }\n\n  static isLikeArray(e) {\n    if (SheetUtils.isUnDef(e)) {\n      return false;\n    }\n    return typeof e.length === 'number';\n  }\n\n  static isBlank(s) {\n    if (SheetUtils.isUnDef(s)) {\n      return true;\n    }\n    return s.toString().trim() === '';\n  }\n\n  static isPlainObject(obj) {\n    if (SheetUtils.isUnDef(obj)) {\n      return false;\n    }\n    return Object.getPrototypeOf(obj) === Object.getPrototypeOf({});\n  }\n\n  static isString(obj) {\n    return SheetUtils.type(obj) === DATA_TYPE.String;\n  }\n\n  static isChildType(obj, parent) {\n    return obj instanceof parent;\n  }\n\n  static toLowCase(str) {\n    return str.toLowerCase();\n  }\n\n  static type(arg) {\n    const type = Object.prototype.toString.call(arg);\n    switch (type) {\n      case '[object Null]':\n        return DATA_TYPE.Null;\n      case '[object Object]':\n        return DATA_TYPE.Object;\n      case '[object Undefined]':\n        return DATA_TYPE.Undefined;\n      case '[object String]':\n        return DATA_TYPE.String;\n      case '[object Boolean]':\n        return DATA_TYPE.Boolean;\n      case '[object Number]':\n        return DATA_TYPE.Number;\n      case '[object Function]':\n        return DATA_TYPE.Function;\n      case '[object Array]':\n        return DATA_TYPE.Array;\n      case '[object Promise]':\n        return DATA_TYPE.Promise;\n      case '[object GeneratorFunction]':\n        return DATA_TYPE.GeneratorFunction;\n      case '[object AsyncFunction]':\n        return DATA_TYPE.AsyncFunction;\n      case '[object BigInt]':\n        return DATA_TYPE.BigInt;\n      case '[object Symbol]':\n        return DATA_TYPE.Symbol;\n      case '[object Date]':\n        return DATA_TYPE.Date;\n      case '[object DedicatedWorkerGlobalScope]':\n        return DATA_TYPE.DedicatedWorkerGlobalScope;\n      default:\n        return DATA_TYPE.Un;\n    }\n  }\n\n  static copy(object = {}, ...sources) {\n    if (SheetUtils.isUnDef(object)) {\n      return {};\n    }\n    if (SheetUtils.isUnDef(sources) || sources.length === 0) {\n      return object;\n    }\n    sources.forEach((source) => {\n      if (SheetUtils.isUnDef(source)) return;\n      Object.keys(source).forEach((key) => {\n        const v = source[key];\n        if (typeof v === 'string' || typeof v === 'number' || typeof v === 'boolean') {\n          object[key] = v;\n        } else if (typeof v !== 'function' && !Array.isArray(v) && SheetUtils.isPlainObject(v)) {\n          object[key] = object[key] || {};\n          SheetUtils.copy(object[key], v);\n        } else {\n          object[key] = v;\n        }\n      });\n    });\n    return object;\n  }\n\n  static cloneDeep(object) {\n    const json = JSON.stringify(object);\n    return JSON.parse(json);\n  }\n\n  static extends(target, ...src) {\n    for (let i = 0, len = src.length; i < len; i++) {\n      const item = src[i];\n      for (let key in item) {\n        if (item.hasOwnProperty(key)) {\n          const value = item[key];\n          if (value) {\n            target[key] = value;\n          }\n        }\n      }\n    }\n    return target;\n  }\n\n  static sum(objOrAry, cb = value => value) {\n    let total = 0;\n    let size = 0;\n    Object.keys(objOrAry).forEach((key) => {\n      total += cb(objOrAry[key], key);\n      size += 1;\n    });\n    return [total, size];\n  }\n\n  static parseFloat(val) {\n    if (SheetUtils.isNumber(val)) return parseFloat(val);\n    return 0;\n  }\n\n  static parseInt(val) {\n    if (SheetUtils.isNumber(val)) return parseInt(val, 10);\n    return 0;\n  }\n\n  static stringAt(index) {\n    let str = '';\n    let idx = index;\n    while (idx >= alphabets.length) {\n      idx /= alphabets.length;\n      idx -= 1;\n      str += alphabets[parseInt(idx, 10) % alphabets.length];\n    }\n    const last = index % alphabets.length;\n    str += alphabets[last];\n    return str;\n  }\n\n  static indexAt(str) {\n    let ret = 0;\n    for (let i = 0; i < str.length - 1; i += 1) {\n      const idx = str.charCodeAt(i) - 65;\n      const expoNet = str.length - 1 - i;\n      ret += (alphabets.length ** expoNet) + (alphabets.length * idx);\n    }\n    ret += str.charCodeAt(str.length - 1) - 65;\n    return ret;\n  }\n\n  static expr2xy(src) {\n    let x = '';\n    let y = '';\n    for (let i = 0; i < src.length; i += 1) {\n      if (src.charAt(i) >= '0' && src.charAt(i) <= '9') {\n        y += src.charAt(i);\n      } else {\n        x += src.charAt(i);\n      }\n    }\n    return [SheetUtils.indexAt(x), parseInt(y, 10) - 1];\n  }\n\n  static xy2expr(x, y) {\n    return `${SheetUtils.stringAt(x)}${y + 1}`;\n  }\n\n  static expr2expr(src, xn, yn) {\n    const [x, y] = SheetUtils.expr2xy(src);\n    return SheetUtils.xy2expr(x + xn, y + yn);\n  }\n\n  static minIf(v, min) {\n    if (v < min) return min;\n    return v;\n  }\n\n  static keepLastIndex(obj) {\n    const range = window.getSelection();\n    range.selectAllChildren(obj);\n    range.collapseToEnd();\n  }\n\n  static trim(s) {\n    if (this.isBlank(s)) return '';\n    return s.trim();\n  }\n\n  static now() {\n    return Date.now().toString();\n  }\n\n  static viewPort() {\n    return {\n      width: window.innerWidth,\n      height: window.innerHeight,\n    };\n  }\n\n  static exitFullscreen() {\n    if (document.exitFullscreen) {\n      document.exitFullscreen();\n    } else if (document.msExitFullscreen) {\n      document.msExitFullscreen();\n    } else if (document.mozCancelFullScreen) {\n      document.mozCancelFullScreen();\n    } else if (document.webkitExitFullscreen) {\n      document.webkitExitFullscreen();\n    }\n  }\n\n  static fullScreen(element) {\n    if (element.el) {\n      element = element.el;\n    }\n    if (element.requestFullscreen) {\n      element.requestFullscreen();\n    } else if (element.msRequestFullscreen) {\n      element.msRequestFullscreen();\n    } else if (element.mozRequestFullScreen) {\n      element.mozRequestFullScreen();\n    } else if (element.webkitRequestFullscreen) {\n      element.webkitRequestFullscreen();\n    }\n  }\n\n  static isFull() {\n    return !!(document.webkitIsFullScreen || document.mozFullScreen\n      || document.msFullscreenElement || document.fullscreenElement);\n  }\n\n  static uuid() {\n    return (`${S4() + S4()}${S4()}${S4()}${S4()}${S4()}${S4()}${S4()}`);\n  }\n\n  static getExplorerInfo() {\n    const explorer = window.navigator.userAgent.toLowerCase();\n    // firefox\n    if (explorer.indexOf('firefox') >= 0) {\n      const ver = explorer.match(/firefox\\/([\\d.]+)/)[1];\n      return { type: 'Firefox', version: ver };\n    }\n    // Chrome\n    if (explorer.indexOf('chrome') >= 0) {\n      const ver = explorer.match(/chrome\\/([\\d.]+)/)[1];\n      return { type: 'Chrome', version: ver };\n    }\n    // Opera\n    if (explorer.indexOf('opera') >= 0) {\n      const ver = explorer.match(/opera.([\\d.]+)/)[1];\n      return { type: 'Opera', version: ver };\n    }\n    // Safari\n    if (explorer.indexOf('safari') >= 0) {\n      const ver = explorer.match(/version\\/([\\d.]+)/)[1];\n      return { type: 'Safari', version: ver };\n    }\n    // ie\n    if (explorer.indexOf('msie') >= 0) {\n      const ver = explorer.match(/msie ([\\d.]+)/)[1];\n      return { type: 'IE', version: ver };\n    }\n    // undefined\n    return undefined;\n  }\n\n  static arrayLast(array) {\n    return array[array.length - 1];\n  }\n\n  static arrayHead(array) {\n    return array[0];\n  }\n\n  static blankClear(value) {\n    if (SheetUtils.isString(value)) {\n      return value.replace(/\\s*/g, SheetUtils.EMPTY);\n    }\n    return value;\n  }\n\n  static equals(src, target) {\n    if (SheetUtils.isUnDef(src)) {\n      return false;\n    }\n    if (SheetUtils.isUnDef(target)) {\n      return false;\n    }\n    return JSON.stringify(src) === JSON.stringify(target);\n  }\n\n  static toFixed(num, fixed) {\n    if (num.toString().indexOf('.') > -1) {\n      return num.toFixed(fixed);\n    }\n    return num;\n  }\n\n  static safeValue(value, defaultValue = '') {\n    return SheetUtils.isUnDef(value) ? defaultValue : value;\n  }\n\n  static inWorker() {\n    // eslint-disable-next-line no-restricted-globals\n    const type = SheetUtils.type(self);\n    return type === DATA_TYPE.DedicatedWorkerGlobalScope;\n  }\n\n  static if(condition, establish, otherwise) {\n    return condition ? establish() : otherwise();\n  }\n\n  static slice(likeArray) {\n    return Array.prototype.slice.call(likeArray);\n  }\n\n  static clearBlank(str) {\n    return str.replace(/\\s/g, '');\n  }\n\n}\n\nSheetUtils.EMPTY = '';\nSheetUtils.Nul = null;\nSheetUtils.Undef = undefined;\nSheetUtils.noop = () => {};\nSheetUtils.DATA_TYPE = DATA_TYPE;\n\nexport {\n  SheetUtils,\n};\n","class BaseFont {\n\n  constructor({\n    draw, ruler, attr,\n  }) {\n    this.draw = draw;\n    this.attr = attr;\n    this.ruler = ruler;\n  }\n\n  setRuler(ruler) {\n    this.ruler = ruler;\n  }\n\n  getAlignPadding() {\n    if (this.attr.align === BaseFont.ALIGN.center) {\n      return 0;\n    }\n    return this.attr.padding;\n  }\n\n  getVerticalAlignPadding() {\n    if (this.attr.verticalAlign === BaseFont.VERTICAL_ALIGN.center) {\n      return 0;\n    }\n    return this.attr.padding;\n  }\n\n}\n\nBaseFont.VERTICAL_ALIGN = {\n  top: 'top',\n  center: 'middle',\n  bottom: 'bottom',\n};\nBaseFont.ALIGN = {\n  left: 'left',\n  center: 'center',\n  right: 'right',\n};\nBaseFont.TEXT_WRAP = {\n  OVER_FLOW: 1,\n  WORD_WRAP: 2,\n  TRUNCATE: 3,\n};\nBaseFont.TEXT_DIRECTION = {\n  HORIZONTAL: 'horizontal',\n  VERTICAL: 'vertical',\n  ANGLE: 'angle',\n  ANGLE_BAR: 'bar',\n};\nBaseFont.DEFAULT_FONT_ATTR = {\n  name: 'Arial',\n  size: 14,\n  color: 'rgb(0,0,0)',\n  bold: false,\n  italic: false,\n  strikethrough: false,\n  underline: false,\n  angle: 0,\n  padding: 8,\n  align: BaseFont.ALIGN.left,\n  textWrap: BaseFont.TEXT_WRAP.TRUNCATE,\n  verticalAlign: BaseFont.VERTICAL_ALIGN.center,\n  direction: BaseFont.TEXT_DIRECTION.HORIZONTAL,\n};\nBaseFont.DEFAULT_RICH_ATTR = {\n  angle: 0,\n  padding: 8,\n  align: BaseFont.ALIGN.left,\n  textWrap: BaseFont.TEXT_WRAP.TRUNCATE,\n  verticalAlign: BaseFont.VERTICAL_ALIGN.center,\n  direction: BaseFont.TEXT_DIRECTION.HORIZONTAL,\n};\nBaseFont.DEFAULT_RICH_ITEM_ATTR = {\n  name: 'Arial',\n  size: 14,\n  color: 'rgb(0,0,0)',\n  bold: false,\n  italic: false,\n  strikethrough: false,\n  underline: false,\n};\n\nexport {\n  BaseFont,\n};\n","/* global document MouseEvent CustomEvent window NodeList HTMLCollection DocumentFragment */\nimport { SheetUtils } from '../utils/SheetUtils';\n\n/**\n * Element\n */\nclass Element {\n\n  /**\n   * \n   */\n  static wrapElement(object) {\n    if ([\n      SheetUtils.isArray(object),\n      object instanceof HTMLCollection,\n      object instanceof NodeList,\n    ].includes(true)) {\n      let elements = [];\n      for (let i = 0; i < object.length; i++) {\n        const item = object[i];\n        if (item instanceof Element) {\n          elements.push(item);\n        } else {\n          elements.push(new Element(item));\n        }\n      }\n      return elements;\n    }\n    return new Element(object);\n  }\n\n  static createText(text) {\n    return new Element(document.createTextNode(text));\n  }\n\n  /**\n   * \n   * @param value\n   * @returns {string|null}\n   */\n  static hyphenateRE(value) {\n    if (value) {\n      return value.replace(/([A-Z])/g, '-$1').toLowerCase();\n    }\n    return null;\n  }\n\n  /**\n   * Element\n   * @param tag\n   * @param className\n   */\n  constructor(tag, className = '') {\n    if (typeof tag === 'string') {\n      this.el = document.createElement(tag);\n      if (className) {\n        this.el.className = className;\n      }\n    } else {\n      this.el = tag;\n    }\n    this.map = {};\n  }\n\n  /**\n   * \n   * @param key\n   * @param value\n   * @returns {Element|*}\n   */\n  data(key, value) {\n    if (value !== undefined) {\n      this.map[key] = value;\n      return this;\n    }\n    return this.map[key];\n  }\n\n  /**\n   * ,\n   * \n   * @param args\n   * @returns {*[]|Element}\n   */\n  children(...args) {\n    if (arguments.length === 0) {\n      return Element.wrapElement(this.el.children);\n    }\n    args.forEach(ele => this.append(ele));\n    return this;\n  }\n\n  /**\n   * ,\n   * \n   * @param args\n   * @returns {*[]|Element}\n   */\n  childrenNodes(...args) {\n    if (arguments.length === 0) {\n      return Element.wrapElement(this.el.childNodes);\n    }\n    args.forEach(ele => this.append(ele));\n    return this;\n  }\n\n  /**\n   * \n   * @param ele\n   */\n  childrenNodesAppend(ele) {\n    if (!this.isTextNode()) {\n      ele.childrenNodes().forEach(i => this.append(i));\n    }\n    return this;\n  }\n\n  /**\n   * \n   * @param ele\n   */\n  childrenNodesPrepend(ele) {\n    if (!this.isTextNode()) {\n      ele.childrenNodes().forEach(i => this.prepend(i));\n    }\n    return this;\n  }\n\n  /**\n   * \n   * @param ele\n   */\n  append(ele) {\n    if (!this.isTextNode()) {\n      if (ele && ele.el) {\n        this.el.append(ele.el);\n      }\n    }\n    return this;\n  }\n\n  /**\n   * \n   * @param ele\n   */\n  prepend(ele) {\n    if (!this.isTextNode()) {\n      if (ele && ele.el) {\n        this.el.prepend(ele.el);\n      }\n    }\n    return this;\n  }\n\n  /**\n   * \n   * @param value\n   * @returns {{top: *, left: *, width: *, height: *}|Element}\n   */\n  offset(value) {\n    if (value !== undefined) {\n      Object.keys(value).forEach((k) => {\n        this.css(k, `${value[k]}px`);\n      });\n      return this;\n    }\n    const { offsetTop, offsetLeft } = this.el;\n    const { offsetHeight, offsetWidth } = this.el;\n    return {\n      top: offsetTop,\n      left: offsetLeft,\n      height: offsetHeight,\n      width: offsetWidth,\n    };\n  }\n\n  /**\n   * \n   * @returns {Element}\n   */\n  parent() {\n    return this.el.parentNode\n      ? new Element(this.el.parentNode) : null;\n  }\n\n  /**\n   * Class\n   * @param name\n   * @returns {Element}\n   */\n  addClass(name) {\n    if (!this.isTextNode()) {\n      this.el.classList.add(name);\n    }\n    return this;\n  }\n\n  /**\n   * Class\n   * @param name\n   * @returns {boolean}\n   */\n  hasClass(name) {\n    if (!this.isTextNode()) {\n      return this.el.classList.contains(name);\n    }\n    return false;\n  }\n\n  /**\n   * \n   * @returns {boolean}\n   */\n  hasChildElement() {\n    return this.children().length > 0;\n  }\n\n  /**\n   * \n   * @returns {boolean}\n   */\n  hasChild() {\n    return this.childrenNodes().length > 0;\n  }\n\n  /**\n   * Class\n   * @param name\n   * @returns {Element}\n   */\n  removeClass(name) {\n    if (!this.isTextNode()) {\n      this.el.classList.remove(name);\n    }\n    return this;\n  }\n\n  /**\n   * \n   * getBoundingClientRect\n   * @returns {DOMRect}\n   */\n  box() {\n    if (!this.isTextNode()) {\n      return this.el.getBoundingClientRect();\n    }\n    return null;\n  }\n\n  /**\n   * \n   * @returns {*}\n   */\n  first() {\n    if (!this.isTextNode()) {\n      return Element.wrapElement(this.el.firstChild);\n    }\n    return null;\n  }\n\n  /**\n   * \n   * @returns {*}\n   */\n  last() {\n    if (!this.isTextNode()) {\n      return Element.wrapElement(this.el.lastChild);\n    }\n    return null;\n  }\n\n  /**\n   * \n   */\n  firstTextNode() {\n    if (this.isTextNode()) {\n      return this;\n    }\n    let find = null;\n    let handle = (elem) => {\n      if (elem.hasChild()) {\n        elem.childrenNodes().forEach((elem) => {\n          if (find === null) {\n            handle(elem);\n          }\n        });\n      }\n      if (find === null) {\n        if (elem.isTextNode()) {\n          find = elem;\n        }\n      }\n    };\n    handle(this);\n    return find;\n  }\n\n  /**\n   * \n   */\n  lastTextNode() {\n    if (this.isTextNode()) {\n      return this;\n    }\n    let find = null;\n    let handle = (elem) => {\n      if (elem.hasChild()) {\n        elem.childrenNodes().reverse().forEach((elem) => {\n          if (find === null) {\n            handle(elem);\n          }\n        });\n      }\n      if (find === null) {\n        if (elem.isTextNode()) {\n          find = elem;\n        }\n      }\n    };\n    handle(this);\n    return find;\n  }\n\n  /**\n   * \n   * @param target\n   * @returns {boolean|ActiveX.IXMLDOMNode|*}\n   */\n  remove(target = null) {\n    if (target) {\n      if (!this.isTextNode()) {\n        this.el.removeChild(target.el || target);\n      }\n    } else {\n      const parent = this.parent();\n      if (parent) {\n        this.parent().remove(this);\n      }\n    }\n    return this;\n  }\n\n  /**\n   * \n   * @param ele\n   * @returns {boolean|*}\n   */\n  contains(ele) {\n    if (this.isTextNode()) {\n      return false;\n    }\n    return this.el.contains(ele.el);\n  }\n\n  /**\n   * \n   * @returns {*}\n   */\n  prev() {\n    return this.el.previousSibling\n      ? Element.wrapElement(this.el.previousSibling) : null;\n  }\n\n  /**\n   * \n   * @returns {*}\n   */\n  next() {\n    return this.el.nextSibling\n      ? Element.wrapElement(this.el.nextSibling) : null;\n  }\n\n  /**\n   * \n   * @param flag\n   * @param cls\n   * @returns {Element}\n   */\n  active(flag = true, cls = 'active') {\n    if (!this.isTextNode()) {\n      if (flag) this.addClass(cls);\n      else this.removeClass(cls);\n    }\n    return this;\n  }\n\n  /**\n   * \n   * @param text\n   * @returns {string|Element}\n   */\n  text(text) {\n    if (this.isTextNode()) {\n      return this.nodeValue();\n    }\n    if (text !== undefined) {\n      this.el.innerText = text;\n      return this;\n    }\n    return this.el.innerText;\n  }\n\n  /**\n   * html\n   * @param html\n   * @returns {Element|*}\n   */\n  html(html) {\n    if (this.isTextNode()) {\n      return this.nodeValue();\n    }\n    if (html !== undefined) {\n      this.el.innerHTML = html;\n      return this;\n    }\n    return this.el.innerHTML;\n  }\n\n  /**\n   * \n   */\n  focus() {\n    if (!this.isTextNode()) {\n      this.el.focus();\n    }\n    return this;\n  }\n\n  /**\n   * \n   */\n  blur() {\n    if (!this.isTextNode()) {\n      this.el.blur();\n    }\n    return this;\n  }\n\n  /**\n   * \n   * @param key\n   * @returns {Element}\n   */\n  removeAttr(key) {\n    if (!this.isTextNode()) {\n      this.el.removeAttribute(key);\n    }\n    return this;\n  }\n\n  /**\n   * style\n   * @param style\n   */\n  style(style) {\n    if (!this.isTextNode()) {\n      this.attr('style', style);\n    }\n    return this;\n  }\n\n  /**\n   * \n   * @param key\n   * @param value\n   * @returns {string|Element}\n   */\n  attr(key, value) {\n    if (!this.isTextNode()) {\n      if (value !== undefined) {\n        if (this.el.setAttribute) {\n          this.el.setAttribute(key, value);\n        }\n      } else {\n        if (typeof key === 'string') {\n          if (this.el.setAttribute) {\n            return this.el.getAttribute(key);\n          }\n          return null;\n        }\n        if (this.el.setAttribute) {\n          Object.keys(key).forEach((k) => {\n            this.el.setAttribute(k, key[k]);\n          });\n        }\n      }\n    }\n    return this;\n  }\n\n  /**\n   * Value\n   * @param v\n   * @returns {Element|*}\n   */\n  val(v) {\n    if (!this.isTextNode()) {\n      if (v !== undefined) {\n        this.el.value = v;\n        return this;\n      }\n      return this.el.value;\n    }\n    if (v === undefined) {\n      return this.nodeValue();\n    }\n    return this;\n  }\n\n  /**\n   * \n   * @returns {*}\n   */\n  get() {\n    return this.el;\n  }\n\n  /**\n   * style\n   * @param keys\n   * @returns {Element}\n   */\n  cssRemoveKeys(...keys) {\n    if (!this.isTextNode()) {\n      if (this.el.style) {\n        keys.forEach((k) => {\n          if (this.el.style) {\n            this.el.style.removeProperty(Element.hyphenateRE(k));\n          }\n        });\n      }\n    }\n    return this;\n  }\n\n  /**\n   * style\n   * @param key\n   * @param value\n   * @returns {Element}\n   */\n  cssRemoveVal(key, value) {\n    if (!this.isTextNode()) {\n      if (this.el.style) {\n        const property = Element.hyphenateRE(key);\n        const propertyValue = this.el.style.getPropertyValue(property);\n        const newValue = propertyValue.replace(value, '');\n        this.css(key, newValue);\n      }\n    }\n    return this;\n  }\n\n  /**\n   * \n   * @param name\n   * @param value\n   * @returns {Element|*}\n   */\n  css(name, value) {\n    if (!this.isTextNode()) {\n      if (this.el.style) {\n        if (value === undefined && typeof name !== 'string') {\n          Object.keys(name).forEach((key) => {\n            const property = Element.hyphenateRE(key);\n            this.el.style.setProperty(property, name[key]);\n          });\n          return this;\n        }\n        if (value !== undefined) {\n          const property = Element.hyphenateRE(name);\n          this.el.style.setProperty(property, value);\n          return this;\n        }\n        const property = Element.hyphenateRE(name);\n        return this.el.style.getPropertyValue(property);\n      }\n    }\n    return null;\n  }\n\n  /**\n   * \n   * @returns {CSSStyleDeclaration}\n   */\n  computedStyle() {\n    if (!this.isTextNode()) {\n      return window.getComputedStyle(this.el, null);\n    }\n    return null;\n  }\n\n  /**\n   * \n   * @returns {Element}\n   */\n  show() {\n    if (!this.isTextNode()) {\n      const style = this.computedStyle();\n      if (style && style.display !== 'block') {\n        this.css('display', 'block');\n      }\n    }\n    return this;\n  }\n\n  /**\n   * \n   * @returns {Element}\n   */\n  hide() {\n    if (!this.isTextNode()) {\n      const style = this.computedStyle();\n      if (style && style.display !== 'none') {\n        this.css('display', 'none');\n      }\n    }\n    return this;\n  }\n\n  /**\n   * \n   * @param type\n   * @param message\n   */\n  trigger(type, message) {\n    if (!this.isTextNode()) {\n      switch (type) {\n        case 'click': {\n          const evt = new MouseEvent(type, {\n            detail: message,\n            bubbles: true,\n            cancelable: false,\n          });\n          evt.initEvent('click', true, true);\n          this.el.dispatchEvent(evt);\n          break;\n        }\n        default: {\n          const evt = new CustomEvent(type, {\n            detail: message,\n            bubbles: true,\n            cancelable: false,\n          });\n          this.el.dispatchEvent(evt);\n          break;\n        }\n      }\n    }\n  }\n\n  /**\n   * \n   * @param select\n   * @returns {[]|Element}\n   */\n  find(select) {\n    if (!this.isTextNode()) {\n      const result = this.el.querySelectorAll(select);\n      if (result && result.length === 1) {\n        return new Element(result[0]);\n      }\n      const array = [];\n      if (result) {\n        for (const item of result) {\n          array.push(new Element(item));\n        }\n      }\n      return array;\n    }\n    return [];\n  }\n\n  /**\n   * \n   * @param select\n   * @returns {[]|Element}\n   */\n  finds(select) {\n    if (!this.isTextNode()) {\n      const result = this.el.querySelectorAll(select);\n      const array = [];\n      if (result) {\n        for (const item of result) {\n          array.push(new Element(item));\n        }\n      }\n      return array;\n    }\n    return [];\n  }\n\n  /**\n   * \n   * @returns {[]}\n   */\n  sibling() {\n    let sibling = this.el;\n    const result = [];\n    // eslint-disable-next-line no-cond-assign\n    while ((sibling = sibling.previousElementSibling) !== null) result.push(new Element(sibling));\n    sibling = this.el;\n    // eslint-disable-next-line no-cond-assign\n    while ((sibling = sibling.nextElementSibling) !== null) result.push(new Element(sibling));\n    return result;\n  }\n\n  /**\n   * \n   * @returns {string}\n   */\n  tagName() {\n    return this.el.nodeName.toLocaleLowerCase();\n  }\n\n  /**\n   * \n   * @returns {string}\n   */\n  nodeValue() {\n    return this.el.nodeValue;\n  }\n\n  /**\n   * \n   * @returns {number}\n   */\n  nodeType() {\n    return this.el.nodeType;\n  }\n\n  /**\n   * \n   * @param ele\n   */\n  after(ele) {\n    if (this.el && ele && ele.el) {\n      this.el.after(ele.el);\n    }\n    return this;\n  }\n\n  /**\n   * \n   * @param ele\n   */\n  before(ele) {\n    if (this.el && ele && ele.el) {\n      this.el.before(ele.el);\n    }\n    return this;\n  }\n\n  /**\n   * \n   */\n  clone() {\n    return new Element(this.el.cloneNode(true));\n  }\n\n  /**\n   * \n   */\n  empty() {\n    if (!this.isTextNode()) {\n      this.html('');\n    }\n    return this;\n  }\n\n  /**\n   * \n   * @param other\n   * @returns {boolean}\n   */\n  equals(other) {\n    return this.el === other.el;\n  }\n\n  /**\n   * \n   * @returns {number}\n   */\n  index() {\n    let parent = this.parent();\n    let index = -1;\n    parent.childrenNodes()\n      .forEach((v, i) => {\n        if (v.equals(this)) {\n          index = i;\n        }\n      });\n    return index;\n  }\n\n  /**\n   * dom\n   * @param ele\n   * @returns {boolean}\n   */\n  is(ele) {\n    return this.el === ele.el;\n  }\n\n  /**\n   * \n   * @returns {boolean}\n   */\n  isTextNode() {\n    return this.tagName() === '#text';\n  }\n\n  /**\n   * \n   * @returns {boolean}\n   */\n  isBreakNode() {\n    return this.tagName() === 'br';\n  }\n\n  /**\n   * \n   * @returns {boolean}\n   */\n  isDocumentFragment() {\n    return this.el instanceof DocumentFragment;\n  }\n\n}\n\nconst h = (tag, className = '') => new Element(tag, className);\n\nconst TextNode = text => Element.createText(text);\n\nexport {\n  Element,\n  TextNode,\n  h,\n};\n","const cssPrefix = 'x-sheet';\nconst XSheetVersion = `${cssPrefix} 1.0.0-develop`;\nconst Constant = {};\nConstant.WORK_BODY_EVENT_TYPE = {\n  CHANGE_ACTIVE: 'changeactive',\n  REMOVE_SHEET: 'removesheet',\n};\nConstant.SYSTEM_EVENT_TYPE = {\n  MOUSE_MOVE: 'mousemove',\n  MOUSE_DOWN: 'mousedown',\n  CONTEXT_MENU: 'contextmenu',\n  SCROLL: 'scroll',\n  RESIZE: 'resize',\n  MOUSE_UP: 'mouseup',\n  INPUT: 'input',\n  KEY_DOWN: 'keydown',\n  KEY_UP: 'keyup',\n  MOUSE_OVER: 'mouseover',\n  MOUSE_LEAVE: 'mouseleave',\n  MOUSE_WHEEL: 'wheel',\n  MOUSE_ENTER: 'mouseenter',\n  CLICK: 'click',\n  FOCUS: 'focus',\n  DRAG_START: 'dragstart',\n  CHANGE: 'change',\n  VISIBILITY_CHANGE: 'visibilitychange',\n};\nConstant.TABLE_EVENT_TYPE = {\n  RENDER: 'render',\n  SNAPSHOT_CHANGE: 'snapshotchange',\n  CHANGE_ROW_HEIGHT: 'changerowheight',\n  CHANGE_COL_WIDTH: 'changecolwidth',\n  SCALE_CHANGE: 'scalechange',\n  EDIT_START: 'editstart',\n  EDIT_INPUT: 'editinput',\n  EDIT_FINISH: 'editfinish',\n  REMOVE_ROW: 'removerow',\n  REMOVE_COL: 'removecol',\n  ADD_NEW_ROW: 'addnewrow',\n  ADD_NEW_COL: 'addnewcol',\n  FIXED_CHANGE: 'fixedchange',\n  FIXED_COL_CHANGE: 'fixedcolchange',\n  FIXED_ROW_CHANGE: 'fixedrowchange',\n  SELECT_OVER: 'selectover',\n  SELECT_DOWN: 'selectdown',\n  SELECT_CHANGE: 'selectchange',\n  DATA_CHANGE: 'datachange',\n  RESIZE_CHANGE: 'resizechange',\n};\nConstant.FORM_EVENT_TYPE = {\n  SEARCH_INPUT_CHANGE: 'searchinputchange',\n  PLAIN_INPUT_CHANGE: 'plaininputchange',\n  FORM_SELECT_CHANGE: 'formselectchange',\n};\nexport {\n  XSheetVersion,\n  Constant,\n  cssPrefix,\n};\n","import { Constant } from '../const/Constant';\nimport { Element } from './Element';\n\nclass BindPool {\n\n  constructor() {\n    this.pool = [];\n  }\n\n  unbind(ele, type, callback, option) {\n    if (ele instanceof Element) {\n      ele = ele.el;\n    }\n    const result = this.remove(ele, type, callback, option);\n    if (result.length) {\n      result.forEach((item) => {\n        ele.removeEventListener(item.type, item.callback, item.option);\n      });\n    } else {\n      ele.removeEventListener(type, callback, option);\n    }\n  }\n\n  bind(ele, type, callback, option) {\n    if (ele instanceof Element) {\n      ele = ele.el;\n    }\n    this.pool.push({\n      ele, type, callback, option,\n    });\n    ele.addEventListener(type, callback, option);\n  }\n\n  remove(ele, type = '*', callback = null, option = null) {\n    const pool = [];\n    const rem = [];\n    this.pool.forEach((item) => {\n      const eqElem = ele === item.ele;\n      const eqOpt = option === null || option === item.option;\n      const eqType = type === '*' || type === item.type;\n      const eqCall = callback === null || callback === item.callback;\n      if (eqElem && eqType && eqCall && eqOpt) {\n        rem.push(item);\n      } else {\n        pool.push(item);\n      }\n    });\n    this.pool = pool;\n    return rem;\n  }\n\n  multipleUnbind(eles, type, callback, option) {\n    eles.forEach((item) => {\n      this.unbind(item, type, callback, option);\n    });\n  }\n\n  multipleBind(eles, type, callback, option) {\n    eles.forEach((item) => {\n      this.bind(item, type, callback, option);\n    });\n  }\n\n}\n\nconst pool = new BindPool();\n\nclass XEvent {\n\n  static unbind(target, name, fn, option = false) {\n    if (Array.isArray(target)) {\n      pool.multipleUnbind(target, name, fn, option);\n    } else {\n      pool.unbind(target, name, fn, option);\n    }\n    return target;\n  }\n\n  static bind(target, name, fn, option = false) {\n    if (Array.isArray(target)) {\n      pool.multipleBind(target, name, fn, option);\n    } else {\n      pool.bind(target, name, fn, option);\n    }\n    return target;\n  }\n\n  static mouseHold(target, holdFunc = () => {}, endFunc = () => {}, time = 150) {\n    let handle = setInterval(() => {\n      holdFunc();\n    }, time);\n    let xEvtUp = (evt) => {\n      clearInterval(handle);\n      XEvent.unbind(target, Constant.SYSTEM_EVENT_TYPE.MOUSE_UP, xEvtUp, true);\n      endFunc(evt);\n    };\n    holdFunc();\n    XEvent.bind(target, Constant.SYSTEM_EVENT_TYPE.MOUSE_UP, xEvtUp, true);\n  }\n\n  static mouseMoveUp(target, moveFunc = () => {}, upFunc = () => {}) {\n    const xEvtMove = (evt) => {\n      moveFunc(evt);\n      evt.stopPropagation();\n      evt.preventDefault();\n    };\n    const xEvtUp = (evt) => {\n      XEvent.unbind(target, Constant.SYSTEM_EVENT_TYPE.MOUSE_MOVE, xEvtMove, true);\n      XEvent.unbind(target, Constant.SYSTEM_EVENT_TYPE.MOUSE_UP, xEvtUp, true);\n      upFunc(evt);\n      evt.preventDefault();\n    };\n    XEvent.bind(target, Constant.SYSTEM_EVENT_TYPE.MOUSE_MOVE, xEvtMove, true);\n    XEvent.bind(target, Constant.SYSTEM_EVENT_TYPE.MOUSE_UP, xEvtUp, true);\n    return target;\n  }\n\n}\n\nXEvent.WrapFuncion = {\n  doubleClick: (callback) => {\n    let lastPageX = 0;\n    let lastPageY = 0;\n    let lastTime = 0;\n    return (event) => {\n      if (event.button === 2) {\n        lastPageX = 0;\n        lastTime = 0;\n        lastPageY = 0;\n        return;\n      }\n      const { pageX, pageY } = event;\n      const current = Date.now();\n      const diffTime = current - lastTime <= 300;\n      const diffPageX = pageX === lastPageX;\n      const diffPageY = pageY === lastPageY;\n      if (diffTime && diffPageX && diffPageY) {\n        callback(event);\n        lastTime = 0;\n        lastPageX = 0;\n        lastPageY = 0;\n      } else {\n        lastPageX = pageX;\n        lastPageY = pageY;\n        lastTime = current;\n      }\n    };\n  },\n  mouseClick: callback => (event) => {\n    callback(event);\n  },\n};\n\nexport {\n  XEvent,\n};\n","/* global document */\n\nimport { Element, h } from './Element';\nimport { cssPrefix } from '../const/Constant';\nimport { XEvent } from './XEvent';\n\n/**\n * Life\n */\nclass Life extends Element {\n\n  onAttach() { }\n\n}\n\n/**\n * Widget\n */\nclass Widget extends Life {\n\n  /**\n   * Widget\n   * @param className\n   * @param nodeType\n   * @param $$rootFlag\n   */\n  constructor(className = '', nodeType = 'div', $$rootFlag = false) {\n    if (typeof className === 'string') {\n      super(nodeType, `${cssPrefix}-widget ${className}`);\n    } else {\n      super(className);\n    }\n    this.$$rootFlag = $$rootFlag;\n  }\n\n  /**\n   * \n   * class\n   * @param clazz\n   */\n  closestClass(clazz) {\n    let node = this;\n    while (!h(document.body).is(node)) {\n      if (node.hasClass(clazz)) {\n        return node;\n      }\n      node = node.parent();\n    }\n    return null;\n  }\n\n  /**\n   *  root widget\n   */\n  getRootWidget() {\n    let parent = this.data('parent');\n    while (parent && !parent.$$rootFlag) {\n      parent = parent.data('parent');\n    }\n    return parent;\n  }\n\n  /**\n   * \n   */\n  bind() {\n\n  }\n\n  /**\n   * \n   */\n  unbind() {\n    XEvent.unbind(this);\n  }\n\n  /**\n   * \n   * onAttach\n   * @param widget\n   */\n  attach(widget) {\n    this.childrenNodes(widget);\n    widget.parentWidget(this);\n    widget.onAttach(this);\n  }\n\n  /**\n   *  parent widget\n   * @param widget\n   */\n  parentWidget(widget) {\n    if (widget) {\n      this.data('parent', widget);\n      return this;\n    }\n    return this.data('parent');\n  }\n\n  /**\n   * \n   * \n   * @param event\n   * @param elem\n   * @returns {{x: number, y: number}}\n   */\n  eventXy(event, elem = this) {\n    const { top, left } = elem.box();\n    return {\n      y: event.clientY - top,\n      x: event.clientX - left,\n    };\n  }\n\n  /**\n   * \n   */\n  destroy() {\n    this.unbind();\n    this.remove();\n  }\n\n}\n\nconst w = (className = '', nodeType = 'div') => new Widget(className, nodeType);\n\nexport {\n  Widget,\n  w,\n};\n","import { Widget } from '../../../../lib/Widget';\nimport { cssPrefix } from '../../../../const/Constant';\nimport { h } from '../../../../lib/Element';\n\nclass Icon extends Widget {\n\n  constructor(className = '') {\n    super(`${cssPrefix}-icon`);\n    this.iconNameEl = h('div', `${cssPrefix}-icon-img ${className}`);\n    this.childrenNodes(this.iconNameEl);\n  }\n\n  setWidth(width) {\n    this.iconNameEl.css('width', `${width}px`);\n  }\n\n  setHeight(height) {\n    this.iconNameEl.css('height', `${height}px`);\n  }\n\n}\n\nexport { Icon };\n","/* global document */\nimport { Widget } from '../../lib/Widget';\nimport { cssPrefix, Constant } from '../../const/Constant';\nimport { XEvent } from '../../lib/XEvent';\n\nimport { h } from '../../lib/Element';\nimport { SheetUtils } from '../../utils/SheetUtils';\n\nlet instances = [];\n\n/**\n * DragPanel\n * @author jerry\n * @date 2020/10/19\n */\nclass DragPanel extends Widget {\n\n  /**\n   * DragPanel\n   * @param options\n   */\n  constructor(options) {\n    super(`${cssPrefix}-drag-panel`);\n    instances.push(this);\n    this.options = SheetUtils.copy({\n      position: DragPanel.DRAG_PANEL_POSITION.CENTER,\n    }, options);\n    this.status = false;\n    this.mask = h('div', `${cssPrefix}-drag-panel-mask`);\n    this.content = h('div', `${cssPrefix}-drag-panel-content`);\n    super.childrenNodes(this.content);\n    this.bind();\n  }\n\n  /**\n   * \n   */\n  open() {\n    const root = this.getRootWidget();\n    const { mask } = this;\n    if (this.status === false && root) {\n      this.status = true;\n      root.childrenNodes(mask);\n      root.childrenNodes(this);\n      this.dragPanelLocation();\n    }\n    return this;\n  }\n\n  /**\n   * \n   */\n  close() {\n    const root = this.getRootWidget();\n    if (this.status === true && root) {\n      const { mask } = this;\n      this.status = false;\n      root.remove(this);\n      root.remove(mask);\n    }\n    return this;\n  }\n\n  /**\n   * \n   */\n  unbind() {\n    const { mask } = this;\n    XEvent.unbind(mask);\n  }\n\n  /**\n   * \n   */\n  bind() {\n    const { mask } = this;\n    XEvent.bind(mask, Constant.SYSTEM_EVENT_TYPE.MOUSE_DOWN, (e) => {\n      this.close();\n      e.stopPropagation();\n    });\n    XEvent.bind(this, Constant.SYSTEM_EVENT_TYPE.MOUSE_DOWN, (evt1) => {\n      if (evt1.button !== 0) return;\n      const downEventXy = this.eventXy(evt1, this);\n      XEvent.mouseMoveUp(h(document), (evt2) => {\n        // \n        const top = evt2.pageY - downEventXy.y;\n        const left = evt2.pageX - downEventXy.x;\n        this.offset({ top, left });\n        evt2.stopPropagation();\n      });\n      evt1.stopPropagation();\n    });\n  }\n\n  /**\n   * \n   */\n  dragPanelLocation() {\n    const root = this.getRootWidget();\n    const { options } = this;\n    const { position } = options;\n    const rootBox = root.box();\n    const elemBox = this.box();\n    switch (position) {\n      case DragPanel.DRAG_PANEL_POSITION.LEFT:\n        break;\n      case DragPanel.DRAG_PANEL_POSITION.RIGHT:\n        break;\n      case DragPanel.DRAG_PANEL_POSITION.TOP:\n        break;\n      case DragPanel.DRAG_PANEL_POSITION.CENTER:\n        this.offset({\n          left: rootBox.width / 2 - elemBox.width / 2,\n          top: rootBox.height / 2 - elemBox.height / 2,\n        });\n        break;\n      default: break;\n    }\n    return this;\n  }\n\n  /**\n   * \n   * @param args\n   * @returns {DragPanel}\n   */\n  childrenNodes(...args) {\n    this.content.childrenNodes(...args);\n    return this;\n  }\n\n  /**\n   * \n   */\n  destroy() {\n    super.destroy();\n    this.unbind();\n    DragPanel.removeInstance(this);\n  }\n\n  /**\n   * \n   * @param instance\n   */\n  static removeInstance(instance) {\n    const filter = [];\n    instances.forEach((item) => {\n      if (item !== instance) {\n        filter.push(item);\n      }\n    });\n    instances = filter;\n  }\n\n  /**\n   * \n   * @param filter\n   */\n  static closeAll(filter = []) {\n    instances.forEach((item) => {\n      if (filter.indexOf(item) === -1) {\n        item.close();\n      }\n    });\n  }\n\n}\n\nDragPanel.DRAG_PANEL_POSITION = {\n  LEFT: 1,\n  TOP: 2,\n  RIGHT: 3,\n  CENTER: 4,\n};\n\nexport { DragPanel };\n","/* global document */\nimport { h } from '../../lib/Element';\nimport { cssPrefix, Constant } from '../../const/Constant';\nimport { Widget } from '../../lib/Widget';\nimport { DragPanel } from '../dragpanel/DragPanel';\nimport { XEvent } from '../../lib/XEvent';\nimport { SheetUtils } from '../../utils/SheetUtils';\n\nclass ColorPicker extends Widget {\n\n  constructor(options) {\n    super(`${cssPrefix}-color-picker`);\n    this.options = SheetUtils.copy({\n      selectCb: () => {},\n    }, options);\n    // \n    this.dragPanel = new DragPanel().parentWidget(this);\n    this.color = [360, 0, 100];\n    // \n    this.preViewColorPoint = h('div', `${cssPrefix}-color-picker-pre-view-color-point`);\n    this.colorValueTips = h('div', `${cssPrefix}-color-picker-color-value-tips`);\n    this.colorValueTips.text('');\n    this.colorInput = h('input', `${cssPrefix}-color-picker-color-input`);\n    this.top = h('div', `${cssPrefix}-color-picker-top`);\n    this.top.childrenNodes(this.preViewColorPoint);\n    this.top.childrenNodes(this.colorValueTips);\n    this.top.childrenNodes(this.colorInput);\n    // \n    this.selectColorPoint = h('div', `${cssPrefix}-color-picker-select-color-point`);\n    this.selectColorArea1 = h('div', `${cssPrefix}-color-picker-select-color-area area1`);\n    this.selectColorArea2 = h('div', `${cssPrefix}-color-picker-select-color-area area2`);\n    this.selectColorArea3 = h('div', `${cssPrefix}-color-picker-select-color-area area3`);\n    this.center = h('div', `${cssPrefix}-color-picker-center`);\n    this.center.childrenNodes(this.selectColorArea1);\n    this.center.childrenNodes(this.selectColorArea2);\n    this.center.childrenNodes(this.selectColorArea3);\n    this.center.childrenNodes(this.selectColorPoint);\n    // \n    this.colorHuxTips = h('div', `${cssPrefix}-color-picker-color-hux-tips`);\n    this.colorBar = h('div', `${cssPrefix}-color-picker-color-bar`);\n    this.colorBarPoint = h('div', `${cssPrefix}-color-picker-bar-point`);\n    this.bottom = h('div', `${cssPrefix}-color-picker-bottom`);\n    this.colorHuxTips.text('HUE');\n    this.colorBar.childrenNodes(this.colorBarPoint);\n    this.bottom.childrenNodes(this.colorHuxTips);\n    this.bottom.childrenNodes(this.colorBar);\n    // \n    this.cancelButton = h('div', `${cssPrefix}-color-picker-button cancel`);\n    this.selectButton = h('div', `${cssPrefix}-color-picker-button select`);\n    this.buttons = h('div', `${cssPrefix}-color-picker-buttons`);\n    this.cancelButton.text('');\n    this.selectButton.text('');\n    this.buttons.childrenNodes(this.selectButton);\n    this.buttons.childrenNodes(this.cancelButton);\n    this.childrenNodes(this.top);\n    this.childrenNodes(this.center);\n    this.childrenNodes(this.bottom);\n    this.childrenNodes(this.buttons);\n    this.dragPanel.childrenNodes(this);\n    this.dragPanel.css('background', '#ffffff');\n    this.bind();\n  }\n\n  unbind() {\n    const { selectColorPoint } = this;\n    const { colorBarPoint } = this;\n    const {\n      colorInput, cancelButton, selectButton,\n    } = this;\n    XEvent.unbind(colorInput);\n    XEvent.unbind(colorInput);\n    XEvent.unbind(colorBarPoint);\n    XEvent.unbind(selectColorPoint);\n    XEvent.unbind(cancelButton);\n    XEvent.unbind(selectButton);\n  }\n\n  bind() {\n    const { selectColorPoint, center } = this;\n    const { colorBarPoint, colorBar } = this;\n    const {\n      colorInput, cancelButton, selectButton,\n    } = this;\n    XEvent.bind(colorInput, Constant.SYSTEM_EVENT_TYPE.MOUSE_DOWN, (e1) => {\n      e1.stopPropagation();\n    });\n    XEvent.bind(colorInput, Constant.SYSTEM_EVENT_TYPE.CHANGE, () => {\n      const value = colorInput.val();\n      if (value) {\n        this.hexColor(value);\n      }\n    });\n    XEvent.bind(colorBarPoint, Constant.SYSTEM_EVENT_TYPE.MOUSE_DOWN, (e1) => {\n      const xy = this.eventXy(e1, colorBar);\n      const colorBarBox = colorBar.box();\n      if (xy.x < 0) xy.x = 0;\n      if (xy.x > colorBarBox.width) xy.x = colorBarBox.width;\n      this.downHue(xy.x, colorBarBox.width);\n      XEvent.mouseMoveUp(h(document), (e2) => {\n        const xy = this.eventXy(e2, colorBar);\n        const colorBarBox = colorBar.box();\n        if (xy.x < 0) xy.x = 0;\n        if (xy.x > colorBarBox.width) xy.x = colorBarBox.width;\n        this.moveHue(xy.x, colorBarBox.width);\n      });\n      e1.stopPropagation();\n    });\n    XEvent.bind(selectColorPoint, Constant.SYSTEM_EVENT_TYPE.MOUSE_DOWN, (e1) => {\n      const xy = this.eventXy(e1, center);\n      const centerBox = center.box();\n      if (xy.x < 0) xy.x = 0;\n      if (xy.x > centerBox.width) xy.x = centerBox.width;\n      if (xy.y < 0) xy.y = 0;\n      if (xy.y > centerBox.height) xy.y = centerBox.height;\n      this.downSelect(xy.x, xy.y, centerBox.width, centerBox.height);\n      XEvent.mouseMoveUp(h(document), (e2) => {\n        const xy = this.eventXy(e2, center);\n        if (xy.x < 0) xy.x = 0;\n        if (xy.x > centerBox.width) xy.x = centerBox.width;\n        if (xy.y < 0) xy.y = 0;\n        if (xy.y > centerBox.height) xy.y = centerBox.height;\n        this.moveSelect(xy.x, xy.y, centerBox.width, centerBox.height);\n      });\n      e1.stopPropagation();\n    });\n    XEvent.bind(cancelButton, Constant.SYSTEM_EVENT_TYPE.CLICK, () => {\n      this.close();\n    });\n    XEvent.bind(selectButton, Constant.SYSTEM_EVENT_TYPE.CLICK, () => {\n      const { color } = this;\n      const hsb = ColorPicker.fixHsx({\n        h: parseInt(color[0], 10),\n        s: parseInt(color[1], 10),\n        x: parseInt(color[2], 10),\n      });\n      const rgb = ColorPicker.hsbToRgb(hsb);\n      this.options.selectCb(`rgb(${rgb.r},${rgb.g},${rgb.b})`);\n      this.close();\n    });\n  }\n\n  open(hex) {\n    const { dragPanel } = this;\n    dragPanel.open();\n    if (hex) {\n      if (ColorPicker.isRgb(hex)) {\n        const rgb = ColorPicker.parseRgb(hex);\n        // eslint-disable-next-line no-param-reassign\n        hex = ColorPicker.rgbToHex(rgb);\n      }\n      this.hexColor(hex);\n    } else {\n      this.change();\n    }\n    return this;\n  }\n\n  close() {\n    const { dragPanel } = this;\n    dragPanel.close();\n    return this;\n  }\n\n  sliderPosition(hsb) {\n    // hue \n    const { colorBar, colorBarPoint } = this;\n    const colorBarPointBox = colorBarPoint.box();\n    const colorBarBox = colorBar.box();\n    let colorBarPointLeft = parseInt(colorBarBox.width - colorBarBox.width * hsb.h / 360, 10);\n    colorBarPointLeft -= colorBarPointBox.width / 2;\n    colorBarPoint.offset({\n      left: colorBarPointLeft,\n    });\n    // select color \n    const { center, selectColorPoint } = this;\n    const selectColorPointBox = selectColorPoint.box();\n    const centerBox = center.box();\n    let selectColorPointLeft = parseInt(centerBox.width * hsb.s / 100, 10);\n    let selectColorPointTop = parseInt(centerBox.height * (100 - hsb.x) / 100, 10);\n    selectColorPointLeft -= selectColorPointBox.width / 2;\n    selectColorPointTop -= selectColorPointBox.height / 2;\n    selectColorPoint.offset({\n      left: selectColorPointLeft,\n      top: selectColorPointTop,\n    });\n  }\n\n  hueChange() {\n    const { color } = this;\n    const hsb = ColorPicker.fixHsx({\n      h: parseInt(color[0], 10),\n      s: parseInt(color[1], 10),\n      x: parseInt(color[2], 10),\n    });\n    const {\n      colorBarPoint, selectColorPoint, preViewColorPoint, selectColorArea1, colorInput,\n    } = this;\n    const colorValue = ColorPicker.hsbToHex(hsb);\n    const areaColorValue = ColorPicker.hsbToHex({ h: hsb.h, s: 100, x: 100 });\n    selectColorPoint.css('backgroundColor', `#${colorValue}`);\n    preViewColorPoint.css('backgroundColor', `#${colorValue}`);\n    colorBarPoint.css('backgroundColor', `#${areaColorValue}`);\n    selectColorArea1.css('backgroundColor', `#${areaColorValue}`);\n    colorInput.val(`#${colorValue}`);\n    this.sliderPosition(hsb);\n  }\n\n  selectChange() {\n    const { color } = this;\n    const hsb = ColorPicker.fixHsx({\n      h: parseInt(color[0], 10),\n      s: parseInt(color[1], 10),\n      x: parseInt(color[2], 10),\n    });\n    const { preViewColorPoint, selectColorPoint, colorInput } = this;\n    const colorValue = ColorPicker.hsbToHex(hsb);\n    selectColorPoint.css('backgroundColor', `#${colorValue}`);\n    preViewColorPoint.css('backgroundColor', `#${colorValue}`);\n    colorInput.val(`#${colorValue}`);\n    this.sliderPosition(hsb);\n  }\n\n  change() {\n    this.hueChange();\n    this.selectChange();\n  }\n\n  downSelect(x, y, width, height) {\n    const { color } = this;\n    color[1] = parseInt(100 * x / width, 10);\n    color[2] = parseInt(100 * (height - y) / height, 10);\n    this.selectChange();\n  }\n\n  moveSelect(x, y, width, height) {\n    const { color } = this;\n    color[1] = parseInt(100 * (Math.max(0, Math.min(width, x))) / width, 10);\n    color[2] = parseInt(100 * (height - Math.max(0, Math.min(height, y))) / height, 10);\n    this.selectChange();\n  }\n\n  downHue(x, width) {\n    const { color } = this;\n    color[0] = parseInt(360 * (width - x) / width, 10);\n    this.hueChange();\n  }\n\n  moveHue(x, width) {\n    const { color } = this;\n    color[0] = parseInt(360 * (width - Math.max(0, Math.min(width, x))) / width, 10);\n    this.hueChange();\n  }\n\n  hexColor(hex) {\n    const { color } = this;\n    const result = ColorPicker.hexToHsb(ColorPicker.fixHex(hex));\n    color[0] = result.h;\n    color[1] = result.s;\n    color[2] = result.x;\n    this.change();\n  }\n\n  destroy() {\n    super.destroy();\n    this.unbind();\n    this.dragPanel.destroy();\n  }\n\n  static fixHex(hex) {\n    const len = 6 - hex.length;\n    if (len > 0) {\n      const o = [];\n      for (let i = 0; i < len; i += 1) {\n        o.push('0');\n      }\n      o.push(hex);\n      // eslint-disable-next-line no-param-reassign\n      hex = o.join('');\n    }\n    return hex;\n  }\n\n  static fixHsx(hsx) {\n    return {\n      h: Math.min(360, Math.max(0, hsx.h)),\n      s: Math.min(100, Math.max(0, hsx.s)),\n      x: Math.min(100, Math.max(0, hsx.x)),\n    };\n  }\n\n  static isRgb(rgb) {\n    return rgb.startsWith('rgb');\n  }\n\n  static isHex(hex) {\n    return hex.startsWith('#');\n  }\n\n  static isDark(rgb) {\n    if (SheetUtils.isString(rgb)) {\n      if (this.isHex(rgb)) {\n        const v = ColorPicker.hexToRgb(rgb);\n        rgb = `rgb(${v.r}, ${v.g}, ${v.b})`;\n      }\n      const result = ColorPicker.parseRgb(rgb);\n      const { r, g, b } = result;\n      return (r * 0.299) + (g * 0.578) + (b * 0.114) >= 192;\n    }\n    return false;\n  }\n\n  static hexToRgb(hex) {\n    // eslint-disable-next-line no-redeclare,no-param-reassign\n    hex = parseInt(((hex.indexOf('#') > -1) ? hex.substring(1) : hex), 16);\n    // eslint-disable-next-line no-bitwise\n    return { r: hex >> 16, g: (hex & 0x00FF00) >> 8, b: (hex & 0x0000FF) };\n  }\n\n  static hexToHsb(hex) {\n    return this.rgbToHsb(this.hexToRgb(hex));\n  }\n\n  static rgbToHsb(rgb) {\n    const hsb = { h: 0, s: 0, x: 0 };\n    const min = Math.min(rgb.r, rgb.g, rgb.b);\n    const max = Math.max(rgb.r, rgb.g, rgb.b);\n    const delta = max - min;\n    hsb.x = max;\n    hsb.s = max !== 0 ? 255 * delta / max : 0;\n    if (hsb.s !== 0) {\n      if (rgb.r === max) hsb.h = (rgb.g - rgb.b) / delta;\n      else if (rgb.g === max) hsb.h = 2 + (rgb.b - rgb.r) / delta;\n      else hsb.h = 4 + (rgb.r - rgb.g) / delta;\n    } else hsb.h = -1;\n    hsb.h *= 60;\n    if (hsb.h < 0) hsb.h += 360;\n    hsb.s *= 100 / 255;\n    hsb.x *= 100 / 255;\n    return hsb;\n  }\n\n  static hsbToRgb(hsb) {\n    const rgb = {};\n    let { h } = hsb;\n    const s = hsb.s * 255 / 100;\n    const v = hsb.x * 255 / 100;\n    if (s === 0) {\n      rgb.r = v;\n      rgb.g = v;\n      rgb.b = v;\n    } else {\n      const t1 = v;\n      const t2 = (255 - s) * v / 255;\n      const t3 = (t1 - t2) * (h % 60) / 60;\n      if (h === 360) h = 0;\n      if (h < 60) {\n        rgb.r = t1;\n        rgb.b = t2;\n        rgb.g = t2 + t3;\n      } else if (h < 120) {\n        rgb.g = t1;\n        rgb.b = t2;\n        rgb.r = t1 - t3;\n      } else if (h < 180) {\n        rgb.g = t1;\n        rgb.r = t2;\n        rgb.b = t2 + t3;\n      } else if (h < 240) {\n        rgb.b = t1;\n        rgb.r = t2;\n        rgb.g = t1 - t3;\n      } else if (h < 300) {\n        rgb.b = t1;\n        rgb.g = t2;\n        rgb.r = t2 + t3;\n      } else if (h < 360) {\n        rgb.r = t1;\n        rgb.g = t2;\n        rgb.b = t1 - t3;\n      } else {\n        rgb.r = 0;\n        rgb.g = 0;\n        rgb.b = 0;\n      }\n    }\n    return { r: Math.round(rgb.r), g: Math.round(rgb.g), b: Math.round(rgb.b) };\n  }\n\n  static rgbToHex(rgb) {\n    const hex = [\n      rgb.r.toString(16),\n      rgb.g.toString(16),\n      rgb.b.toString(16),\n    ];\n    hex.forEach((val, nr) => {\n      if (val.length === 1) {\n        hex[nr] = `0${val}`;\n      }\n    });\n    return hex.join('');\n  }\n\n  static hsbToHex(hsb) {\n    return this.rgbToHex(this.hsbToRgb(hsb));\n  }\n\n  static parseRgb(rgb) {\n    const rxp = /^rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)$/;\n    const result = rgb.match(rxp);\n    return {\n      r: parseInt(result[1], 10),\n      g: parseInt(result[2], 10),\n      b: parseInt(result[3], 10),\n    };\n  }\n\n  static parseRgbToHex(rgb, defaultValue = null) {\n    if (rgb) {\n      if (this.isHex(rgb)) {\n        return rgb.substring(1);\n      }\n      const value = this.parseRgb(rgb);\n      return this.rgbToHex(value);\n    }\n    return defaultValue;\n  }\n\n  static parseHexToRgb(hex, defaultValue = null) {\n    if (hex) {\n      const rgb = ColorPicker.hexToRgb(hex);\n      return `rgb(${rgb.r},${rgb.g},${rgb.b})`;\n    }\n    return defaultValue;\n  }\n\n}\n\nexport { ColorPicker };\n","import { Widget } from '../../../lib/Widget';\nimport { cssPrefix } from '../../../const/Constant';\nimport { SheetUtils } from '../../../utils/SheetUtils';\nimport { Icon } from '../../../core/xwork/head/tool/Icon';\nimport { ColorPicker } from '../ColorPicker';\n\nclass ColorItem extends Widget {\n\n  constructor(options) {\n    super(`${cssPrefix}-color-array-item`);\n    this.options = SheetUtils.copy({\n      color: null,\n      icon: null,\n    }, options);\n    this.icon = this.options.icon;\n    this.color = SheetUtils.blankClear(this.options.color);\n    if (this.icon) {\n      this.childrenNodes(this.options.icon);\n    }\n    if (this.color) {\n      this.css('backgroundColor', this.color);\n      if (ColorPicker.isDark(this.options.color)) {\n        this.checkedIcon = new Icon('checked-dark');\n        this.childrenNodes(this.checkedIcon);\n      } else {\n        this.checkedIcon = new Icon('checked-light');\n        this.childrenNodes(this.checkedIcon);\n      }\n      this.checkedIcon.hide();\n    }\n  }\n\n  setActive(active) {\n    if (this.checkedIcon) {\n      if (active) {\n        this.checkedIcon.show();\n      } else {\n        this.checkedIcon.hide();\n      }\n    }\n  }\n\n}\n\nexport { ColorItem };\n","import { Widget } from '../../../lib/Widget';\nimport { cssPrefix, Constant } from '../../../const/Constant';\nimport { ColorItem } from './ColorItem';\nimport { SheetUtils } from '../../../utils/SheetUtils';\nimport { XEvent } from '../../../lib/XEvent';\n\nclass ColorArray extends Widget {\n\n  constructor(options) {\n    super(`${cssPrefix}-color-array`);\n    this.options = SheetUtils.copy({\n      colors: [\n        new ColorItem({ color: 'rgb(0, 0, 0)' }),\n        new ColorItem({ color: 'rgb(67, 67, 67)' }),\n        new ColorItem({ color: 'rgb(102, 102, 102)' }),\n        new ColorItem({ color: 'rgb(153, 153, 153)' }),\n        new ColorItem({ color: 'rgb(183, 183, 183)' }),\n        new ColorItem({ color: 'rgb(204, 204, 204)' }),\n        new ColorItem({ color: 'rgb(217, 217, 217)' }),\n        new ColorItem({ color: 'rgb(239, 239, 239)' }),\n        new ColorItem({ color: 'rgb(255, 255, 255)' }),\n\n        new ColorItem({ color: 'rgb(152, 0, 0)' }),\n        new ColorItem({ color: 'rgb(255, 0, 0)' }),\n        new ColorItem({ color: 'rgb(255, 153, 0)' }),\n        new ColorItem({ color: 'rgb(255, 255, 0)' }),\n        new ColorItem({ color: 'rgb(0, 255, 0)' }),\n        new ColorItem({ color: 'rgb(0, 255, 255)' }),\n        new ColorItem({ color: 'rgb(74, 134, 232)' }),\n        new ColorItem({ color: 'rgb(0, 0, 255)' }),\n        new ColorItem({ color: 'rgb(153, 0, 255)' }),\n        new ColorItem({ color: 'rgb(255, 0, 255)' }),\n\n        new ColorItem({ color: 'rgb(230, 184, 175)' }),\n        new ColorItem({ color: 'rgb(244, 204, 204)' }),\n        new ColorItem({ color: 'rgb(252, 229, 205)' }),\n        new ColorItem({ color: 'rgb(255, 242, 204)' }),\n        new ColorItem({ color: 'rgb(217, 234, 211)' }),\n        new ColorItem({ color: 'rgb(208, 224, 227)' }),\n        new ColorItem({ color: 'rgb(201, 218, 248)' }),\n        new ColorItem({ color: 'rgb(207, 226, 243)' }),\n        new ColorItem({ color: 'rgb(217, 210, 233)' }),\n        new ColorItem({ color: 'rgb(234, 209, 220)' }),\n\n        new ColorItem({ color: 'rgb(221, 126, 107)' }),\n        new ColorItem({ color: 'rgb(234, 153, 153)' }),\n        new ColorItem({ color: 'rgb(249, 203, 156)' }),\n        new ColorItem({ color: 'rgb(255, 229, 153)' }),\n        new ColorItem({ color: 'rgb(182, 215, 168)' }),\n        new ColorItem({ color: 'rgb(162, 196, 201)' }),\n        new ColorItem({ color: 'rgb(164, 194, 244)' }),\n        new ColorItem({ color: 'rgb(159, 197, 232)' }),\n        new ColorItem({ color: 'rgb(180, 167, 214)' }),\n        new ColorItem({ color: 'rgb(213, 166, 189)' }),\n\n        new ColorItem({ color: 'rgb(204, 65, 37)' }),\n        new ColorItem({ color: 'rgb(224, 102, 102)' }),\n        new ColorItem({ color: 'rgb(246, 178, 107)' }),\n        new ColorItem({ color: 'rgb(255, 217, 102)' }),\n        new ColorItem({ color: 'rgb(147, 196, 125)' }),\n        new ColorItem({ color: 'rgb(118, 165, 175)' }),\n        new ColorItem({ color: 'rgb(109, 158, 235)' }),\n        new ColorItem({ color: 'rgb(111, 168, 220)' }),\n        new ColorItem({ color: 'rgb(142, 124, 195)' }),\n        new ColorItem({ color: 'rgb(194, 123, 160)' }),\n\n        new ColorItem({ color: 'rgb(166, 28, 0)' }),\n        new ColorItem({ color: 'rgb(204, 0, 0)' }),\n        new ColorItem({ color: 'rgb(230, 145, 56)' }),\n        new ColorItem({ color: 'rgb(241, 194, 50)' }),\n        new ColorItem({ color: 'rgb(106, 168, 79)' }),\n        new ColorItem({ color: 'rgb(69, 129, 142)' }),\n        new ColorItem({ color: 'rgb(60, 120, 216)' }),\n        new ColorItem({ color: 'rgb(61, 133, 198)' }),\n        new ColorItem({ color: 'rgb(103, 78, 167)' }),\n        new ColorItem({ color: 'rgb(166, 77, 121)' }),\n\n        new ColorItem({ color: 'rgb(133, 32, 12)' }),\n        new ColorItem({ color: 'rgb(153, 0, 0)' }),\n        new ColorItem({ color: 'rgb(180, 95, 6)' }),\n        new ColorItem({ color: 'rgb(191, 144, 0)' }),\n        new ColorItem({ color: 'rgb(56, 118, 29)' }),\n        new ColorItem({ color: 'rgb(19, 79, 92)' }),\n        new ColorItem({ color: 'rgb(17, 85, 204)' }),\n        new ColorItem({ color: 'rgb(11, 83, 148)' }),\n        new ColorItem({ color: 'rgb(53, 28, 117)' }),\n        new ColorItem({ color: 'rgb(116, 27, 71)' }),\n\n        new ColorItem({ color: 'rgb(91, 15, 0)' }),\n        new ColorItem({ color: 'rgb(102, 0, 0)' }),\n        new ColorItem({ color: 'rgb(120, 63, 4)' }),\n        new ColorItem({ color: 'rgb(127, 96, 0)' }),\n        new ColorItem({ color: 'rgb(39, 78, 19)' }),\n        new ColorItem({ color: 'rgb(12, 52, 61)' }),\n        new ColorItem({ color: 'rgb(28, 69, 135)' }),\n        new ColorItem({ color: 'rgb(7, 55, 99)' }),\n        new ColorItem({ color: 'rgb(32, 18, 77)' }),\n        new ColorItem({ color: 'rgb(76, 17, 48)' }),\n      ],\n      selectCb: () => {},\n    }, options);\n    this.colors = [];\n    this.activeColor = null;\n    this.options.colors.forEach((item) => {\n      this.add(item);\n    });\n    if (this.colors.length > 0) {\n      this.setActiveByColor(this.colors[0].options.color);\n    }\n  }\n\n  add(item) {\n    const find = this.colors.findIndex(color => color.color === item.color);\n    if (find === -1) {\n      const { colors } = this;\n      colors.push(item);\n      this.childrenNodes(item);\n      this.bind(item);\n    }\n  }\n\n  unbind() {\n    this.colors.forEach((item) => {\n      XEvent.unbind(item);\n    });\n  }\n\n  bind(item) {\n    XEvent.bind(item, Constant.SYSTEM_EVENT_TYPE.MOUSE_DOWN, () => {\n      this.options.selectCb(item);\n      if (item.options.color) {\n        this.setActiveByColor(item.options.color);\n      }\n    });\n  }\n\n  findItemByColor(color) {\n    color = SheetUtils.blankClear(color);\n    return this.colors.find(item => item.color === color);\n  }\n\n  setActiveByColor(color) {\n    color = SheetUtils.blankClear(color);\n    this.colors.forEach((item) => {\n      if (item.color === color) {\n        item.setActive(true);\n        this.activeColor = item.color;\n      } else {\n        item.setActive(false);\n      }\n    });\n  }\n\n  clear() {\n    this.unbind();\n    this.colors = [];\n    this.empty();\n  }\n\n  destroy() {\n    super.destroy();\n    this.unbind();\n  }\n\n}\n\nColorArray.BLACK = 'rgb(0, 0, 0)';\nColorArray.WHITE = 'rgb(255, 255, 255)';\n\nexport {\n  ColorArray,\n};\n","import { BaseFont } from '../../../draw/font/BaseFont';\nimport { ColorArray } from '../../../module/colorpicker/colorarray/ColorArray';\n\n/**\n *  CellFont\n *  @author jerry\n */\nclass CellFont {\n\n  /**\n   * CellFont\n   * @param align\n   * @param verticalAlign\n   * @param textWrap\n   * @param strikethrough\n   * @param underline\n   * @param color\n   * @param name\n   * @param size\n   * @param bold\n   * @param italic\n   * @param angle\n   * @param direction\n   * @param padding\n   */\n  constructor({\n    align = BaseFont.ALIGN.left,\n    verticalAlign = BaseFont.VERTICAL_ALIGN.center,\n    textWrap = BaseFont.TEXT_WRAP.TRUNCATE,\n    strikethrough = false,\n    underline = false,\n    color = ColorArray.BLACK,\n    name = 'Arial',\n    size = 14,\n    bold = false,\n    italic = false,\n    angle = 0,\n    direction = BaseFont.TEXT_DIRECTION.HORIZONTAL,\n    padding = 5,\n  }) {\n    this.align = align;\n    this.verticalAlign = verticalAlign;\n    this.textWrap = textWrap;\n    this.strikethrough = strikethrough;\n    this.underline = underline;\n    this.color = color;\n    this.name = name;\n    this.size = size;\n    this.bold = bold;\n    this.italic = italic;\n    this.direction = direction;\n    this.angle = angle;\n    this.padding = padding;\n  }\n\n  clone() {\n    const {\n      align,\n      verticalAlign,\n      textWrap,\n      strikethrough,\n      underline,\n      color,\n      name,\n      size,\n      bold,\n      italic,\n      angle,\n      direction,\n      padding,\n    } = this;\n    return new CellFont({\n      align,\n      verticalAlign,\n      textWrap,\n      strikethrough,\n      underline,\n      color,\n      name,\n      size,\n      bold,\n      italic,\n      angle,\n      direction,\n      padding,\n    });\n  }\n\n  reset() {\n    this.align = BaseFont.ALIGN.left;\n    this.verticalAlign = BaseFont.VERTICAL_ALIGN.center;\n    this.textWrap = BaseFont.TEXT_WRAP.TRUNCATE;\n    this.strikethrough = false;\n    this.underline = false;\n    this.color = ColorArray.BLACK;\n    this.name = 'Arial';\n    this.size = 14;\n    this.bold = false;\n    this.italic = false;\n    this.angle = 0;\n    this.direction = BaseFont.TEXT_DIRECTION.HORIZONTAL;\n    this.padding = 5;\n  }\n\n  equals(other) {\n    let keys1 = Object.keys(this);\n    let keys2 = Object.keys(other);\n    if (keys1.length !== keys2.length) {\n      return false;\n    }\n    for (let key of keys1) {\n      if (!keys2.includes(key)) {\n        return false;\n      }\n    }\n    for (let key of keys1) {\n      if (this[key] !== other[key]) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n}\n\nCellFont.scaleAdapter = null;\n\nexport { CellFont };\n","/* global devicePixelRatio */\nimport { SheetUtils } from '../utils/SheetUtils';\n\nlet DPR = SheetUtils.inWorker() ? 1 : devicePixelRatio;\nlet LINE_WIDTH_LOW = Math.round(DPR);\nlet LINE_WIDTH_MEDIUM = LINE_WIDTH_LOW + 2;\nlet LINE_WIDTH_HIGH = LINE_WIDTH_MEDIUM + 2;\nlet LINE_PIXEL_OFFSET = LINE_WIDTH_LOW / 2;\n\nclass Base {\n\n  static srcPx(px) {\n    return px / this.dpr();\n  }\n\n  static cssPx(px) {\n    return this.srcPx(this.stylePx(px));\n  }\n\n  static stylePx(px) {\n    return this.round(px * this.dpr());\n  }\n\n  static round(val) {\n    return Math.round(val);\n  }\n\n  static ceil(val) {\n    return Math.ceil(val);\n  }\n\n  static trunc(val) {\n    return Math.trunc(val);\n  }\n\n  static radian(angle) {\n    return -angle * (Math.PI / 180);\n  }\n\n  static dpr() {\n    return DPR;\n  }\n\n  static refresh(val = 1) {\n    DPR = SheetUtils.inWorker() ? val : devicePixelRatio;\n    LINE_WIDTH_LOW = Math.round(DPR);\n    LINE_WIDTH_MEDIUM = LINE_WIDTH_LOW + 2;\n    LINE_WIDTH_HIGH = LINE_WIDTH_MEDIUM + 2;\n    LINE_PIXEL_OFFSET = LINE_WIDTH_LOW / 2;\n  }\n\n  constructor(canvas) {\n    this.canvas = canvas;\n    this.ctx = canvas.getContext('2d');\n  }\n\n  attr(options) {\n    for (const key in options) {\n      if (options.hasOwnProperty(key)) {\n        let value = options[key];\n        if (typeof value === 'string' || value instanceof String) {\n          value = value.trim();\n        }\n        if (this.ctx[key] !== value) {\n          this.ctx[key] = value;\n        }\n      }\n    }\n    return this;\n  }\n\n  resize(width, height) {\n    const { canvas } = this;\n    canvas.width = Base.stylePx(width);\n    canvas.height = Base.stylePx(height);\n    canvas.style.width = `${canvas.width / Base.dpr()}px`;\n    canvas.style.height = `${canvas.height / Base.dpr()}px`;\n    return this;\n  }\n\n}\n\nclass Wrapping extends Base {\n\n  constructor(canvas) {\n    super(canvas);\n    this.dash = [];\n  }\n\n  beginPath() {\n    const { ctx } = this;\n    ctx.beginPath();\n    return this;\n  }\n\n  measureText(text) {\n    const { ctx } = this;\n    return ctx.measureText(text);\n  }\n\n  save() {\n    const { ctx } = this;\n    ctx.save();\n    return this;\n  }\n\n  restore() {\n    const { ctx } = this;\n    ctx.restore();\n    return this;\n  }\n\n  fill() {\n    const { ctx } = this;\n    ctx.fill();\n    return this;\n  }\n\n  clip() {\n    const { ctx } = this;\n    ctx.clip();\n    return this;\n  }\n\n  setLineDash(dash = []) {\n    const { ctx } = this;\n    this.dash = dash;\n    ctx.setLineDash(dash);\n    return this;\n  }\n\n  scale(x, y) {\n    const { ctx } = this;\n    ctx.scale(x, y);\n    return this;\n  }\n\n  translate(x, y) {\n    const { ctx } = this;\n    ctx.translate(x, y);\n    return this;\n  }\n\n  rotate(deg) {\n    const { ctx } = this;\n    ctx.rotate(deg);\n    return this;\n  }\n\n}\n\nclass Extends extends Wrapping {\n\n  polyStroke(interpolation = xys => xys, ...xys) {\n    const { ctx } = this;\n    if (xys.length > 1) {\n      this.beginPath();\n      const [x, y] = interpolation(xys[0]);\n      ctx.moveTo(x, y);\n      for (let i = 1, len = xys.length; i < len; i += 1) {\n        const [x, y] = interpolation(xys[i]);\n        ctx.lineTo(x, y);\n      }\n      ctx.stroke();\n    }\n  }\n\n  polyInFill(interpolation = xys => xys, ...xys) {\n    const { ctx } = this;\n    if (xys.length > 1) {\n      this.beginPath();\n      const [x, y] = interpolation(xys[0]);\n      ctx.moveTo(x, y);\n      for (let i = 1, len = xys.length; i < len; i += 1) {\n        const [x, y] = interpolation(xys[i]);\n        ctx.lineTo(x, y);\n      }\n      ctx.fill();\n    }\n  }\n\n  fullRect() {\n    const { canvas } = this;\n    const { width, height } = canvas;\n    this.ctx.fillRect(0, 0, width, height);\n    return this;\n  }\n\n  rotate(angle) {\n    super.rotate(Base.radian(angle));\n    return this;\n  }\n\n}\n\nclass Position extends Extends {\n\n  constructor(canvas) {\n    super(canvas);\n    this.offsetX = 0;\n    this.offsetY = 0;\n  }\n\n  offset(x, y) {\n    this.offsetX = x;\n    this.offsetY = y;\n  }\n\n  getOffsetX() {\n    return this.offsetX;\n  }\n\n  getOffsetY() {\n    return this.offsetY;\n  }\n\n  fillText() {\n    throw TypeError('child impl');\n  }\n\n  fillRect() {\n    throw TypeError('child impl');\n  }\n\n  rect() {\n    throw TypeError('child impl');\n  }\n\n  drawImage() {\n    throw TypeError('child impl');\n  }\n\n}\n\nclass BaseLine extends Position {\n\n  line(...xys) {\n    this.polyStroke((xys) => {\n      const [x, y] = xys;\n      return [this.linePx(Base.round(x + this.getOffsetX())),\n        this.linePx(Base.round(y + this.getOffsetY()))];\n    }, ...xys);\n    return this;\n  }\n\n  linePx(pixel) {\n    const { ctx } = this;\n    const {\n      lineWidth,\n    } = ctx;\n    return lineWidth % 2 === 0\n      ? pixel : pixel - 0.5;\n  }\n\n}\n\nclass CorsLine extends BaseLine {\n\n  static offsetToLineInside(val) {\n    return LINE_WIDTH_LOW > 1\n      ? val - LINE_PIXEL_OFFSET\n      : val - LINE_WIDTH_LOW;\n  }\n\n  static getLineWidthTypePx(type) {\n    switch (type) {\n      case CorsLine.LINE_WIDTH_TYPE.medium:\n        return LINE_WIDTH_MEDIUM;\n      case CorsLine.LINE_WIDTH_TYPE.low:\n        return LINE_WIDTH_LOW;\n      case CorsLine.LINE_WIDTH_TYPE.high:\n        return LINE_WIDTH_HIGH;\n    }\n    return 0;\n  }\n\n  constructor(canvas) {\n    super(canvas);\n    this.lineWidthType = CorsLine.LINE_WIDTH_TYPE.low;\n    this.lineColor = 'rgb(0,0,0)';\n  }\n\n  corsLine([sx, sy], [ex, ey]) {\n    const {\n      lineWidthType, lineColor,\n    } = this;\n    let lineWidth = LINE_WIDTH_LOW;\n    switch (lineWidthType) {\n      case CorsLine.LINE_WIDTH_TYPE.medium:\n        lineWidth = LINE_WIDTH_MEDIUM;\n        break;\n      case CorsLine.LINE_WIDTH_TYPE.low:\n        lineWidth = LINE_WIDTH_LOW;\n        break;\n      case CorsLine.LINE_WIDTH_TYPE.high:\n        lineWidth = LINE_WIDTH_HIGH;\n        break;\n    }\n    this.attr({\n      strokeStyle: lineColor,\n      lineWidth,\n    });\n    this.polyStroke((xys) => {\n      const [x, y] = xys;\n      return [\n        Base.round(x + this.getOffsetX()) - LINE_PIXEL_OFFSET,\n        Base.round(y + this.getOffsetY()) - LINE_PIXEL_OFFSET,\n      ];\n    }, [sx, sy], [ex, ey]);\n  }\n\n  setLineColor(color) {\n    this.lineColor = color;\n  }\n\n  setLineWidthType(type) {\n    this.lineWidthType = type;\n  }\n\n  horizonLine([sx, sy], [ex, ey]) {\n    if (sy !== ey) {\n      throw new TypeError('Error Horizon Line');\n    }\n    this.corsLine([sx, sy], [ex, ey]);\n  }\n\n  verticalLine([sx, sy], [ex, ey]) {\n    if (sx !== ex) {\n      throw new TypeError('Error Vertical Line');\n    }\n    this.corsLine([sx, sy], [ex, ey]);\n  }\n\n}\nCorsLine.LINE_WIDTH_TYPE = {\n  low: 'low',\n  medium: 'medium',\n  high: 'high',\n};\n\nclass XDraw extends CorsLine {\n\n  fillText(text, x, y) {\n    x += this.getOffsetX();\n    y += this.getOffsetY();\n    this.ctx.fillText(text, XDraw.round(x), XDraw.round(y));\n    return this;\n  }\n\n  fillPath(path) {\n    this.polyInFill((xys) => {\n      const { x, y } = xys;\n      return [Base.round(x + this.getOffsetX()), Base.round(y + this.getOffsetY())];\n    }, ...path.points);\n    return this;\n  }\n\n  fillRect(x, y, w, h) {\n    x += this.getOffsetX();\n    y += this.getOffsetY();\n    this.ctx.fillRect(XDraw.round(x), XDraw.round(y),\n      XDraw.round(w), XDraw.round(h));\n    return this;\n  }\n\n  rect(x, y, w, h) {\n    x += this.getOffsetX();\n    y += this.getOffsetY();\n    this.ctx.rect(XDraw.round(x), XDraw.round(y),\n      XDraw.round(w), XDraw.round(h));\n    return this;\n  }\n\n  copyImage(sx, sy, sw, sh, tx, ty, tw, th) {\n    const { ctx } = this;\n    tx += this.getOffsetX();\n    sx += this.getOffsetX();\n    ty += this.getOffsetY();\n    sy += this.getOffsetY();\n    ctx.drawImage(this.canvas,\n      XDraw.round(sx), XDraw.round(sy),\n      XDraw.round(sw), XDraw.round(sh),\n      XDraw.round(tx), XDraw.round(ty),\n      XDraw.round(tw), XDraw.round(th));\n    return this;\n  }\n\n  drawImage(el, sx, sy, sw, sh, tx, ty, tw, th) {\n    const { ctx } = this;\n    tx += this.getOffsetX();\n    ty += this.getOffsetY();\n    ctx.drawImage(el,\n      XDraw.round(sx), XDraw.round(sy),\n      XDraw.round(sw), XDraw.round(sh),\n      XDraw.round(tx), XDraw.round(ty),\n      XDraw.round(tw), XDraw.round(th));\n    return this;\n  }\n\n}\n\nexport {\n  XDraw,\n};\n","import { SheetUtils } from '../utils/SheetUtils';\nimport { XDraw } from './XDraw';\n\nconst LINE_TYPE = {\n  SOLID_LINE: 0,\n  DOTTED_LINE: 1,\n  POINT_LINE: 2,\n  DOUBLE_LINE: 3,\n};\n\nclass SolidLine {\n\n  constructor(draw, attr) {\n    this.draw = draw;\n    SheetUtils.copy(this, {\n      color: 'rgb(0,0,0)',\n      widthType: XDraw.LINE_WIDTH_TYPE.low,\n    }, attr);\n  }\n\n  setWidthType(widthType) {\n    this.widthType = widthType;\n  }\n\n  setColor(color) {\n    this.color = color;\n  }\n\n  horizonLine(sx, sy, ex, ey) {\n    const { draw } = this;\n    const {\n      widthType, color,\n    } = this;\n    draw.setLineColor(color);\n    draw.setLineWidthType(widthType);\n    draw.setLineDash([]);\n    draw.horizonLine([sx, sy], [ex, ey]);\n  }\n\n  verticalLine(sx, sy, ex, ey) {\n    const { draw } = this;\n    const {\n      widthType, color,\n    } = this;\n    draw.setLineColor(color);\n    draw.setLineWidthType(widthType);\n    draw.setLineDash([]);\n    draw.verticalLine([sx, sy], [ex, ey]);\n  }\n\n  tiltingLine(sx, sy, ex, ey) {\n    const { draw } = this;\n    const {\n      widthType, color,\n    } = this;\n    draw.setLineColor(color);\n    draw.setLineWidthType(widthType);\n    draw.setLineDash([]);\n    draw.corsLine([sx, sy], [ex, ey]);\n  }\n\n}\n\nclass DottedLine {\n\n  constructor(draw, attr) {\n    this.draw = draw;\n    SheetUtils.copy(this, {\n      color: 'rgb(0,0,0)',\n      widthType: XDraw.LINE_WIDTH_TYPE.low,\n      dash: [5],\n    }, attr);\n  }\n\n  setWidthType(widthType) {\n    this.widthType = widthType;\n  }\n\n  setColor(color) {\n    this.color = color;\n  }\n\n  horizonLine(sx, sy, ex, ey) {\n    const { draw, dash } = this;\n    const {\n      widthType, color,\n    } = this;\n    draw.setLineColor(color);\n    draw.setLineWidthType(widthType);\n    draw.setLineDash(dash);\n    draw.horizonLine([sx, sy], [ex, ey]);\n  }\n\n  verticalLine(sx, sy, ex, ey) {\n    const { draw, dash } = this;\n    const {\n      widthType, color,\n    } = this;\n    draw.setLineColor(color);\n    draw.setLineWidthType(widthType);\n    draw.setLineDash(dash);\n    draw.verticalLine([sx, sy], [ex, ey]);\n  }\n\n  tiltingLine(sx, sy, ex, ey) {\n    const { draw, dash } = this;\n    const {\n      widthType, color,\n    } = this;\n    draw.setLineColor(color);\n    draw.setLineWidthType(widthType);\n    draw.setLineDash(dash);\n    draw.corsLine([sx, sy], [ex, ey]);\n  }\n\n}\n\nclass DoubleLine {\n\n  constructor(draw, attr) {\n    this.draw = draw;\n    SheetUtils.copy(this, {\n      color: 'rgb(0,0,0)',\n      widthType: XDraw.LINE_WIDTH_TYPE.low,\n      padding: 1,\n      spacing: DoubleLine.spacing,\n      leftShow: () => false,\n      topShow: () => false,\n      rightShow: () => false,\n      bottomShow: () => false,\n      iFMerge: () => false,\n      iFMergeFirstRow: () => false,\n      iFMergeLastRow: () => false,\n      iFMergeFirstCol: () => false,\n      iFMergeLastCol: () => false,\n    }, attr);\n  }\n\n  setWidthType(widthType) {\n    this.widthType = widthType;\n  }\n\n  setColor(color) {\n    this.color = color;\n  }\n\n  handleExternal(sx, sy, ex, ey, row, col, pos) {\n    const external = {};\n    const { leftShow, topShow, rightShow, bottomShow } = this;\n    const { iFMerge, iFMergeFirstRow, iFMergeLastRow, iFMergeFirstCol, iFMergeLastCol } = this;\n    const { spacing } = this;\n    let ifMerge = null;\n    let firstRow = null;\n    let lastRow = null;\n    let firstCol = null;\n    let lastCol = null;\n    switch (pos) {\n      case 'left':\n        ifMerge = iFMerge(row, col - 1);\n        if (ifMerge) {\n          firstRow = iFMergeFirstRow(row, col - 1);\n          lastRow = iFMergeLastRow(row, col - 1);\n          firstCol = iFMergeFirstCol(row, col - 1);\n          lastCol = iFMergeLastCol(row, col - 1);\n        }\n        break;\n      case 'top':\n        ifMerge = iFMerge(row - 1, col);\n        if (ifMerge) {\n          firstRow = iFMergeFirstRow(row - 1, col);\n          lastRow = iFMergeLastRow(row - 1, col);\n          firstCol = iFMergeFirstCol(row - 1, col);\n          lastCol = iFMergeLastCol(row - 1, col);\n        }\n        break;\n      case 'right':\n        ifMerge = iFMerge(row, col + 1);\n        if (ifMerge) {\n          firstRow = iFMergeFirstRow(row, col + 1);\n          lastRow = iFMergeLastRow(row, col + 1);\n          firstCol = iFMergeFirstCol(row, col + 1);\n          lastCol = iFMergeLastCol(row, col + 1);\n        }\n        break;\n      case 'bottom':\n        ifMerge = iFMerge(row + 1, col);\n        if (ifMerge) {\n          firstRow = iFMergeFirstRow(row + 1, col);\n          lastRow = iFMergeLastRow(row + 1, col);\n          firstCol = iFMergeFirstCol(row + 1, col);\n          lastCol = iFMergeLastCol(row + 1, col);\n        }\n        break;\n      default: break;\n    }\n    if (ifMerge) {\n      switch (pos) {\n        case 'left': {\n          external.sx = sx - spacing;\n          external.ex = ex - spacing;\n          // \n          const sTopLeftCorner = bottomShow(row - 1, col - 1) || topShow(row, col - 1);\n          const sTop = topShow(row, col);\n          const sBottom = bottomShow(row - 1, col);\n          external.sy = sy;\n          if (sTop || sBottom) external.sy = sy - spacing;\n          if (sTopLeftCorner && firstRow) external.sy = sy + spacing;\n          // \n          const eBottomLeftCorner = topShow(row + 1, col - 1) || bottomShow(row, col - 1);\n          const eBottom = bottomShow(row, col);\n          const eTop = topShow(row + 1, col);\n          external.ey = ey;\n          if (eBottom || eTop) external.ey = ey + spacing;\n          if (eBottomLeftCorner && lastRow) external.ey = ey - spacing;\n          break;\n        }\n        case 'top': {\n          external.sy = sy - spacing;\n          external.ey = ey - spacing;\n          // \n          const sTopLeftCorner = rightShow(row - 1, col - 1) || leftShow(row - 1, col);\n          const sLeft = leftShow(row, col);\n          const sRight = rightShow(row, col - 1);\n          external.sx = sx;\n          if (sLeft || sRight) external.sx = sx - spacing;\n          if (sTopLeftCorner && firstCol) external.sx = sx + spacing;\n          // \n          const eTopRightCorner = leftShow(row - 1, col + 1) || rightShow(row - 1, col);\n          const eRight = rightShow(row, col);\n          const eLeft = leftShow(row, col + 1);\n          external.ex = ex;\n          if (eRight || eLeft) external.ex = ex + spacing;\n          if (eTopRightCorner && lastCol) external.ex = ex - spacing;\n          break;\n        }\n        case 'right': {\n          external.sx = sx + spacing;\n          external.ex = ex + spacing;\n          // \n          const sTopRightCorner = bottomShow(row - 1, col + 1) || topShow(row, col + 1);\n          const sTop = topShow(row, col);\n          const sBottom = bottomShow(row - 1, col);\n          external.sy = sy;\n          if (sTop || sBottom) external.sy = sy - spacing;\n          if (sTopRightCorner && firstRow) external.sy = sy + spacing;\n          // \n          const eBottomRightCorner = topShow(row + 1, col + 1) || bottomShow(row, col + 1);\n          const eBottom = bottomShow(row, col);\n          const eTop = topShow(row + 1, col);\n          external.ey = ey;\n          if (eBottom || eTop) external.ey = ey + spacing;\n          if (eBottomRightCorner && lastRow) external.ey = ey - spacing;\n          break;\n        }\n        case 'bottom': {\n          external.sy = sy + spacing;\n          external.ey = ey + spacing;\n          // \n          const sBottomLeftCorner = rightShow(row + 1, col - 1) || leftShow(row + 1, col);\n          const sLeft = leftShow(row, col);\n          const sRight = rightShow(row, col - 1);\n          external.sx = sx;\n          if (sLeft || sRight) external.sx = sx - spacing;\n          if (sBottomLeftCorner && firstCol) external.sx = sx + spacing;\n          // \n          const eBottomRightCorner = leftShow(row + 1, col + 1) || rightShow(row + 1, col);\n          const eRight = rightShow(row, col);\n          const eLeft = leftShow(row, col + 1);\n          external.ex = ex;\n          if (eRight || eLeft) external.ex = ex + spacing;\n          if (eBottomRightCorner && lastCol) external.ex = ex - spacing;\n          break;\n        }\n        default: break;\n      }\n      return external;\n    }\n    switch (pos) {\n      case 'left': {\n        external.sx = sx - spacing;\n        external.ex = ex - spacing;\n        // \n        const sTopLeftCorner = bottomShow(row - 1, col - 1) || topShow(row, col - 1);\n        const sTop = topShow(row, col);\n        const sBottom = bottomShow(row - 1, col);\n        external.sy = sy;\n        if (sTop || sBottom) external.sy = sy - spacing;\n        if (sTopLeftCorner) external.sy = sy + spacing;\n        // \n        const eBottomLeftCorner = topShow(row + 1, col - 1) || bottomShow(row, col - 1);\n        const eBottom = bottomShow(row, col);\n        const eTop = topShow(row + 1, col);\n        external.ey = ey;\n        if (eBottom || eTop) external.ey = ey + spacing;\n        if (eBottomLeftCorner) external.ey = ey - spacing;\n        break;\n      }\n      case 'top': {\n        external.sy = sy - spacing;\n        external.ey = ey - spacing;\n        // \n        const sTopLeftCorner = rightShow(row - 1, col - 1) || leftShow(row - 1, col);\n        const sLeft = leftShow(row, col);\n        const sRight = rightShow(row, col - 1);\n        external.sx = sx;\n        if (sLeft || sRight) external.sx = sx - spacing;\n        if (sTopLeftCorner) external.sx = sx + spacing;\n        // \n        const eTopRightCorner = leftShow(row - 1, col + 1) || rightShow(row - 1, col);\n        const eRight = rightShow(row, col);\n        const eLeft = leftShow(row, col + 1);\n        external.ex = ex;\n        if (eRight || eLeft) external.ex = ex + spacing;\n        if (eTopRightCorner) external.ex = ex - spacing;\n        break;\n      }\n      case 'right': {\n        external.sx = sx + spacing;\n        external.ex = ex + spacing;\n        // \n        const sTopRightCorner = bottomShow(row - 1, col + 1) || topShow(row, col + 1);\n        const sTop = topShow(row, col);\n        const sBottom = bottomShow(row - 1, col);\n        external.sy = sy;\n        if (sTop || sBottom) external.sy = sy - spacing;\n        if (sTopRightCorner) external.sy = sy + spacing;\n        // \n        const eBottomRightCorner = topShow(row + 1, col + 1) || bottomShow(row, col + 1);\n        const eBottom = bottomShow(row, col);\n        const eTop = topShow(row + 1, col);\n        external.ey = ey;\n        if (eBottom || eTop) external.ey = ey + spacing;\n        if (eBottomRightCorner) external.ey = ey - spacing;\n        break;\n      }\n      case 'bottom': {\n        external.sy = sy + spacing;\n        external.ey = ey + spacing;\n        // \n        const sBottomLeftCorner = rightShow(row + 1, col - 1) || leftShow(row + 1, col);\n        const sLeft = leftShow(row, col);\n        const sRight = rightShow(row, col - 1);\n        external.sx = sx;\n        if (sLeft || sRight) external.sx = sx - spacing;\n        if (sBottomLeftCorner) external.sx = sx + spacing;\n        // \n        const eBottomRightCorner = leftShow(row + 1, col + 1) || rightShow(row + 1, col);\n        const eRight = rightShow(row, col);\n        const eLeft = leftShow(row, col + 1);\n        external.ex = ex;\n        if (eRight || eLeft) external.ex = ex + spacing;\n        if (eBottomRightCorner) external.ex = ex - spacing;\n        break;\n      }\n      default: break;\n    }\n    return external;\n  }\n\n  handleInternal(sx, sy, ex, ey, row, col, pos) {\n    const internal = {};\n    const { leftShow, topShow, rightShow, bottomShow } = this;\n    const { iFMerge, iFMergeFirstRow, iFMergeLastRow, iFMergeFirstCol, iFMergeLastCol } = this;\n    const { spacing } = this;\n    const ifMerge = iFMerge(row, col);\n    // merge\n    if (ifMerge) {\n      const firstRow = iFMergeFirstRow(row, col);\n      const lastRow = iFMergeLastRow(row, col);\n      const firstCol = iFMergeFirstCol(row, col);\n      const lastCol = iFMergeLastCol(row, col);\n      switch (pos) {\n        case 'left': {\n          internal.sx = sx + spacing;\n          internal.ex = ex + spacing;\n          // \n          const sTopLeftCorner = bottomShow(row - 1, col - 1) || topShow(row, col - 1);\n          const sTop = topShow(row, col);\n          const sBottom = bottomShow(row - 1, col);\n          internal.sy = sy;\n          if (sTopLeftCorner) internal.sy = sy - spacing;\n          if ((sTop || sBottom) && firstRow) internal.sy = sy + spacing;\n          // \n          const eBottomLeftCorner = topShow(row + 1, col - 1) || bottomShow(row, col - 1);\n          const eBottom = bottomShow(row, col);\n          const eTop = topShow(row + 1, col);\n          internal.ey = ey;\n          if (eBottomLeftCorner) internal.ey = ey + spacing;\n          if ((eBottom || eTop) && lastRow) internal.ey = ey - spacing;\n          break;\n        }\n        case 'top': {\n          internal.sy = sy + spacing;\n          internal.ey = ey + spacing;\n          // \n          const sTopLeftCorner = rightShow(row - 1, col - 1) || leftShow(row - 1, col);\n          const sLeft = leftShow(row, col);\n          const sRight = rightShow(row, col - 1);\n          internal.sx = sx;\n          if (sTopLeftCorner) internal.sx = sx - spacing;\n          if ((sLeft || sRight) && firstCol) internal.sx = sx + spacing;\n          // \n          const eTopRightCorner = leftShow(row - 1, col + 1) || rightShow(row - 1, col);\n          const eRight = rightShow(row, col);\n          const eLeft = leftShow(row, col + 1);\n          internal.ex = ex;\n          if (eTopRightCorner) internal.ex = ex + spacing;\n          if ((eRight || eLeft) && lastCol) internal.ex = ex - spacing;\n          break;\n        }\n        case 'right': {\n          internal.sx = sx - spacing;\n          internal.ex = ex - spacing;\n          // \n          const sTopRightCorner = bottomShow(row - 1, col + 1) || topShow(row, col + 1);\n          const sTop = topShow(row, col);\n          const sBottom = bottomShow(row - 1, col);\n          internal.sy = sy;\n          if (sTopRightCorner) internal.sy = sy - spacing;\n          if ((sTop || sBottom) && firstRow) internal.sy = sy + spacing;\n          // \n          const eBottomRightCorner = topShow(row + 1, col + 1) || bottomShow(row, col + 1);\n          const eBottom = bottomShow(row, col);\n          const eTop = topShow(row + 1, col);\n          internal.ey = ey;\n          if (eBottomRightCorner) internal.ey = ey + spacing;\n          if ((eBottom || eTop) && lastRow) internal.ey = ey - spacing;\n          break;\n        }\n        case 'bottom': {\n          internal.sy = sy - spacing;\n          internal.ey = ey - spacing;\n          // \n          const sBottomLeftCorner = rightShow(row + 1, col - 1) || leftShow(row + 1, col);\n          const sLeft = leftShow(row, col);\n          const sRight = rightShow(row, col - 1);\n          internal.sx = sx;\n          if (sBottomLeftCorner) internal.sx = sx - spacing;\n          if ((sLeft || sRight) && firstCol) internal.sx = sx + spacing;\n          // \n          const eBottomRightCorner = leftShow(row + 1, col + 1) || rightShow(row + 1, col);\n          const eRight = rightShow(row, col);\n          const eLeft = leftShow(row, col + 1);\n          internal.ex = ex;\n          if (eBottomRightCorner) internal.ex = ex + spacing;\n          if ((eRight || eLeft) && lastCol) internal.ex = ex - spacing;\n          break;\n        }\n        default: break;\n      }\n      return internal;\n    }\n    switch (pos) {\n      case 'left': {\n        internal.sx = sx + spacing;\n        internal.ex = ex + spacing;\n        // \n        const sTopLeftCorner = bottomShow(row - 1, col - 1) || topShow(row, col - 1);\n        const sTop = topShow(row, col);\n        const sBottom = bottomShow(row - 1, col);\n        internal.sy = sy;\n        if (sTopLeftCorner) internal.sy = sy - spacing;\n        if (sTop || sBottom) internal.sy = sy + spacing;\n        // \n        const eBottomLeftCorner = topShow(row + 1, col - 1) || bottomShow(row, col - 1);\n        const eBottom = bottomShow(row, col);\n        const eTop = topShow(row + 1, col);\n        internal.ey = ey;\n        if (eBottomLeftCorner) internal.ey = ey + spacing;\n        if (eBottom || eTop) internal.ey = ey - spacing;\n        break;\n      }\n      case 'top': {\n        internal.sy = sy + spacing;\n        internal.ey = ey + spacing;\n        // \n        const sTopLeftCorner = rightShow(row - 1, col - 1) || leftShow(row - 1, col);\n        const sLeft = leftShow(row, col);\n        const sRight = rightShow(row, col - 1);\n        internal.sx = sx;\n        if (sTopLeftCorner) internal.sx = sx - spacing;\n        if (sLeft || sRight) internal.sx = sx + spacing;\n        // \n        const eTopRightCorner = leftShow(row - 1, col + 1) || rightShow(row - 1, col);\n        const eRight = rightShow(row, col);\n        const eLeft = leftShow(row, col + 1);\n        internal.ex = ex;\n        if (eTopRightCorner) internal.ex = ex + spacing;\n        if (eRight || eLeft) internal.ex = ex - spacing;\n        break;\n      }\n      case 'right': {\n        internal.sx = sx - spacing;\n        internal.ex = ex - spacing;\n        // \n        const sTopRightCorner = bottomShow(row - 1, col + 1) || topShow(row, col + 1);\n        const sTop = topShow(row, col);\n        const sBottom = bottomShow(row - 1, col);\n        internal.sy = sy;\n        if (sTopRightCorner) internal.sy = sy - spacing;\n        if (sTop || sBottom) internal.sy = sy + spacing;\n        // \n        const eBottomRightCorner = topShow(row + 1, col + 1) || bottomShow(row, col + 1);\n        const eBottom = bottomShow(row, col);\n        const eTop = topShow(row + 1, col);\n        internal.ey = ey;\n        if (eBottomRightCorner) internal.ey = ey + spacing;\n        if (eBottom || eTop) internal.ey = ey - spacing;\n        break;\n      }\n      case 'bottom': {\n        internal.sy = sy - spacing;\n        internal.ey = ey - spacing;\n        // \n        const sBottomLeftCorner = rightShow(row + 1, col - 1) || leftShow(row + 1, col);\n        const sLeft = leftShow(row, col);\n        const sRight = rightShow(row, col - 1);\n        internal.sx = sx;\n        if (sBottomLeftCorner) internal.sx = sx - spacing;\n        if (sLeft || sRight) internal.sx = sx + spacing;\n        // \n        const eBottomRightCorner = leftShow(row + 1, col + 1) || rightShow(row + 1, col);\n        const eRight = rightShow(row, col);\n        const eLeft = leftShow(row, col + 1);\n        internal.ex = ex;\n        if (eBottomRightCorner) internal.ex = ex + spacing;\n        if (eRight || eLeft) internal.ex = ex - spacing;\n        break;\n      }\n      default: break;\n    }\n    return internal;\n  }\n\n  horizonLine(sx, sy, ex, ey, row, col, pos) {\n    const { draw } = this;\n    const {\n      widthType, color,\n    } = this;\n    draw.setLineColor(color);\n    draw.setLineWidthType(widthType);\n    draw.setLineDash([]);\n    const external = this.handleExternal(sx, sy, ex, ey, row, col, pos);\n    const internal = this.handleInternal(sx, sy, ex, ey, row, col, pos);\n    if (!SheetUtils.isEmptyObject(internal)) {\n      draw.horizonLine([internal.sx, internal.sy], [internal.ex, internal.ey]);\n    }\n    if (!SheetUtils.isEmptyObject(external)) {\n      draw.horizonLine([external.sx, external.sy], [external.ex, external.ey]);\n    }\n  }\n\n  verticalLine(sx, sy, ex, ey, row, col, pos) {\n    const { draw } = this;\n    const {\n      widthType, color,\n    } = this;\n    draw.setLineColor(color);\n    draw.setLineWidthType(widthType);\n    draw.setLineDash([]);\n    const external = this.handleExternal(sx, sy, ex, ey, row, col, pos);\n    const internal = this.handleInternal(sx, sy, ex, ey, row, col, pos);\n    if (!SheetUtils.isEmptyObject(internal)) {\n      draw.verticalLine([internal.sx, internal.sy], [internal.ex, internal.ey]);\n    }\n    if (!SheetUtils.isEmptyObject(external)) {\n      draw.verticalLine([external.sx, external.sy], [external.ex, external.ey]);\n    }\n  }\n\n  // eslint-disable-next-line no-unused-vars\n  tiltingLine(sx, sy, ex, ey, row, col, pos) {\n    // TODO ..\n    // ...\n  }\n\n}\nDoubleLine.spacing = XDraw.dpr() >= 2 ? 3 : 2;\n\nclass Line {\n\n  constructor(draw, attr = {}) {\n    this.widthType = XDraw.LINE_WIDTH_TYPE.low;\n    this.type = LINE_TYPE.SOLID_LINE;\n    this.solidLine = new SolidLine(draw, SheetUtils.copy({}, attr));\n    this.dottedLine = new DottedLine(draw, SheetUtils.copy({\n      dash: [5],\n    }, attr));\n    this.pointLine = new DottedLine(draw, SheetUtils.copy({\n      dash: [2, 2],\n    }, attr));\n    this.doubleLine = new DoubleLine(draw, SheetUtils.copy({}, attr));\n  }\n\n  setWidthType(widthType) {\n    if (widthType) {\n      if (this.type === LINE_TYPE.SOLID_LINE) {\n        this.solidLine.setWidthType(widthType);\n      }\n    }\n  }\n\n  setColor(color) {\n    if (color) {\n      this.solidLine.setColor(color);\n      this.dottedLine.setColor(color);\n      this.pointLine.setColor(color);\n      this.doubleLine.setColor(color);\n    }\n  }\n\n  setType(type) {\n    this.type = type;\n  }\n\n  horizonLine(sx, sy, ex, ey, row, col, pos) {\n    const {\n      type,\n      solidLine,\n      dottedLine,\n      pointLine,\n      doubleLine,\n    } = this;\n    switch (type) {\n      case LINE_TYPE.SOLID_LINE:\n        solidLine.horizonLine(sx, sy, ex, ey);\n        break;\n      case LINE_TYPE.DOTTED_LINE:\n        dottedLine.horizonLine(sx, sy, ex, ey);\n        break;\n      case LINE_TYPE.POINT_LINE:\n        pointLine.horizonLine(sx, sy, ex, ey);\n        break;\n      case LINE_TYPE.DOUBLE_LINE:\n        doubleLine.horizonLine(sx, sy, ex, ey, row, col, pos);\n        break;\n    }\n  }\n\n  verticalLine(sx, sy, ex, ey, row, col, pos) {\n    const {\n      type,\n      solidLine,\n      dottedLine,\n      pointLine,\n      doubleLine,\n    } = this;\n    switch (type) {\n      case LINE_TYPE.SOLID_LINE:\n        solidLine.verticalLine(sx, sy, ex, ey);\n        break;\n      case LINE_TYPE.DOTTED_LINE:\n        dottedLine.verticalLine(sx, sy, ex, ey);\n        break;\n      case LINE_TYPE.POINT_LINE:\n        pointLine.verticalLine(sx, sy, ex, ey);\n        break;\n      case LINE_TYPE.DOUBLE_LINE:\n        doubleLine.verticalLine(sx, sy, ex, ey, row, col, pos);\n        break;\n    }\n  }\n\n  tiltingLine(sx, sy, ex, ey, row, col, pos) {\n    const {\n      type,\n      solidLine,\n      dottedLine,\n      pointLine,\n      doubleLine,\n    } = this;\n    switch (type) {\n      case LINE_TYPE.SOLID_LINE:\n        solidLine.tiltingLine(sx, sy, ex, ey);\n        break;\n      case LINE_TYPE.DOTTED_LINE:\n        dottedLine.tiltingLine(sx, sy, ex, ey);\n        break;\n      case LINE_TYPE.POINT_LINE:\n        pointLine.tiltingLine(sx, sy, ex, ey);\n        break;\n      case LINE_TYPE.DOUBLE_LINE:\n        doubleLine.tiltingLine(sx, sy, ex, ey, row, col, pos);\n        break;\n    }\n  }\n\n}\n\nexport {\n  Line, LINE_TYPE, SolidLine,\n};\n","import { LINE_TYPE } from '../../../draw/Line';\nimport { SheetUtils } from '../../../utils/SheetUtils';\nimport { XDraw } from '../../../draw/XDraw';\n\nlet zIndexID = 0;\n\n/**\n * Border\n * @author jerry\n */\nclass Border {\n\n  static getZIndex() {\n    zIndexID += 1;\n    return zIndexID;\n  }\n\n  /**\n   * Border\n   * @param widthType\n   * @param width\n   * @param color\n   * @param zIndex\n   * @param display\n   * @param type\n   */\n  constructor({\n    widthType = XDraw.LINE_WIDTH_TYPE.low,\n    width = -1,\n    color = 'rgb(0,0,0)',\n    zIndex = 0,\n    display = false,\n    type = LINE_TYPE.SOLID_LINE,\n  }) {\n    this.zIndex = zIndex;\n    this.display = display;\n    this.color = color;\n    this.type = type;\n    if (width === 1) {\n      this.widthType = XDraw.LINE_WIDTH_TYPE.low;\n    } else if (width === 2) {\n      this.widthType = XDraw.LINE_WIDTH_TYPE.medium;\n    } else if (width === 3) {\n      this.widthType = XDraw.LINE_WIDTH_TYPE.high;\n    } else {\n      this.widthType = widthType;\n    }\n    if (zIndex > zIndexID) {\n      zIndexID = zIndex;\n    }\n  }\n\n  setWidthType(value) {\n    this.zIndex = Border.getZIndex();\n    this.widthType = value;\n  }\n\n  setColor(value) {\n    this.zIndex = Border.getZIndex();\n    this.color = value;\n  }\n\n  setDisplay(value) {\n    this.zIndex = Border.getZIndex();\n    this.display = value;\n  }\n\n  setType(value) {\n    this.zIndex = Border.getZIndex();\n    this.type = value;\n  }\n\n  setZIndex(value) {\n    this.zIndex = value;\n  }\n\n  priority(border) {\n    if (SheetUtils.isUnDef(border)) {\n      return -2;\n    }\n    const origin = this.zIndex;\n    const target = border.zIndex;\n    if (origin > target) {\n      return 1;\n    }\n    if (target > origin) {\n      return -1;\n    }\n    return 0;\n  }\n\n  clone() {\n    return new Border({\n      widthType: this.widthType,\n      color: this.color,\n      zIndex: this.zIndex,\n      type: this.type,\n      display: this.display,\n    });\n  }\n\n  equal(target) {\n    const widthType = this.widthType === target.widthType;\n    const color = this.color === target.color;\n    const type = this.type === target.type;\n    return color && widthType && type;\n  }\n\n}\n\nexport { Border };\n","import { Border } from './Border';\nimport { LINE_TYPE } from '../../../draw/Line';\n\n/**\n * CellBorder\n * @author jerry\n */\nclass CellBorder {\n\n  /**\n   * CellBorder\n   * @param time\n   * @param left\n   * @param top\n   * @param right\n   * @param bottom\n   */\n  constructor({\n    left = {},\n    bottom = {},\n    top = {},\n    right = {},\n  }) {\n    this.left = new Border(left);\n    this.bottom = new Border(bottom);\n    this.top = new Border(top);\n    this.right = new Border(right);\n  }\n\n  hasDouble() {\n    const { top, left, right, bottom } = this;\n    if (top.type === LINE_TYPE.DOUBLE_LINE) {\n      return true;\n    }\n    if (left.type === LINE_TYPE.DOUBLE_LINE) {\n      return true;\n    }\n    if (right.type === LINE_TYPE.DOUBLE_LINE) {\n      return true;\n    }\n    return bottom.type === LINE_TYPE.DOUBLE_LINE;\n  }\n\n  isDisplay() {\n    return this.left.display || this.top.display\n      || this.bottom.display || this.right.display;\n  }\n\n  setAllDisplay(display) {\n    this.setBDisplay(display);\n    this.setLDisplay(display);\n    this.setTDisplay(display);\n    this.setRDisplay(display);\n  }\n\n  setLDisplay(display) {\n    this.left.setDisplay(display);\n  }\n\n  setTDisplay(display) {\n    this.top.setDisplay(display);\n  }\n\n  setRDisplay(display) {\n    this.right.setDisplay(display);\n  }\n\n  setBDisplay(display) {\n    this.bottom.setDisplay(display);\n  }\n\n  setAllColor(color) {\n    this.setBColor(color);\n    this.setLColor(color);\n    this.setTColor(color);\n    this.setRColor(color);\n  }\n\n  setLColor(color) {\n    this.left.setColor(color);\n  }\n\n  setTColor(color) {\n    this.top.setColor(color);\n  }\n\n  setRColor(color) {\n    this.right.setColor(color);\n  }\n\n  setBColor(color) {\n    this.bottom.setColor(color);\n  }\n\n  setAllWidthType(widthType) {\n    this.setBWidthType(widthType);\n    this.setLWidthType(widthType);\n    this.setTWidthType(widthType);\n    this.setRWidthType(widthType);\n  }\n\n  setLWidthType(widthType) {\n    this.left.setWidthType(widthType);\n  }\n\n  setTWidthType(widthType) {\n    this.top.setWidthType(widthType);\n  }\n\n  setRWidthType(widthType) {\n    this.right.setWidthType(widthType);\n  }\n\n  setBWidthType(widthType) {\n    this.bottom.setWidthType(widthType);\n  }\n\n  setAllType(type) {\n    this.setBType(type);\n    this.setLType(type);\n    this.setTType(type);\n    this.setRType(type);\n  }\n\n  setLType(type) {\n    this.left.setType(type);\n  }\n\n  setTType(type) {\n    this.top.setType(type);\n  }\n\n  setRType(type) {\n    this.right.setType(type);\n  }\n\n  setBType(type) {\n    this.bottom.setType(type);\n  }\n\n  updateMaxIndex() {\n    const zIndex = Border.getZIndex();\n    this.left.setZIndex(zIndex);\n    this.bottom.setZIndex(zIndex);\n    this.top.setZIndex(zIndex);\n    this.right.setZIndex(zIndex);\n  }\n\n  clone() {\n    const { left, top, right, bottom } = this;\n    return new CellBorder({\n      left: left.clone(),\n      top: top.clone(),\n      right: right.clone(),\n      bottom: bottom.clone(),\n    });\n  }\n\n}\n\nexport { CellBorder };\n","class Rect {\n\n  /**\n   * Rect\n   * @param x\n   * @param y\n   * @param width\n   * @param height\n   */\n  constructor({\n    x, y, width, height,\n  }) {\n    this.x = x;\n    this.y = y;\n    this.width = width;\n    this.height = height;\n  }\n\n  /**\n   * \n   * @param {Rect} other \n   * @returns {boolean}\n   */\n  disjoint(other) {\n    return this.x > other.x + other.width\n      || this.y > this.y + other.height\n      || other.x > this.x + this.width\n      || other.y > this.y + this.height;\n  }\n\n  /**\n   * \n   * @param size\n   * @returns {Rect}\n   */\n  expandSize(size) {\n    this.width += size;\n    this.height += size;\n    return this;\n  }\n\n  /**\n   * \n   * @param x\n   * @param y\n   * @returns {boolean}\n   */\n  includePoint(x, y) {\n    return x >= this.x && x <= this.x + this.width\n      && y >= this.y && y <= this.y + this.height;\n  }\n\n  /**\n   * \n   * @param rect\n   * @returns {boolean|boolean}\n   */\n  includeRect(rect) {\n    const { x, y, width, height } = rect;\n    return this.x <= x && this.x + this.width >= x + width\n      && this.y <= y && this.y + this.height >= y + height;\n  }\n\n  /**\n   * \n   * @param rect\n   * @returns {Rect}\n   */\n  inRectPosition(rect) {\n    return new Rect({\n      x: this.x - rect.x,\n      y: this.y - rect.y,\n      width: this.width,\n      height: this.height,\n    });\n  }\n\n  /**\n   * \n   * @returns {Rect}\n   */\n  clone() {\n    const { x, y, width, height } = this;\n    return new Rect({ x, y, width, height });\n  }\n\n}\n\nexport { Rect };\n","\n/**\n * XIconOffset\n */\nclass XIconOffset {\n\n  /**\n   * XIconOffset\n   * @param x\n   * @param y\n   */\n  constructor({ x = 0, y = 0 } = {}) {\n    this.x = x;\n    this.y = y;\n  }\n\n}\n\nexport {\n  XIconOffset,\n};\n","class Crop {\n\n  constructor({\n    rect, draw, offset = 0,\n  }) {\n    this.rect = rect;\n    this.draw = draw;\n    this.offset = offset;\n  }\n\n  open() {\n    const {\n      rect, draw, offset,\n    } = this;\n    const {\n      x, y, width, height,\n    } = rect;\n    draw.save()\n      .rect(x, y, width + offset, height + offset)\n      .clip()\n      .beginPath();\n    return this;\n  }\n\n  close() {\n    const { draw } = this;\n    draw.restore();\n    return this;\n  }\n\n}\n\nexport { Crop };\n","/* global Image console */\nimport { SheetUtils } from '../../../utils/SheetUtils';\nimport { XDraw } from '../../../draw/XDraw';\nimport { Rect } from '../../../draw/Rect';\nimport { XIconOffset } from './XIconOffset';\nimport { Crop } from '../../../draw/Crop';\n\n/**\n * XIcon\n * @author jerry\n * @date 2020/10/20\n */\nclass XIcon {\n\n  /**\n   * \n   * @param icons\n   * @returns {[]}\n   */\n  static newInstances(icons = []) {\n    const instances = [];\n    for (let i = 0; i < icons.length; i += 1) {\n      const icon = icons[i];\n      instances.push(new XIcon(icon));\n    }\n    return instances;\n  }\n\n  /**\n   * XIcon\n   * @param vertical\n   * @param horizontal\n   * @param type\n   * @param image\n   * @param focus\n   * @param height\n   * @param width\n   * @param color\n   * @param offset\n   * @param onDraw\n   * @param onLeave\n   * @param onMove\n   * @param onDown\n   * @param onEnter\n   */\n  constructor({\n    vertical = XIcon.ICON_VERTICAL.CENTER,\n    horizontal = XIcon.ICON_HORIZONTAL.RIGHT,\n    type = XIcon.ICON_TYPE.image,\n    image = SheetUtils.Nul,\n    iconFocus = null,\n    height = 16,\n    width = 16,\n    color = 'rgb(255,255,255)',\n    offset = { x: 0, y: 0 },\n    onDraw = () => {},\n    onLeave = () => {},\n    onMove = () => {},\n    onDown = () => {},\n    onEnter = () => {},\n  }) {\n    this.vertical = vertical;\n    this.horizontal = horizontal;\n    this.width = width;\n    this.height = height;\n    this.type = type;\n    this.image = image;\n    this.color = color;\n    this.iconFocus = iconFocus;\n    this.offset = new XIconOffset(offset);\n    this.onLeave = onLeave;\n    this.onMove = onMove;\n    this.onDraw = onDraw;\n    this.onDown = onDown;\n    this.onEnter = onEnter;\n    this.rect = null;\n  }\n\n  /**\n   * \n   * @param rect\n   * @returns {{x: number, y: number}}\n   */\n  position(rect) {\n    // \n    const iconHorizontal = this.horizontal;\n    const iconVertical = this.vertical;\n    const iconOffsetX = XDraw.stylePx(this.offset.x);\n    const iconOffsetY = XDraw.stylePx(this.offset.y);\n    const iconWidth = XDraw.stylePx(this.width);\n    const iconHeight = XDraw.stylePx(this.height);\n    // \n    const rectX = rect.x;\n    const rectY = rect.y;\n    const rectWidth = rect.width;\n    const rectHeight = rect.height;\n    // \n    let px = 0;\n    let py = 0;\n    switch (iconHorizontal) {\n      case XIcon.ICON_HORIZONTAL.CENTER:\n        px = (rectX + rectWidth / 2) - (iconWidth / 2);\n        break;\n      case XIcon.ICON_HORIZONTAL.LEFT:\n        px = rectX;\n        break;\n      case XIcon.ICON_HORIZONTAL.RIGHT:\n        px = rectX + rectWidth - iconWidth;\n        break;\n    }\n    switch (iconVertical) {\n      case XIcon.ICON_VERTICAL.CENTER:\n        py = (rectY + rectHeight / 2) - (iconHeight / 2);\n        break;\n      case XIcon.ICON_VERTICAL.TOP:\n        py = rectY;\n        break;\n      case XIcon.ICON_VERTICAL.BOTTOM:\n        py = rectY + rectHeight - iconHeight;\n        break;\n    }\n    px += iconOffsetX;\n    py += iconOffsetY;\n    return new Rect({\n      x: px, y: py, width: iconWidth, height: iconHeight,\n    });\n  }\n\n  /**\n   * \n   * @param async\n   * @param sync\n   */\n  loadImage({\n    load, sync,\n  }) {\n    const { image, type } = this;\n    switch (type) {\n      case XIcon.ICON_TYPE.image:\n        if (image instanceof Image) {\n          sync(image);\n        } else {\n          const loadImg = new Image();\n          loadImg.src = image;\n          if (loadImg.complete) {\n            this.image = loadImg;\n            sync(this.image);\n          } else {\n            loadImg.onload = () => {\n              this.image = loadImg;\n              load(loadImg);\n            };\n            loadImg.onerror = () => {\n              // eslint-disable-next-line no-console\n              console.error(`${image}`);\n            };\n          }\n        }\n        break;\n      case XIcon.ICON_TYPE.draw:\n        sync();\n        break;\n    }\n  }\n\n  /**\n   * \n   * @param rect\n   * @param draw\n   */\n  drawIcon({\n    rect, draw,\n  }) {\n    const { type } = this;\n    this.rect = rect;\n    switch (type) {\n      case XIcon.ICON_TYPE.image:\n        this.drawImage({\n          rect, draw,\n        });\n        break;\n      case XIcon.ICON_TYPE.draw:\n        this.drawCustom({\n          rect, draw,\n        });\n        break;\n    }\n  }\n\n  /**\n   * \n   * @param rect\n   * @param icon\n   * @param draw\n   */\n  drawCustom({\n    rect, draw,\n  }) {\n    this.onDraw({\n      rect, draw,\n    });\n  }\n\n  /**\n   * \n   * @param rect\n   * @param icon\n   * @param draw\n   */\n  drawImage({\n    rect, draw,\n  }) {\n    const image = this.image;\n    const color = this.color;\n    const positionRect = this.position(rect);\n    const {\n      x, y, width, height,\n    } = positionRect;\n    const include = rect.includeRect(positionRect);\n    const crop = new Crop({\n      rect, draw,\n    });\n    if (include === false) {\n      crop.open();\n    }\n    if (color) {\n      draw.attr({ fillStyle: color });\n      draw.fillRect(x, y, width, height);\n    }\n    draw.drawImage(image, 0, 0, image.width, image.height, x, y, width, height);\n    if (include === false) {\n      crop.close();\n    }\n  }\n\n  /**\n   * \n   * @param type\n   * @param x\n   * @param y\n   * @param native\n   */\n  eventHandle({\n    type, x, y, native,\n  }) {\n    const { rect, iconFocus } = this;\n    if (rect) {\n      const position = this.position(rect);\n      const location = position.inRectPosition(rect);\n      const { activate } = iconFocus;\n      switch (type) {\n        case XIcon.ICON_EVENT_TYPE.MOUSE_DOWN:\n          if (location.includePoint(x, y)) {\n            iconFocus.setActivate(this);\n            this.onDown({\n              native, position,\n            });\n          }\n          break;\n        case XIcon.ICON_EVENT_TYPE.MOUSE_MOVE:\n          if (location.includePoint(x, y)) {\n            if (activate !== this) {\n              this.onEnter({\n                native, position,\n              });\n            }\n            iconFocus.setActivate(this);\n            this.onMove({\n              native, position,\n            });\n          } else if (activate) {\n            iconFocus.setActivate(null);\n            this.onLeave({\n              native, position,\n            });\n          }\n          break;\n      }\n    }\n  }\n\n  /**\n   * \n   * @param callback\n   */\n  setOnDraw(callback) {\n    this.onDraw = callback;\n  }\n\n  /**\n   * \n   * @param callback\n   */\n  setOnDown(callback) {\n    this.onDown = callback;\n  }\n\n  /**\n   * \n   * @param callback\n   */\n  setOnMove(callback) {\n    this.onMove = callback;\n  }\n\n  /**\n   * \n   * @param callback\n   */\n  setOnEnter(callback) {\n    this.onEnter = callback;\n  }\n\n  /**\n   * \n   * @param callback\n   */\n  setOnLeave(callback) {\n    this.onLeave = callback;\n  }\n\n  /**\n   * \n   * @param iconFocus\n   */\n  setFocus(iconFocus) {\n    this.iconFocus = iconFocus;\n  }\n\n}\nXIcon.ICON_HORIZONTAL = {\n  LEFT: 0,\n  RIGHT: 1,\n  CENTER: 2,\n};\nXIcon.ICON_VERTICAL = {\n  TOP: 3,\n  BOTTOM: 4,\n  CENTER: 5,\n};\nXIcon.ICON_TYPE = {\n  image: 1,\n  custom: 2,\n};\nXIcon.ICON_EVENT_TYPE = {\n  MOUSE_DOWN: 1,\n  MOUSE_MOVE: 2,\n};\n\nexport { XIcon };\n","class DateUtils {\n\n  static dateFormat(fmt, date) {\n    if (!(date instanceof Date)) {\n      return date;\n    }\n    const o = {\n      'M+': date.getMonth() + 1,\n      'd+': date.getDate(),\n      'h+': date.getHours(),\n      'm+': date.getMinutes(),\n      's+': date.getSeconds(),\n      'q+': Math.floor((date.getMonth() + 3) / 3),\n      S: date.getMilliseconds(),\n    };\n    const reYear = /(y+)/;\n    const resultYear = reYear.exec(fmt);\n    if (resultYear) {\n      const yearFormatPart = resultYear[0];\n      const yearVal = (date.getFullYear().toString()).substr(4 - yearFormatPart.length);\n      fmt = fmt.replace(yearFormatPart, yearVal);\n    }\n    // eslint-disable-next-line guard-for-in,no-restricted-syntax\n    for (const k in o) {\n      const re = new RegExp(`(${k})`);\n      const res = re.exec(fmt);\n      if (res) {\n        const Val = o[k].toString();\n        const formatPart = res[0];\n        const replaceVal = (formatPart.length === 1) ? (Val) : ((`00${Val}`).substr(Val.length));\n        fmt = fmt.replace(formatPart, replaceVal);\n      }\n    }\n    return fmt;\n  }\n\n  static parse(text) {\n    let result = text;\n    if (result instanceof Date) {\n      return result;\n    }\n\n    result = DateUtils.parserToDate(text, 'yyyy/MM/dd');\n    if (result) {\n      return result;\n    }\n    result = DateUtils.parserToDate(text, 'MM/dd');\n    if (result) {\n      return result;\n    }\n    result = DateUtils.parserToDate(text, 'yyyy/MM/dd hh:mm:ss');\n    if (result) {\n      return result;\n    }\n\n    result = DateUtils.parserToDate(text, 'yyyy-MM-dd');\n    if (result) {\n      return result;\n    }\n    result = DateUtils.parserToDate(text, 'MM-dd');\n    if (result) {\n      return result;\n    }\n    result = DateUtils.parserToDate(text, 'yyyy-MM-dd hh:mm:ss');\n    if (result) {\n      return result;\n    }\n\n    result = DateUtils.parserToDate(text, 'hh:mm:ss');\n    if (result) {\n      return result;\n    }\n\n    result = DateUtils.parserToDate(text, 'yyyyMM');\n    if (result) {\n      return result;\n    }\n    result = DateUtils.parserToDate(text, 'MMdd');\n    if (result) {\n      return result;\n    }\n    result = DateUtils.parserToDate(text, 'yyyyMMdd hh:mm:ss');\n    if (result) {\n      return result;\n    }\n\n    return text;\n  }\n\n  static parserToDate(dateText, format) {\n    if (!dateText) {\n      return null;\n    }\n    const defaultVal = new Date('1970/01/01 00:00:00');\n    const o = [{\n      reg: 'y+',\n    }, {\n      reg: 'M+',\n    }, {\n      reg: 'd+',\n    }, {\n      reg: 'h+',\n    }, {\n      reg: 'm+',\n    }, {\n      reg: 's+',\n    }, {\n      reg: 'S',\n    }];\n    let year = defaultVal.getFullYear();\n    let month = defaultVal.getMonth() + 1;\n    let day = defaultVal.getDate();\n    let hours = defaultVal.getHours();\n    let minutes = defaultVal.getMinutes();\n    let seconds = defaultVal.getSeconds();\n    let milliseconds = defaultVal.getMilliseconds();\n    let index = 1;\n    for (let j = 0; j < format.length; j += 1) {\n      const oneChar = format[j];\n      for (let i = 0; i < o.length; i += 1) {\n        const onePart = o[i];\n        const onePartReg = onePart.reg;\n        if (onePartReg[0] === oneChar) {\n          if (!onePart.index) {\n            onePart.index = index;\n            index += 1;\n          }\n          break;\n        }\n      }\n    }\n    for (let i = 0; i < o.length; i += 1) {\n      const onePart = o[i];\n      const onePartReg = onePart.reg;\n      const re = new RegExp(`(${onePartReg})`);\n      const res = re.exec(format);\n      if (res) {\n        const formatPart = res[0];\n        const replaceVal = `([0-9]{1,${formatPart.length}})`;\n        // eslint-disable-next-line no-param-reassign\n        format = format.replace(formatPart, replaceVal);\n      }\n    }\n    const dataInfo = {};\n    const re = new RegExp(format);\n    const res = re.exec(dateText);\n    if (res) {\n      for (let i = 1; i < res.length; i += 1) {\n        dataInfo[i] = res[i];\n      }\n    } else {\n      return null;\n    }\n    if (o[0].index) {\n      const { index } = o[0];\n      year = dataInfo[index];\n    }\n    if (o[1].index) {\n      const { index } = o[1];\n      month = dataInfo[index];\n    }\n    if (o[2].index) {\n      const { index } = o[2];\n      day = dataInfo[index];\n    }\n    if (o[3].index) {\n      const { index } = o[3];\n      hours = dataInfo[index];\n    }\n    if (o[4].index) {\n      const { index } = o[4];\n      minutes = dataInfo[index];\n    }\n    if (o[5].index) {\n      const { index } = o[5];\n      seconds = dataInfo[index];\n    }\n    if (o[6].index) {\n      const { index } = o[6];\n      milliseconds = dataInfo[index];\n    }\n    return new Date(year, month - 1, day, hours, minutes, seconds, milliseconds);\n  }\n\n}\n\nexport { DateUtils };\n","import { SheetUtils } from '../../utils/SheetUtils';\nimport { DateUtils } from '../../utils/DateUtils';\n\nclass Format {\n\n  eNotation(value) {\n    if (SheetUtils.isNumber(value)) {\n      const number = SheetUtils.parseFloat(value);\n      return number.toExponential(2);\n    }\n    return value;\n  }\n\n  default(value) {\n    return value ? value.toString() : '';\n  }\n\n  text(value) {\n    return value;\n  }\n\n  decimal(value) {\n    if (SheetUtils.isNumber(value)) {\n      const indexOf = value.toString().indexOf('.');\n      if (indexOf !== -1) {\n        return value.toString().substring(0, indexOf + 3);\n      }\n      return `${value}.00`;\n    }\n    return value;\n  }\n\n  number(value) {\n    if (SheetUtils.isNumber(value)) {\n      return SheetUtils.parseFloat(value);\n    }\n    return value;\n  }\n\n  percentage(value) {\n    if (SheetUtils.isNumber(value)) {\n      return `${value}%`;\n    }\n    return value;\n  }\n\n  fraction(value) {\n    if (SheetUtils.isFraction(value)) {\n      const left = value.split('/')[0];\n      const right = value.split('/')[1];\n      return SheetUtils.parseInt(left) / SheetUtils.parseInt(right);\n    }\n    return value;\n  }\n\n  rmb(value) {\n    if (SheetUtils.isNumber(value)) {\n      return `${value}`;\n    }\n    return value;\n  }\n\n  hk(value) {\n    if (SheetUtils.isNumber(value)) {\n      return `HK${value}`;\n    }\n    return value;\n  }\n\n  time(value) {\n    const result = DateUtils.parse(value);\n    if (result) {\n      return DateUtils.dateFormat('hh:mm:ss', result);\n    }\n    return value;\n  }\n\n  date1(value) {\n    const result = DateUtils.parse(value);\n    if (result) {\n      return DateUtils.dateFormat('yyyy/MM/dd', result);\n    }\n    return value;\n  }\n\n  date2(value) {\n    const result = DateUtils.parse(value);\n    if (result) {\n      return DateUtils.dateFormat('MMdd', result);\n    }\n    return value;\n  }\n\n  date3(value) {\n    const result = DateUtils.parse(value);\n    if (result) {\n      return DateUtils.dateFormat('yyyyMM', result);\n    }\n    return value;\n  }\n\n  date4(value) {\n    const result = DateUtils.parse(value);\n    if (result) {\n      return DateUtils.dateFormat('yyyyMMdd', result);\n    }\n    return value;\n  }\n\n  date5(value) {\n    const result = DateUtils.parse(value);\n    if (result) {\n      return DateUtils.dateFormat('yyyy/MM/dd hh:mm:ss', result);\n    }\n    return value;\n  }\n\n  dollar(value) {\n    if (SheetUtils.isNumber(value)) {\n      return `$${value}`;\n    }\n    return value;\n  }\n\n}\n\nconst format = new Format();\n\nexport default (type, value) => format[type](value);\n","import { SheetUtils } from '../../../utils/SheetUtils';\nimport { ColorArray } from '../../../module/colorpicker/colorarray/ColorArray';\n\nclass RichFont {\n\n  constructor({\n    text = '',\n    color = ColorArray.BLACK,\n    name = 'Arial',\n    size = 14,\n    bold = false,\n    italic = false,\n    strikethrough = false,\n    underline = false,\n    scaleAdapter,\n  } = {}) {\n    this.text = text;\n    this.color = color;\n    this.name = name;\n    this.size = size;\n    this.italic = italic;\n    this.bold = bold;\n    this.strikethrough = strikethrough;\n    this.underline = underline;\n    this.scaleAdapter = scaleAdapter;\n  }\n\n  clone() {\n    const { text, color, name, size } = this;\n    const { italic, bold, underline } = this;\n    const { strikethrough, scaleAdapter } = this;\n    return new RichFont({\n      text, color, name, size, italic, bold, underline, strikethrough, scaleAdapter,\n    });\n  }\n\n  reset() {\n    this.color = ColorArray.BLACK;\n    this.name = 'Arial';\n    this.size = 14;\n    this.bold = false;\n    this.italic = false;\n    this.strikethrough = false;\n    this.underline = false;\n  }\n\n  plain(option = v => v) {\n    return option(this.clone());\n  }\n\n  equals(other) {\n    if (SheetUtils.isUnDef(other)) {\n      return false;\n    }\n    if (other.text !== this.text) {\n      return false;\n    }\n    if (other.color !== this.color) {\n      return false;\n    }\n    if (other.name !== this.name) {\n      return false;\n    }\n    if (other.size !== this.size) {\n      return false;\n    }\n    if (other.italic !== this.italic) {\n      return false;\n    }\n    if (other.bold !== this.bold) {\n      return false;\n    }\n    if (other.strikethrough !== this.strikethrough) {\n      return false;\n    }\n    return other.underline === this.underline;\n  }\n\n}\n\nexport {\n  RichFont,\n};\n","import { RichFont } from './RichFont';\nimport { SheetUtils } from '../../../utils/SheetUtils';\n\nclass RichFonts {\n\n  constructor({\n    rich = [],\n  } = {}) {\n    this.rich = rich.map(font => new RichFont(font));\n  }\n\n  setRich(rich = []) {\n    this.rich = rich;\n  }\n\n  getRich() {\n    return this.rich;\n  }\n\n  clone() {\n    const rich = [];\n    this.rich.forEach((font) => {\n      rich.push(font.clone());\n    });\n    return new RichFonts({\n      rich,\n    });\n  }\n\n  reset() {\n    this.each((i) => {\n      i.reset();\n    });\n  }\n\n  hasLength() {\n    return this.rich.length > 0;\n  }\n\n  each(cb = () => {}) {\n    this.rich.forEach((font) => {\n      cb(font);\n    });\n  }\n\n  plain(option) {\n    const result = [];\n    this.rich.forEach((font) => {\n      result.push(font.plain(option));\n    });\n    return result;\n  }\n\n  equals(other) {\n    if (SheetUtils.isUnDef(other)) {\n      return false;\n    }\n    if (other.rich.length !== this.rich.length) {\n      return false;\n    }\n    for (let i = 0; i < this.rich.length; i++) {\n      let item1 = this.rich[i];\n      let item2 = other.rich[i];\n      if (!item1.equals(item2)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n}\n\nexport {\n  RichFonts,\n};\n","/**\n * \n * @type {{}}\n */\nclass EvalFunctions {\n\n  /**\n   * EvalFunctions\n   */\n  constructor() {\n    this.functions = {};\n  }\n\n  /**\n   * \n   * @param name\n   */\n  remove(name) {\n    delete this.functions[name];\n  }\n\n  /**\n   * \n   * @param name\n   * @returns {*}\n   */\n  getFunction(name) {\n    return this.functions[name.toLocaleString()];\n  }\n\n  /**\n   * \n   * @param name\n   * @param func\n   */\n  register(name, func) {\n    this.functions[name.toLocaleString()] = func;\n  }\n}\n\n/**\n * \n * @type {EvalFunctions}\n */\nconst Functions = new EvalFunctions();\n\n/**\n * \n */\nclass Assembly {\n\n  /**\n   * Assembly\n   */\n  constructor() {\n    this.assembly = '';\n  }\n\n  /**\n   * \n   * @returns {string}\n   */\n  getInstruct() {\n    let { assembly } = this;\n    let flag = '\\r\\n';\n    while (assembly.endsWith(flag)) {\n      let { length } = assembly;\n      assembly = assembly.substring(0, length - flag.length);\n    }\n    return assembly;\n  }\n\n  /**\n   * \n   * @param value\n   */\n  writeOperand(value) {\n    this.assembly += `OPush ${value}\\r\\n`;\n  }\n\n  /**\n   * \n   * @param op\n   */\n  writeOperator(op) {\n    this.assembly += `${op}\\r\\n`;\n  }\n\n  /**\n   * \n   * @param value\n   */\n  writeString(value) {\n    this.assembly += `SPush ${value}\\r\\n`;\n  }\n\n  /**\n   * \n   * @param value\n   */\n  writeNumber(value) {\n    this.assembly += `NPush ${value}\\r\\n`;\n  }\n}\n\n/**\n * \n */\nclass Tokenizer {\n\n  /**\n   * Tokenizer\n   * @param syntaxCheck\n   */\n  constructor({\n    syntaxCheck = true,\n  } = {}) {\n    this.syntaxCheck = syntaxCheck;\n  }\n\n  /**\n   * \n   * @param input\n   * @returns {*[]}\n   */\n  lexical(input) {\n    let OPERATOR = /^(\\+|-|\\*|\\/|%|>|<|,|\\^|=|&|!|:|>=|<=|<>)$/;\n    let NUMBERS = /[0-9.]/;\n    let LETTERS = /[a-z0-9_$]/i;\n    // \n    let { length } = input;\n    // \n    let bracketsStack = [];\n    // \n    let current = 0;\n    // \n    let tokens = [];\n    // \n    while (current < length) {\n      // \n      let char = input[current];\n      // \n      let SPACE = /\\s/;\n      if (SPACE.test(char)) {\n        const next = input[current + 1];\n        if (SPACE.test(next)) {\n          current++;\n          continue;\n        }\n      }\n      // \n      if (SPACE.test(char)) {\n        const last = input[current - 1];\n        const next = input[current + 1];\n        if (LETTERS.test(last) && LETTERS.test(next)) {\n          tokens.push({\n            type: 'operator',\n            value: char,\n          });\n        }\n        current++;\n        continue;\n      }\n      // \n      if (char === '(') {\n        tokens.push({\n          type: 'brackets',\n          value: '(',\n        });\n        bracketsStack.push({\n          type: 'brackets',\n          value: '(',\n        });\n        current++;\n        continue;\n      }\n      if (char === ')') {\n        const brackets = bracketsStack.pop();\n        if (brackets && brackets.type === 'function') {\n          tokens.push({\n            type: 'function',\n            value: ')',\n          });\n        } else {\n          tokens.push({\n            type: 'brackets',\n            value: ')',\n          });\n        }\n        current++;\n        continue;\n      }\n      // \n      if (char === '{') {\n        tokens.push({\n          type: 'array',\n          value: 'array',\n        });\n        tokens.push({\n          type: 'array',\n          value: '{',\n        });\n        current++;\n        continue;\n      }\n      if (char === '}') {\n        tokens.push({\n          type: 'array',\n          value: '}',\n        });\n        current++;\n        continue;\n      }\n      // \n      if (char === '\"') {\n        let result = '';\n        current++;\n        char = input[current];\n        while (char !== '\"') {\n          if (current < length) {\n            result += char;\n            current++;\n            char = input[current];\n          } else {\n            break;\n          }\n        }\n        current++;\n        char = input[current];\n        tokens.push({\n          type: 'string',\n          value: result,\n        });\n        continue;\n      }\n      if (char === '\\'') {\n        let result = '';\n        current++;\n        char = input[current];\n        while (char !== '\\'') {\n          if (current < length) {\n            result += char;\n            current++;\n            char = input[current];\n          } else {\n            break;\n          }\n        }\n        current++;\n        char = input[current];\n        tokens.push({\n          type: 'string',\n          value: result,\n        });\n        continue;\n      }\n      // \n      if (OPERATOR.test(char)) {\n        let next = input[current + 1];\n        let result = `${char}${next}`;\n        if (OPERATOR.test(result)) {\n          tokens.push({\n            type: 'operator',\n            value: result,\n          });\n          current++;\n        } else {\n          tokens.push({\n            type: 'operator',\n            value: char,\n          });\n        }\n        current++;\n        continue;\n      }\n      // \n      if (NUMBERS.test(char)) {\n        let result = '';\n        while (NUMBERS.test(char)) {\n          if (current < length) {\n            result += char;\n            current++;\n            char = input[current];\n          } else {\n            break;\n          }\n        }\n        tokens.push({\n          type: 'number',\n          value: result,\n        });\n        continue;\n      }\n      // , , \n      if (LETTERS.test(char)) {\n        let result = '';\n        while (LETTERS.test(char)) {\n          if (current < length) {\n            result += char;\n            current++;\n            char = input[current];\n          } else {\n            break;\n          }\n        }\n        // \n        if (char === '(') {\n          tokens.push({\n            type: 'function',\n            value: result,\n          });\n          tokens.push({\n            type: 'function',\n            value: '(',\n          });\n          bracketsStack.push({\n            type: 'function',\n            value: '(',\n          });\n          current++;\n        } else {\n          tokens.push({\n            type: 'operand',\n            value: result,\n          });\n        }\n        continue;\n      }\n      // token\n      throw new TypeError(`token ${char} `);\n    }\n    // \n    if (this.syntaxCheck) {\n      return this.syntax(tokens);\n    }\n    return tokens;\n  }\n\n  /**\n   * \n   * @param tokens\n   */\n  syntax(tokens) {\n    // \n    let sQuotesStack = [];\n    // \n    let dQuotesStack = [];\n    // \n    let callStack = [];\n    // \n    let arrayStack = [];\n    // \n    let bracketsStack = [];\n    // \n    let current = 0;\n    // tokens\n    let { length } = tokens;\n    // token\n    let ignoreArray = (token) => {\n      if (token.type === 'array') {\n        return token.value === 'array';\n      }\n      return false;\n    };\n    // token\n    let ignoreFunc = (token) => {\n      if (token.type === 'function') {\n        return token.value !== '(' && token.value !== ')';\n      }\n      return false;\n    };\n    // \n    let skipIgnoreToken = (dir, index) => {\n      if (dir === 'last') {\n        while (index >= 0) {\n          let token = tokens[index];\n          if (ignoreFunc(token)) {\n            index--;\n            continue;\n          }\n          if (ignoreArray(token)) {\n            index--;\n            continue;\n          }\n          return token;\n        }\n      }\n      if (dir === 'next') {\n        while (index < length) {\n          let token = tokens[index];\n          if (ignoreFunc(token)) {\n            index++;\n            continue;\n          }\n          if (ignoreArray(token)) {\n            index++;\n            continue;\n          }\n          return token;\n        }\n      }\n      return null;\n    };\n    // \n    let checkArray = (dir, target) => {\n      let token = tokens[current];\n      let local = dir === 'last' ? '' : '';\n      if (token.value === '{') {\n        if (dir === 'last') {\n          switch (target.type) {\n            case 'array': {\n              if (target.value === '{') {\n                return;\n              }\n              break;\n            }\n            case 'function': {\n              if (target.value === '(') {\n                return;\n              }\n              break;\n            }\n            case 'brackets': {\n              if (target.value === '(') {\n                return;\n              }\n              break;\n            }\n            case 'operator': {\n              if (target.value === ',') {\n                return;\n              }\n              return;\n            }\n          }\n        }\n        if (dir === 'next') {\n          switch (target.type) {\n            case 'string':\n            case 'array':\n            case 'number':\n            case 'operand': {\n              return;\n            }\n            case 'function': {\n              if (target.value === '(') {\n                return;\n              }\n              break;\n            }\n            case 'brackets': {\n              if (target.value === '(') {\n                return;\n              }\n              break;\n            }\n          }\n        }\n      }\n      if (token.value === '}') {\n        if (dir === 'last') {\n          switch (target.type) {\n            case 'number':\n            case 'string':\n            case 'array':\n            case 'operand': {\n              return;\n            }\n            case 'function': {\n              if (target.value === ')') {\n                return;\n              }\n              break;\n            }\n            case 'brackets': {\n              if (target.value === ')') {\n                return;\n              }\n              break;\n            }\n          }\n        }\n        if (dir === 'next') {\n          switch (target.type) {\n            case 'array': {\n              if (target.value === '}') {\n                return;\n              }\n              break;\n            }\n            case 'function': {\n              if (target.value === ')') {\n                return;\n              }\n              break;\n            }\n            case 'brackets': {\n              if (target.value === ')') {\n                return;\n              }\n              break;\n            }\n            case 'operator': {\n              if (target.value === ',') {\n                return;\n              }\n              return;\n            }\n          }\n        }\n      }\n      throw TypeError(` ${token.value} ${local} ${target.value}`);\n    };\n    // \n    let checkValue = (dir, target) => {\n      let token = tokens[current];\n      let local = dir === 'last' ? '' : '';\n      switch (target.type) {\n        case 'array': {\n          if (dir === 'last') {\n            if (target.value === '{') {\n              return;\n            }\n          }\n          if (dir === 'next') {\n            if (target.value === '}') {\n              return;\n            }\n          }\n          break;\n        }\n        case 'brackets': {\n          if (dir === 'last') {\n            if (target.value === '(') {\n              return;\n            }\n          }\n          if (dir === 'next') {\n            if (target.value === ')') {\n              return;\n            }\n          }\n          break;\n        }\n        case 'function': {\n          if (dir === 'last') {\n            if (target.value === '(') {\n              return;\n            }\n          }\n          if (dir === 'next') {\n            if (target.value === ')') {\n              return;\n            }\n          }\n          break;\n        }\n        case 'operator': {\n          return;\n        }\n      }\n      throw TypeError(` ${token.value} ${local} ${target.value}`);\n    };\n    // \n    let checkOperator = (dir, target) => {\n      let token = tokens[current];\n      let local = dir === 'last' ? '' : '';\n      switch (target.type) {\n        case 'brackets':\n        case 'function':\n        case 'string':\n        case 'number':\n        case 'operand': {\n          return;\n        }\n        case 'array': {\n          if (token.value === ',') {\n            return;\n          }\n          break;\n        }\n      }\n      throw TypeError(` ${token.value} ${local} ${target.value}`);\n    };\n    // \n    let checkFunction = (dir, target) => {\n      let token = tokens[current];\n      let local = dir === 'last' ? '' : '';\n      if (token.value === '(') {\n        if (dir === 'last') {\n          switch (target.type) {\n            case 'array': {\n              if (target.value === '{') {\n                return;\n              }\n              break;\n            }\n            case 'function': {\n              if (target.value === '(') {\n                return;\n              }\n              break;\n            }\n            case 'brackets': {\n              if (target.value === '(') {\n                return;\n              }\n              break;\n            }\n            case 'operator': {\n              return;\n            }\n          }\n        }\n        if (dir === 'next') {\n          switch (target.type) {\n            case 'function':\n            case 'string':\n            case 'number':\n            case 'operand': {\n              return;\n            }\n            case 'array': {\n              if (target.value === '{') {\n                return;\n              }\n              break;\n            }\n            case 'brackets': {\n              if (target.value === '(') {\n                return;\n              }\n              break;\n            }\n          }\n        }\n      }\n      if (token.value === ')') {\n        if (dir === 'last') {\n          switch (target.type) {\n            case 'function':\n            case 'number':\n            case 'string':\n            case 'operand': {\n              return;\n            }\n            case 'array': {\n              if (target.value === '}') {\n                return;\n              }\n              break;\n            }\n            case 'brackets': {\n              if (target.value === ')') {\n                return;\n              }\n              break;\n            }\n          }\n        }\n        if (dir === 'next') {\n          switch (target.type) {\n            case 'array': {\n              if (target.value === '}') {\n                return;\n              }\n              break;\n            }\n            case 'function': {\n              if (target.value === ')') {\n                return;\n              }\n              break;\n            }\n            case 'brackets': {\n              if (target.value === ')') {\n                return;\n              }\n              break;\n            }\n            case 'operator': {\n              if (target.value === ',') {\n                return;\n              }\n              return;\n            }\n          }\n        }\n      }\n      throw TypeError(` ${token.value} ${local} ${target.value}`);\n    };\n    // token\n    while (current < length) {\n      // token\n      let token = tokens[current];\n      // token\n      if (ignoreArray(token)) {\n        current++;\n        continue;\n      }\n      if (ignoreFunc(token)) {\n        current++;\n        continue;\n      }\n      let { type, value } = token;\n      // \n      if (type === \"'\") {\n        if (sQuotesStack.length) {\n          sQuotesStack.pop();\n        } else {\n          // \n          if (!dQuotesStack.length) {\n            sQuotesStack.push(\"'\");\n          }\n        }\n      }\n      // \n      if (type === '\"') {\n        if (dQuotesStack.length) {\n          dQuotesStack.pop();\n        } else {\n          // \n          if (!sQuotesStack.length) {\n            dQuotesStack.push('\"');\n          }\n        }\n      }\n      // \n      if (type === 'string') {\n        let last = skipIgnoreToken('last', current - 1);\n        let next = skipIgnoreToken('next', current + 1);\n        if (last) {\n          checkValue('last', last);\n        }\n        if (next) {\n          checkValue('next', next);\n        }\n      }\n      // \n      if (type === 'number') {\n        let last = skipIgnoreToken('last', current - 1);\n        let next = skipIgnoreToken('next', current + 1);\n        if (last) {\n          checkValue('last', last);\n        }\n        if (next) {\n          checkValue('next', next);\n        }\n      }\n      // \n      if (type === 'array') {\n        if (value === '{') {\n          arrayStack.push(token);\n        }\n        if (value === '}') {\n          if (arrayStack.length === 0) {\n            throw new TypeError('');\n          }\n          arrayStack.pop();\n        }\n        let last = skipIgnoreToken('last', current - 1);\n        let next = skipIgnoreToken('next', current + 1);\n        if (last) {\n          checkArray('last', last);\n        }\n        if (next) {\n          checkArray('next', next);\n        }\n      }\n      // \n      if (type === 'function') {\n        if (value === '(') {\n          callStack.push(token);\n        }\n        if (value === ')') {\n          callStack.pop();\n        }\n        let last = skipIgnoreToken('last', current - 1);\n        let next = skipIgnoreToken('next', current + 1);\n        if (last) {\n          checkFunction('last', last);\n        }\n        if (next) {\n          checkFunction('next', next);\n        }\n      }\n      // \n      if (type === 'operator') {\n        let last = skipIgnoreToken('last', current - 1);\n        let next = skipIgnoreToken('next', current + 1);\n        // \n        if (last) {\n          checkOperator('last', last);\n        } else {\n          throw TypeError(`: ${token.value} `);\n        }\n        if (next) {\n          checkOperator('next', next);\n        } else {\n          throw TypeError(`: ${token.value} `);\n        }\n      }\n      // \n      if (type === 'brackets') {\n        if (value === '(') {\n          bracketsStack.push(token);\n        }\n        if (value === ')') {\n          if (bracketsStack.length === 0) {\n            throw new TypeError('');\n          }\n          bracketsStack.pop();\n        }\n      }\n      // \n      current++;\n    }\n    // \n    if (arrayStack.length) {\n      throw new TypeError('');\n    }\n    if (callStack.length) {\n      throw new TypeError('');\n    }\n    if (sQuotesStack.length) {\n      throw new TypeError('');\n    }\n    if (dQuotesStack.length) {\n      throw new TypeError('');\n    }\n    if (bracketsStack.length) {\n      throw new TypeError('');\n    }\n    return tokens;\n  }\n}\n\n/**\n * \n */\nclass Compiler {\n\n  /**\n   * Compiler\n   * @param tokens\n   * @param writer\n   */\n  constructor({\n    tokens, writer,\n  } = {}) {\n    this.writer = writer;\n    this.tokens = tokens;\n    this.groupStack = [];\n    this.index = -1;\n    this.ignore = [','];\n    // \n    this.opIf = {\n      '>': 'ifge',\n      '<': 'ifgt',\n      '=': 'ifeq',\n      '>=': 'if_icmpge',\n      '<=': 'if_icmpgt',\n      '<>': 'ifne',\n    };\n    this.opAdd = {\n      '+': 'add',\n      '-': 'sub',\n      '&': 'link',\n    };\n    this.opMul = {\n      '*': 'mul',\n      '/': 'div',\n      '%': 'mod',\n      '^': 'power',\n    };\n    this.opCommon = {\n      ' ': 'common',\n    };\n    this.opRel = {\n      '!': 'rel',\n      ':': 'uni',\n    };\n    this.opNew = {\n      array: 'newarray',\n    };\n    this.opCell = {\n      function: 'invoke',\n    };\n  }\n\n  /**\n   * \n   */\n  eofToken() {\n    const { index, tokens } = this;\n    const { length } = tokens;\n    return index >= length - 1;\n  }\n\n  /**\n   * Token\n   */\n  nextToken() {\n    this.index++;\n    this.token = this.tokens[this.index];\n    return this.token;\n  }\n\n  /**\n   * Token\n   */\n  backToken() {\n    this.index--;\n    this.token = this.tokens[this.index];\n    return this.token;\n  }\n\n  /**\n   * \n   */\n  reduceGroup() {\n    const { groupStack } = this;\n    const { length } = groupStack;\n    if (length > 0) {\n      const last = groupStack[length - 1];\n      const number = last.number;\n      last.number = number - 1;\n    }\n  }\n\n  /**\n   * \n   */\n  increaseGroup() {\n    const { groupStack } = this;\n    const { length } = groupStack;\n    if (length > 0) {\n      const last = groupStack[length - 1];\n      const number = last.number;\n      last.number = number + 1;\n    }\n  }\n\n  /**\n   * \n   */\n  popGroup() {\n    return this.groupStack.pop();\n  }\n\n  /**\n   * \n   */\n  addGroup(token) {\n    token.number = 0;\n    this.groupStack.push(token);\n    return token;\n  }\n\n  /**\n   * Token\n   * @returns {*}\n   */\n  isSkipNextToken() {\n    if (!this.eofToken()) {\n      const { ignore } = this;\n      this.nextToken();\n      const { token } = this;\n      this.backToken();\n      const { value } = token;\n      return ignore.includes(value);\n    }\n    return false;\n  }\n\n  /**\n   * \n   */\n  compile() {\n    const { writer } = this;\n    this.compileIfge();\n    while (this.isSkipNextToken()) {\n      this.nextToken();\n      this.compileIfge();\n    }\n    return writer.getInstruct();\n  }\n\n  /**\n   * \n   */\n  compileIfge() {\n    this.compileAdd();\n    while (!this.eofToken()) {\n      const token = this.nextToken();\n      const { type, value } = token;\n      if (type !== 'operator') {\n        this.backToken();\n        break;\n      }\n      if (!this.opIf[value]) {\n        this.backToken();\n        break;\n      }\n      let operator = this.opIf[value];\n      this.compileAdd();\n      this.reduceGroup();\n      this.writer.writeOperator(operator);\n    }\n  }\n\n  /**\n   * \n   */\n  compileAdd() {\n    this.compileMul();\n    while (!this.eofToken()) {\n      const token = this.nextToken();\n      const { type, value } = token;\n      if (type !== 'operator') {\n        this.backToken();\n        break;\n      }\n      if (!this.opAdd[value]) {\n        this.backToken();\n        break;\n      }\n      let operator = this.opAdd[value];\n      this.compileMul();\n      this.reduceGroup();\n      this.writer.writeOperator(operator);\n    }\n  }\n\n  /**\n   * \n   */\n  compileMul() {\n    this.compileCommon();\n    while (!this.eofToken()) {\n      const token = this.nextToken();\n      const { type, value } = token;\n      if (type !== 'operator') {\n        this.backToken();\n        break;\n      }\n      if (!this.opMul[value]) {\n        this.backToken();\n        break;\n      }\n      let operator = this.opMul[value];\n      this.compileCommon();\n      this.reduceGroup();\n      this.writer.writeOperator(operator);\n    }\n  }\n\n  /**\n   * \n   */\n  compileCommon() {\n    this.compileRel();\n    while (!this.eofToken()) {\n      const token = this.nextToken();\n      const { type, value } = token;\n      if (type !== 'operator') {\n        this.backToken();\n        break;\n      }\n      if (!this.opCommon[value]) {\n        this.backToken();\n        break;\n      }\n      let operator = this.opCommon[value];\n      this.compileRel();\n      this.reduceGroup();\n      this.writer.writeOperator(operator);\n    }\n  }\n\n  /**\n   * Sheet\n   */\n  compileRel() {\n    this.compileArray();\n    while (!this.eofToken()) {\n      const token = this.nextToken();\n      const { type, value } = token;\n      if (type !== 'operator') {\n        this.backToken();\n        break;\n      }\n      if (!this.opRel[value]) {\n        this.backToken();\n        break;\n      }\n      let operator = this.opRel[value];\n      this.compileArray();\n      this.reduceGroup();\n      this.writer.writeOperator(operator);\n    }\n  }\n\n  /**\n   * \n   */\n  compileArray() {\n    this.compileFunction();\n    while (!this.eofToken()) {\n      const token = this.nextToken();\n      const { type, value } = token;\n      if (type !== 'array') {\n        this.backToken();\n        break;\n      }\n      //  } \n      if (value === '}') {\n        this.backToken();\n        break;\n      }\n      this.addGroup(token);\n      //  {  \n      this.nextToken();\n      // \n      this.compileIfge();\n      // \n      // \n      while (this.isSkipNextToken()) {\n        this.nextToken();\n        this.compileIfge();\n      }\n      // \n      // \n      this.popGroup();\n      const { number } = token;\n      const operator = this.opNew[type];\n      this.writer.writeOperator(`${operator} ${number}`);\n      //  }\n      this.nextToken();\n    }\n  }\n\n  /**\n   * \n   */\n  compileFunction() {\n    this.compilePushValue();\n    while (!this.eofToken()) {\n      const token = this.nextToken();\n      const { type, value } = token;\n      if (type !== 'function') {\n        this.backToken();\n        break;\n      }\n      //  ) \n      if (value === ')') {\n        this.backToken();\n        break;\n      }\n      this.addGroup(token);\n      //  (  \n      this.nextToken();\n      // \n      this.compileIfge();\n      // \n      // \n      while (this.isSkipNextToken()) {\n        this.nextToken();\n        this.compileIfge();\n      }\n      // \n      // \n      this.popGroup();\n      const { number } = token;\n      const operator = this.opCell[type];\n      this.writer.writeOperator(`${operator} ${value} ${number}`);\n      //  )\n      this.nextToken();\n    }\n  }\n\n  /**\n   * compilePushValue\n   */\n  compilePushValue() {\n    if (!this.eofToken()) {\n      const token = this.nextToken();\n      const { writer } = this;\n      const { type, value } = token;\n      // \n      // /()\n      switch (type) {\n        case 'string': {\n          this.increaseGroup();\n          writer.writeString(`${value}`);\n          return;\n        }\n        case 'number': {\n          this.increaseGroup();\n          writer.writeNumber(`${value}`);\n          return;\n        }\n        case 'operand': {\n          this.increaseGroup();\n          writer.writeOperand(value);\n          return;\n        }\n      }\n      // \n      switch (type) {\n        case 'brackets': {\n          if (value === '(') {\n            this.compileIfge();\n            // \n            // \n            while (this.isSkipNextToken()) {\n              this.nextToken();\n              this.compileIfge();\n            }\n            //  )\n            this.nextToken();\n          }\n          return;\n        }\n      }\n      // /()\n      switch (type) {\n        case 'array': {\n          // {} \n          if (value !== '}') {\n            this.increaseGroup();\n          }\n          this.backToken();\n          return;\n        }\n        case 'function': {\n          // func() \n          if (value !== ')') {\n            this.increaseGroup();\n          }\n          this.backToken();\n          return;\n        }\n      }\n      // \n      switch (type) {\n        case 'operator': {\n          this.backToken();\n          return;\n        }\n      }\n      // token\n      throw new TypeError(`token ${type} ${value} `);\n    }\n  }\n}\n\n/**\n * \n */\nclass Evaluation {\n\n  /**\n   * Evaluate\n   * @param instruct\n   */\n  constructor(instruct) {\n    this.instruct = instruct.split('\\r\\n');\n    this.memory = [];\n  }\n\n  /**\n   * \n   */\n  eval() {\n    const newArray = /^newarray/;\n    const invoke = /^invoke/;\n    const pushSRegexp = /^SPush/;\n    const pushNRegexp = /^NPush/;\n    const pushORegexp = /^OPush/;\n    const { instruct } = this;\n    instruct.forEach((name) => {\n      switch (name) {\n        case 'if_icmpge': {\n          this.ificmpge();\n          break;\n        }\n        case 'if_icmpgt': {\n          this.ificmpgt();\n          break;\n        }\n        case 'ifge': {\n          this.ifge();\n          break;\n        }\n        case 'ifgt': {\n          this.ifgt();\n          break;\n        }\n        case 'ifeq': {\n          this.ifeq();\n          break;\n        }\n        case 'ifne': {\n          this.ifne();\n          break;\n        }\n        case 'add': {\n          this.add();\n          break;\n        }\n        case 'sub': {\n          this.sub();\n          break;\n        }\n        case 'mul': {\n          this.mul();\n          break;\n        }\n        case 'div': {\n          this.div();\n          break;\n        }\n        case 'mod': {\n          this.mod();\n          break;\n        }\n        case 'power': {\n          this.power();\n          break;\n        }\n        case 'rel': {\n          this.rel();\n          break;\n        }\n        case 'link': {\n          this.link();\n          break;\n        }\n        case 'uni': {\n          this.uni();\n          break;\n        }\n        case 'common': {\n          this.common();\n          break;\n        }\n        default: {\n          if (newArray.test(name)) {\n            const group = name.split(' ');\n            const index = group[1];\n            this.array(index);\n            break;\n          }\n          if (invoke.test(name)) {\n            const group = name.split(' ');\n            const func = group[1];\n            const index = group[2];\n            this.invoke(func, index);\n            break;\n          }\n          if (pushSRegexp.test(name)) {\n            const value = name.split(' ')[1];\n            this.pushS(value);\n            break;\n          }\n          if (pushNRegexp.test(name)) {\n            const value = name.split(' ')[1];\n            this.pushN(value);\n            break;\n          }\n          if (pushORegexp.test(name)) {\n            const value = name.split(' ')[1];\n            this.pushO(value);\n            break;\n          }\n        }\n      }\n    });\n    return this.memory.pop();\n  }\n\n  /**\n   * \n   * @param value\n   */\n  pushS(value) {\n    this.memory.push(value);\n  }\n\n  /**\n   * \n   * @param value\n   */\n  pushN(value) {\n    value = parseFloat(value);\n    this.memory.push(value);\n  }\n\n  /**\n   * \n   * @param value\n   */\n  pushO(value) {\n    this.memory.push(value);\n  }\n\n  /**\n   * \n   */\n  ifge() {\n    const b = this.memory.pop();\n    const a = this.memory.pop();\n    this.memory.push(a > b);\n  }\n\n  /**\n   * \n   */\n  ifgt() {\n    const b = this.memory.pop();\n    const a = this.memory.pop();\n    this.memory.push(a < b);\n  }\n\n  /**\n   * \n   */\n  ifeq() {\n    const b = this.memory.pop();\n    const a = this.memory.pop();\n    this.memory.push(a === b);\n  }\n\n  /**\n   * \n   */\n  ifne() {\n    const b = this.memory.pop();\n    const a = this.memory.pop();\n    this.memory.push(a !== b);\n  }\n\n  /**\n   * \n   */\n  ificmpge() {\n    const b = this.memory.pop();\n    const a = this.memory.pop();\n    this.memory.push(a >= b);\n  }\n\n  /**\n   * \n   */\n  ificmpgt() {\n    const b = this.memory.pop();\n    const a = this.memory.pop();\n    this.memory.push(a <= b);\n  }\n\n  /**\n   * \n   */\n  add() {\n    const b = this.memory.pop();\n    const a = this.memory.pop();\n    this.memory.push(a + b);\n  }\n\n  /**\n   * \n   */\n  sub() {\n    const b = this.memory.pop();\n    const a = this.memory.pop();\n    this.memory.push(a - b);\n  }\n\n  /**\n   * \n   */\n  mul() {\n    const b = this.memory.pop();\n    const a = this.memory.pop();\n    this.memory.push(a * b);\n  }\n\n  /**\n   * \n   */\n  div() {\n    const b = this.memory.pop();\n    const a = this.memory.pop();\n    this.memory.push(a / b);\n  }\n\n  /**\n   * mod\n   */\n  mod() {\n    const b = this.memory.pop();\n    const a = this.memory.pop();\n    this.memory.push(a % b);\n  }\n\n  /**\n   * \n   */\n  common() {\n    // TODO ...\n    // ....\n  }\n\n  /**\n   * sheet\n   */\n  rel() {\n    // TODO ...\n    // ....\n  }\n\n  /**\n   * \n   */\n  uni() {\n    // TODO ...\n    // ....\n  }\n\n  /**\n   * \n   */\n  link() {\n    const b = this.memory.pop();\n    const a = this.memory.pop();\n    this.memory.push(`${a}${b}`);\n  }\n\n  /**\n   * \n   */\n  power() {\n    const b = this.memory.pop();\n    const a = this.memory.pop();\n    this.memory.push(Math.pow(a, b));\n  }\n\n  /**\n   * \n   * @param index\n   */\n  array(index) {\n    const array = [];\n    for (let i = 1; i <= index; i++) {\n      const item = this.memory.pop();\n      array.push(item);\n    }\n    array.reverse();\n    this.memory.push(array);\n  }\n\n  /**\n   * \n   * @param func\n   * @param index\n   */\n  invoke(func, index) {\n    const array = [];\n    for (let i = 1; i <= index; i++) {\n      const item = this.memory.pop();\n      array.push(item);\n    }\n    array.reverse();\n    const execute = Functions.getFunction(func);\n    const result = execute.apply(this, array);\n    this.memory.push(result);\n  }\n}\n\n/**\n * \n * @param input\n * @returns {string|*}\n * @constructor\n */\nconst Compile = (input) => {\n  if (input.startsWith('=')) {\n    input = input.substring(1);\n  }\n  const tokenizer = new Tokenizer();\n  const writer = new Assembly();\n  const tokens = tokenizer.lexical(input);\n  const compiler = new Compiler({\n    writer, tokens,\n  });\n  return compiler.compile();\n};\n\n/**\n * \n * @param inst\n * @returns {*}\n * @constructor\n */\nconst Instruct = (inst) => {\n  const evaluation = new Evaluation(inst);\n  return evaluation.eval();\n};\n\n/**\n * \n * @constructor\n */\nconst Evaluate = input => Instruct(Compile(input));\n\nexport {\n  Tokenizer,\n  Compiler,\n  Assembly,\n  Compile,\n  Evaluate,\n  Instruct,\n  Functions,\n};\n","import { Compile, Instruct } from './Compiler';\nimport { SheetUtils } from '../utils/SheetUtils';\n\n/**\n * Formula\n */\nclass Formula {\n\n  /**\n   * Formula\n   * @param expr\n   */\n  constructor({\n    expr = SheetUtils.EMPTY,\n  } = {}) {\n    this.expr = expr;\n    this.content = SheetUtils.Nul;\n    this.instruct = SheetUtils.Nul;\n  }\n\n  /**\n   * \n   * @return {string}\n   */\n  getValue() {\n    let { expr } = this;\n    let { content } = this;\n    let { instruct } = this;\n    if (!content) {\n      if (!instruct) {\n        instruct = Compile(expr);\n      }\n      content = Instruct(instruct);\n    }\n    this.content = content;\n    this.instruct = instruct;\n    return content;\n  }\n\n  /**\n   * \n   * @return {boolean}\n   */\n  hasExpr() {\n    let { expr } = this;\n    return !SheetUtils.isBlank(expr);\n  }\n\n  /**\n   * \n   * @return {string}\n   */\n  getExpr() {\n    return this.expr;\n  }\n\n  /**\n   * \n   * @param expr\n   */\n  setExpr(expr) {\n    this.expr = expr;\n    this.content = SheetUtils.Nul;\n    this.instruct = SheetUtils.Nul;\n  }\n\n  /**\n   * \n   * @returns {Formula}\n   */\n  clone() {\n    return new Formula({\n      expr: this.expr,\n    });\n  }\n\n}\n\nexport {\n  Formula,\n};\n","import { SheetUtils } from '../../../utils/SheetUtils';\nimport { CellFont } from './CellFont';\nimport { CellBorder } from './CellBorder';\nimport { XIcon } from '../tableicon/XIcon';\nimport XTableFormat from '../XTableTextFormat';\nimport { RichFonts } from './RichFonts';\nimport { Formula } from '../../../formula/Formula';\nimport { DateUtils } from '../../../utils/DateUtils';\n\n/**\n * \n */\nclass Cell {\n\n  /**\n   * Cell\n   * @param background\n   * @param format\n   * @param text\n   * @param richText\n   * @param ruler\n   * @param custom\n   * @param icons\n   * @param borderAttr\n   * @param fontAttr\n   * @param formula\n   * @param contentWidth\n   * @param contentHeight\n   * @param contentType\n   */\n  constructor({\n    ruler = SheetUtils.Undef,\n    format = 'default',\n    icons = [],\n    fontAttr = {},\n    custom = {},\n    borderAttr = {},\n    formula = {},\n    richText = {},\n    background = SheetUtils.Undef,\n    text = SheetUtils.EMPTY,\n    contentWidth = 0,\n    contentHeight = 0,\n    contentType = Cell.TYPE.STRING,\n  } = {}) {\n    // \n    this.background = background;\n    // \n    this.icons = XIcon.newInstances(icons);\n    // \n    this.custom = custom;\n    // \n    this.ruler = ruler;\n    // \n    this.format = format;\n    // \n    this.formula = new Formula(formula);\n    // \n    this.text = text;\n    // \n    this.richText = new RichFonts(richText);\n    // \n    this.formatText = SheetUtils.EMPTY;\n    // \n    this.contentHeight = contentHeight;\n    // \n    this.contentWidth = contentWidth;\n    // \n    this.fontAttr = new CellFont(fontAttr);\n    // \n    this.borderAttr = new CellBorder(borderAttr);\n    // \n    this.setContentType(contentType);\n  }\n\n  /**\n   * \n   * @param icons\n   */\n  setIcons(icons) {\n    this.icons = icons;\n    return this;\n  }\n\n  /**\n   * \n   * @param text\n   */\n  setText(text) {\n    this.formatText = null;\n    this.text = text;\n    this.formula.setExpr(null);\n    this.richText.setRich([]);\n    this.setContentWidth(0);\n    return this;\n  }\n\n  /**\n   * \n   */\n  setRichText(rich) {\n    this.formatText = null;\n    this.text = null;\n    this.formula.setExpr(null);\n    this.richText.setRich(rich);\n    this.setContentWidth(0);\n    return this;\n  }\n\n  /**\n   * \n   */\n  setExpr(expr) {\n    this.formatText = null;\n    this.text = null;\n    this.formula.setExpr(expr);\n    this.richText.setRich([]);\n    this.setContentWidth(0);\n    return this;\n  }\n\n  /**\n   * \n   */\n  getExpr() {\n    return this.formula.getExpr();\n  }\n\n  /**\n   * \n   * @param format\n   */\n  setFormat(format = 'default') {\n    this.format = format;\n    this.formatText = null;\n    this.setContentWidth(0);\n    return this;\n  }\n\n  /**\n   * \n   * @param ruler\n   */\n  setRuler(ruler) {\n    this.ruler = ruler;\n    return this;\n  }\n\n  /**\n   * \n   * @param type\n   */\n  setContentType(type = Cell.TYPE.STRING) {\n    const { text } = this;\n    switch (type) {\n      case Cell.TYPE.STRING: {\n        this.contentType = Cell.TYPE.STRING;\n        break;\n      }\n      case Cell.TYPE.NUMBER: {\n        this.contentType = type;\n        if (SheetUtils.isNumber(text)) {\n          this.contentType = Cell.TYPE.NUMBER;\n          this.text = SheetUtils.parseFloat(text);\n        } else {\n          this.contentType = Cell.TYPE.STRING;\n          this.text = `${text}`;\n        }\n        break;\n      }\n      case Cell.TYPE.DATE_TIME: {\n        const parse = DateUtils.parse(text);\n        if (SheetUtils.isDate(parse)) {\n          this.contentType = Cell.TYPE.DATE_TIME;\n          this.text = SheetUtils.parseFloat(text);\n        } else {\n          this.contentType = Cell.TYPE.STRING;\n          this.text = `${text}`;\n        }\n        break;\n      }\n      case Cell.TYPE.RICH_TEXT: {\n        this.contentType = Cell.TYPE.RICH_TEXT;\n        break;\n      }\n    }\n    return this;\n  }\n\n  /**\n   * \n   * @returns {boolean}\n   */\n  isEmpty() {\n    return SheetUtils.isBlank(this.getComputeText());\n  }\n\n  /**\n   * \n   */\n  hasFormula() {\n    return this.formula.hasExpr();\n  }\n\n  /**\n   * \n   * @returns {string|*}\n   */\n  getFormatText() {\n    let { text, formula, format } = this;\n    let { formatText } = this;\n    let { contentType } = this;\n    // \n    if (formula.hasExpr()) {\n      let value = formula.getValue();\n      if (value) {\n        if (SheetUtils.isBlank(formatText)) {\n          formatText = XTableFormat(format, value);\n        }\n      }\n      this.formatText = formatText;\n      return formatText;\n    }\n    // \n    switch (contentType) {\n      case Cell.TYPE.STRING:\n      case Cell.TYPE.NUMBER:\n      case Cell.TYPE.DATE_TIME: {\n        if (format) {\n          if (SheetUtils.isBlank(formatText)) {\n            this.formatText = XTableFormat(format, text);\n            return this.formatText;\n          }\n        }\n        return formatText;\n      }\n    }\n    // \n    return SheetUtils.EMPTY;\n  }\n\n  /**\n   * \n   * @returns {string|*}\n   */\n  getComputeText() {\n    let { text, formula } = this;\n    let { richText } = this;\n    let { contentType } = this;\n    // \n    if (formula.hasExpr()) {\n      return formula.getValue();\n    }\n    // \n    switch (contentType) {\n      case Cell.TYPE.STRING:\n      case Cell.TYPE.NUMBER:\n      case Cell.TYPE.DATE_TIME: {\n        return text;\n      }\n      case Cell.TYPE.RICH_TEXT: {\n        return richText;\n      }\n    }\n    // \n    return SheetUtils.EMPTY;\n  }\n\n  /**\n   * \n   * @param attr\n   */\n  setFontAttr(attr) {\n    this.fontAttr = attr;\n    return this;\n  }\n\n  /**\n   * \n   * @param attr\n   */\n  setBorderAttr(attr) {\n    this.borderAttr = attr;\n    return this;\n  }\n\n  /**\n   * \n   * @returns {Cell}\n   */\n  clone() {\n    const { background, text, format, custom } = this;\n    const { icons, contentType, formula } = this;\n    const { richText, fontAttr, borderAttr } = this;\n    return new Cell({\n      background,\n      text,\n      custom,\n      contentType,\n      format,\n      fontAttr,\n      borderAttr,\n      icons,\n      formula,\n      richText,\n    });\n  }\n\n  /**\n   * toJSON\n   */\n  toJSON() {\n    const { background, text, format, custom } = this;\n    const { icons, contentType, formula } = this;\n    const { richText, fontAttr, borderAttr } = this;\n    return {\n      custom,\n      expr: formula.getExpr(),\n      rich: richText.getRich(),\n      contentType,\n      text,\n      icons,\n      background,\n      format,\n      fontAttr,\n      borderAttr,\n    };\n  }\n\n  /**\n   * toString\n   * @returns {string|*}\n   */\n  toString() {\n    return this.getFormatText();\n  }\n\n  /**\n   * \n   * @param width\n   */\n  setContentWidth(width) {\n    this.contentWidth = width;\n    return this;\n  }\n\n  /**\n   * \n   * @param height\n   */\n  setContentHeight(height) {\n    this.contentHeight = height;\n    return this;\n  }\n\n}\n\n/**\n * \n */\nCell.TYPE = {\n  // \n  NUMBER: 0,\n  // \n  STRING: 1,\n  // \n  RICH_TEXT: 2,\n  // \n  DATE_TIME: 3,\n};\n\nexport {\n  Cell,\n};\n","import { SheetUtils } from '../../utils/SheetUtils';\nimport { Cell } from './tablecell/Cell';\n\nclass XTableDataItem {\n\n  constructor(options) {\n    if (options) {\n      const { cell } = options;\n      this.cell = SheetUtils.safeValue(cell, options);\n    } else {\n      this.cell = undefined;\n    }\n  }\n\n  getCell() {\n    const { cell } = this;\n    if (cell instanceof Cell) {\n      return cell;\n    }\n    if (SheetUtils.isString(cell)) {\n      this.cell = new Cell({\n        text: cell,\n      });\n    } else {\n      this.cell = new Cell(cell);\n    }\n    return this.cell;\n  }\n\n  setCell(cell) {\n    this.cell = cell;\n    return this;\n  }\n\n  clone() {\n    return new XTableDataItem({\n      mergeId: this.mergeId,\n      cell: this.cell,\n    });\n  }\n\n}\n\nexport {\n  XTableDataItem,\n};\n","class Listen {\n\n  constructor() {\n    this.pool = {};\n  }\n\n  clear() {\n    Object.keys((key) => {\n      delete this.pool[key];\n    });\n  }\n\n  removeListen(key) {\n    delete this.pool[key];\n  }\n\n  registerListen(key, call) {\n    this.pool[key] = call;\n  }\n\n  execute(key, ...message) {\n    if (this.pool[key]) {\n      this.pool[key](...message);\n    }\n  }\n\n}\n\nexport {\n  Listen,\n};\n","/**\n * \n */\nimport { Listen } from '../../../lib/Listen';\n\nclass Snapshot {\n\n  /**\n   * Snapshot\n   */\n  constructor() {\n    // \n    this.undoStack = [];\n    // \n    this.redoStack = [];\n    // \n    this.layer = {\n      event: '',\n      data: [],\n    };\n    // \n    this.apply = false;\n    // \n    this.listen = new Listen();\n  }\n\n  /**\n   * \n   * @returns {boolean}\n   */\n  canRedo() {\n    return this.redoStack.length > 0;\n  }\n\n  /**\n   * \n   * @returns {boolean}\n   */\n  canUndo() {\n    return this.undoStack.length > 0;\n  }\n\n  /**\n   * \n   */\n  undo() {\n    const layer = this.undoStack.pop();\n    for (let i = layer.data.length - 1; i >= 0; i--) {\n      const action = layer.data[i];\n      action.undo();\n    }\n    this.redoStack.push(layer);\n    this.listen.execute('change', layer.event, 'undo');\n  }\n\n  /**\n   * \n   */\n  redo() {\n    const layer = this.redoStack.pop();\n    for (let i = 0, len = layer.data.length; i < len; i++) {\n      const action = layer.data[i];\n      action.redo();\n    }\n    this.undoStack.push(layer);\n    this.listen.execute('change', layer.event, 'redo');\n  }\n\n  /**\n   * \n   */\n  open() {\n    this.layer = {\n      event: '',\n      data: [],\n    };\n    this.apply = true;\n  }\n\n  /**\n   * \n   */\n  close(event) {\n    if (this.layer.data.length) {\n      this.layer.event = event;\n      this.redoStack = [];\n      this.undoStack.push(this.layer);\n    }\n    this.layer = {\n      event: '',\n      data: [],\n    };\n    this.apply = false;\n    this.listen.execute('change', event, 'close');\n  }\n\n  /**\n   * \n   * @param action\n   */\n  addAction(action = {\n    undo: () => {},\n    redo: () => {},\n  }) {\n    if (this.apply) {\n      this.layer.data.push(action);\n    }\n  }\n}\n\nexport {\n  Snapshot,\n};\n","import { XTableDataItem } from './XTableDataItem';\nimport { Snapshot } from './snapshot/Snapshot';\n\nclass XTableDataItems {\n\n  constructor({\n    snapshot = new Snapshot(),\n    items = [],\n  } = {}) {\n    this.items = items;\n    this.snapshot = snapshot;\n  }\n\n  getOrNew(ri, ci) {\n    const find = this.get(ri, ci);\n    if (find) {\n      return find;\n    }\n    const item = new XTableDataItem();\n    this.set(ri, ci, item);\n    return item;\n  }\n\n  getItems() {\n    return this.items;\n  }\n\n  slice(sri, sci, eri, eci) {\n    const rows = this.items.slice(sri, eri + 1);\n    return rows.map((row) => {\n      if (row) {\n        return row.slice(sci, eci + 1);\n      }\n      return row;\n    });\n  }\n\n  get(ri, ci) {\n    const line = this.items[ri];\n    return line && line[ci]\n      ? this.wrap(line, ci)\n      : undefined;\n  }\n\n  set(ri, ci, item) {\n    const line = this.items[ri] || [];\n    line[ci] = item;\n    this.items[ri] = line;\n  }\n\n  wrap(line, ci) {\n    let item = line[ci];\n    if (item) {\n      item = item instanceof XTableDataItem\n        ? item : new XTableDataItem(item);\n      line[ci] = item;\n      return item;\n    }\n    return item;\n  }\n\n  each(callback) {\n    const { items } = this;\n    const { length } = items;\n    for (let i = 0; i < length; i++) {\n      let item = items[i];\n      if (item) {\n        const { length } = item;\n        for (let j = 0; j < length; j++) {\n          let cell = this.get(i, j);\n          callback(cell);\n        }\n      }\n    }\n  }\n\n  clear(rectRange, {\n    ignoreCorner = false,\n  } = {}) {\n    let { sri, eri } = rectRange;\n    let { sci, eci } = rectRange;\n    let { items } = this;\n    let { snapshot } = this;\n    let { length } = items;\n    let oldItems = [];\n    let effRiLength = eri - sri + 1;\n    let effCiLength = eci - sci + 1;\n    let action = {\n      undo: () => {\n        for (let ri = sri; ri <= eri; ri++) {\n          if (ri >= length) {\n            break;\n          }\n          let oldRowItem = oldItems[ri];\n          let rowItem = items[ri];\n          if (rowItem) {\n            for (let ci = sci; ci <= eci; ci++) {\n              if (ci >= length) {\n                break;\n              }\n              if (ignoreCorner) {\n                let firstRi = ri === sri;\n                let firstCi = ci === sci;\n                if (firstRi && firstCi) {\n                  continue;\n                }\n                rowItem[ci] = oldRowItem[ci];\n              } else {\n                rowItem[ci] = oldRowItem[ci];\n              }\n            }\n          }\n        }\n      },\n      redo: () => {\n        oldItems = new Array(effRiLength);\n        for (let ri = sri; ri <= eri; ri++) {\n          if (ri >= length) {\n            break;\n          }\n          let rowItem = items[ri];\n          if (rowItem) {\n            let oldRowItem = new Array(effCiLength);\n            let { length } = rowItem;\n            for (let ci = sci; ci <= eci; ci++) {\n              if (ci >= length) {\n                break;\n              }\n              if (ignoreCorner) {\n                let firstRi = ri === sri;\n                let firstCi = ci === sci;\n                if (firstRi && firstCi) {\n                  continue;\n                }\n                oldRowItem[ci] = rowItem[ci];\n                rowItem[ci] = undefined;\n              } else {\n                oldRowItem[ci] = rowItem[ci];\n                rowItem[ci] = undefined;\n              }\n            }\n            oldItems[ri] = oldRowItem;\n          }\n        }\n      },\n    };\n    snapshot.addAction(action);\n    action.redo();\n  }\n\n  setOrNew(ri, ci, item) {\n    const line = this.items[ri];\n    if (line) {\n      line[ci] = item;\n    }\n  }\n\n  removeRow(ri) {\n    let { snapshot } = this;\n    let orderValue;\n    let action = {\n      undo: () => {\n        if (orderValue) {\n          this.items.splice(ri, 0, orderValue);\n        }\n      },\n      redo: () => {\n        orderValue = this.items.splice(ri, 1)[0];\n      },\n    };\n    snapshot.addAction(action);\n    action.redo();\n  }\n\n  removeCol(ci) {\n    let { snapshot } = this;\n    let orderValue = [];\n    let action = {\n      undo: () => {\n        let { length } = orderValue;\n        for (let i = 0; i < length; i++) {\n          const value = orderValue[i];\n          const { ri, item } = value;\n          const subItems = this.items[ri];\n          subItems.splice(ci, 0, item);\n        }\n      },\n      redo: () => {\n        let { length } = this.items;\n        orderValue = [];\n        for (let ri = 0; ri < length; ri++) {\n          const subItems = this.items[ri];\n          if (subItems) {\n            const item = subItems.splice(ci, 1)[0];\n            orderValue.push({\n              ri, item,\n            });\n          }\n        }\n      },\n    };\n    snapshot.addAction(action);\n    action.redo();\n  }\n\n  insertRowAfter(ri) {\n    let { snapshot } = this;\n    let action = {\n      undo: () => {\n        this.items.splice(ri + 1, 1);\n      },\n      redo: () => {\n        const subItems = this.items[ri];\n        if (subItems) {\n          const newSubItems = [];\n          for (let i = 0, len = subItems.length; i < len; i++) {\n            const item = subItems[i];\n            if (item) {\n              const { mergeId } = item;\n              newSubItems[i] = { mergeId };\n            }\n          }\n          this.items.splice(ri + 1, 0, newSubItems);\n        } else {\n          this.items.splice(ri + 1, 0, []);\n        }\n      },\n    };\n    snapshot.addAction(action);\n    action.redo();\n  }\n\n  insertColAfter(ci) {\n    let { snapshot } = this;\n    let action = {\n      undo: () => {\n        for (let i = 0, len = this.items.length; i < len; i++) {\n          const subItems = this.items[i];\n          if (subItems) {\n            subItems.splice(ci + 1, 1);\n          }\n        }\n      },\n      redo: () => {\n        for (let i = 0, len = this.items.length; i < len; i++) {\n          const subItems = this.items[i];\n          if (subItems) {\n            const item = subItems[ci];\n            if (item) {\n              const { mergeId } = item;\n              subItems.splice(ci + 1, 0, { mergeId });\n            } else {\n              subItems.splice(ci + 1, 0, {});\n            }\n          }\n        }\n      },\n    };\n    snapshot.addAction(action);\n    action.redo();\n  }\n\n  insertRowBefore(ri) {\n    let { snapshot } = this;\n    let action = {\n      undo: () => {\n        this.items.splice(ri, 1);\n      },\n      redo: () => {\n        const subItems = this.items[ri];\n        if (subItems) {\n          const newSubItems = [];\n          for (let i = 0, len = subItems.length; i < len; i++) {\n            const item = subItems[i];\n            if (item) {\n              const { mergeId } = item;\n              newSubItems[i] = { mergeId };\n            }\n          }\n          this.items.splice(ri, 0, newSubItems);\n        } else {\n          this.items.splice(ri, 0, []);\n        }\n      },\n    };\n    snapshot.addAction(action);\n    action.redo();\n  }\n\n  insertColBefore(ci) {\n    let { snapshot } = this;\n    let action = {\n      undo: () => {\n        for (let i = 0, len = this.items.length; i < len; i++) {\n          const subItems = this.items[i];\n          if (subItems) {\n            subItems.splice(ci, 1);\n          }\n        }\n      },\n      redo: () => {\n        for (let i = 0, len = this.items.length; i < len; i++) {\n          const subItems = this.items[i];\n          if (subItems) {\n            const item = subItems[ci];\n            if (item) {\n              const { mergeId } = item;\n              subItems.splice(ci, 0, { mergeId });\n            } else {\n              subItems.splice(ci, 0, {});\n            }\n          }\n        }\n      },\n    };\n    snapshot.addAction(action);\n    action.redo();\n  }\n\n}\n\nexport {\n  XTableDataItems,\n};\n","import { Cell } from '../../core/xtable/tablecell/Cell';\r\nimport { XTableDataItems } from '../../core/xtable/XTableDataItems';\r\nimport { SheetUtils } from '../../utils/SheetUtils';\r\n\r\naddEventListener('message', (event) => {\r\n  const { data } = event;\r\n  const items = new XTableDataItems({\r\n    items: data\r\n  });\r\n  let total = 0;\r\n  let number = 0;\r\n  items.each(item => {\r\n    if (item) {\r\n      const cell = item.getCell();\r\n      if (cell.hasFormula()) {\r\n        const value = cell.getComputeText();\r\n        if (SheetUtils.isNumber(value)) {\r\n          total += SheetUtils.parseFloat(value);\r\n          number++;\r\n        }\r\n      } else {\r\n        switch (cell.contentType) {\r\n          case Cell.TYPE.NUMBER:\r\n            total += cell.getComputeText();\r\n            number++;\r\n            break;\r\n        }\r\n      }\r\n    }\r\n  });\r\n  postMessage({\r\n    total, number\r\n  });\r\n});\r\n"],"sourceRoot":""}