!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(){return(65536*(1+Math.random())|0).toString(16).substring(1)}n.r(t);var a=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],s={String:1,Boolean:2,Number:3,Object:4,Array:5,Function:6,Null:7,Undefined:8,Promise:9,GeneratorFunction:10,AsyncFunction:11,BigInt:12,Symbol:13,DedicatedWorkerGlobalScope:14,Date:15,Un:0},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,u;return t=e,n=null,u=[{key:"isWindows",value:function(){return/windows|win32/i.test(navigator.userAgent)}},{key:"isMac",value:function(){return/macintosh|mac os x/i.test(navigator.userAgent)}},{key:"isNotEmptyObject",value:function(t){return!e.isEmptyObject(t)}},{key:"isEmptyObject",value:function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}},{key:"isUnDef",value:function(e){return null==e}},{key:"isDef",value:function(e){return!this.isUnDef(e)}},{key:"isNumber",value:function(e){return/^(-?\d+.\d+)$|^(-?\d+)$/.test(e)}},{key:"isFraction",value:function(e){return/^\d+\/\d+$/.test(e)}},{key:"isDate",value:function(t){return e.type(t)===s.Date}},{key:"isFunction",value:function(t){return e.type(t)===s.Function}},{key:"isArray",value:function(t){return e.type(t)===s.Array}},{key:"isLikeArray",value:function(t){return!e.isUnDef(t)&&"number"==typeof t.length}},{key:"isBlank",value:function(t){return!!e.isUnDef(t)||""===t.toString().trim()}},{key:"isPlainObject",value:function(t){return!e.isUnDef(t)&&Object.getPrototypeOf(t)===Object.getPrototypeOf({})}},{key:"isString",value:function(t){return e.type(t)===s.String}},{key:"isChildType",value:function(e,t){return e instanceof t}},{key:"toLowCase",value:function(e){return e.toLowerCase()}},{key:"type",value:function(e){var t=Object.prototype.toString.call(e);switch(t){case"[object Null]":return s.Null;case"[object Object]":return s.Object;case"[object Undefined]":return s.Undefined;case"[object String]":return s.String;case"[object Boolean]":return s.Boolean;case"[object Number]":return s.Number;case"[object Function]":return s.Function;case"[object Array]":return s.Array;case"[object Promise]":return s.Promise;case"[object GeneratorFunction]":return s.GeneratorFunction;case"[object AsyncFunction]":return s.AsyncFunction;case"[object BigInt]":return s.BigInt;case"[object Symbol]":return s.Symbol;case"[object Date]":return s.Date;case"[object DedicatedWorkerGlobalScope]":return s.DedicatedWorkerGlobalScope;default:return s.Un}}},{key:"copy",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.isUnDef(t))return{};for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return e.isUnDef(r)||0===r.length||r.forEach((function(n){e.isUnDef(n)||Object.keys(n).forEach((function(r){var i=n[r];"string"==typeof i||"number"==typeof i||"boolean"==typeof i?t[r]=i:"function"!=typeof i&&!Array.isArray(i)&&e.isPlainObject(i)?(t[r]=t[r]||{},e.copy(t[r],i)):t[r]=i}))})),t}},{key:"cloneDeep",value:function(e){var t=JSON.stringify(e);return JSON.parse(t)}},{key:"extends",value:function(e){for(var t=0,n=arguments.length<=1?0:arguments.length-1;t<n;t++){var r=t+1<1||arguments.length<=t+1?void 0:arguments[t+1];for(var i in r)if(r.hasOwnProperty(i)){var o=r[i];o&&(e[i]=o)}}return e}},{key:"sum",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e},n=0,r=0;return Object.keys(e).forEach((function(i){n+=t(e[i],i),r+=1})),[n,r]}},{key:"parseFloat",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(t){return e.isNumber(t)?parseFloat(t):0}))},{key:"parseInt",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(t){return e.isNumber(t)?parseInt(t,10):0}))},{key:"stringAt",value:function(e){for(var t="",n=e;n>=a.length;)n/=a.length,n-=1,t+=a[parseInt(n,10)%a.length];return t+=a[e%a.length]}},{key:"indexAt",value:function(e){for(var t=0,n=0;n<e.length-1;n+=1){var r=e.charCodeAt(n)-65,i=e.length-1-n;t+=Math.pow(a.length,i)+a.length*r}return t+=e.charCodeAt(e.length-1)-65}},{key:"expr2xy",value:function(t){for(var n="",r="",i=0;i<t.length;i+=1)t.charAt(i)>="0"&&t.charAt(i)<="9"?r+=t.charAt(i):n+=t.charAt(i);return[e.indexAt(n),parseInt(r,10)-1]}},{key:"xy2expr",value:function(t,n){return"".concat(e.stringAt(t)).concat(n+1)}},{key:"expr2expr",value:function(t,n,i){var o=r(e.expr2xy(t),2),a=o[0],s=o[1];return e.xy2expr(a+n,s+i)}},{key:"minIf",value:function(e,t){return e<t?t:e}},{key:"keepLastIndex",value:function(e){var t=window.getSelection();t.selectAllChildren(e),t.collapseToEnd()}},{key:"trim",value:function(e){return this.isBlank(e)?"":e.trim()}},{key:"now",value:function(){return Date.now().toString()}},{key:"viewPort",value:function(){return{width:window.innerWidth,height:window.innerHeight}}},{key:"exitFullscreen",value:function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}},{key:"fullScreen",value:function(e){e.el&&(e=e.el),e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}},{key:"isFull",value:function(){return!!(document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||document.fullscreenElement)}},{key:"uuid",value:function(){return"".concat(o()+o()).concat(o()).concat(o()).concat(o()).concat(o()).concat(o()).concat(o())}},{key:"getExplorerInfo",value:function(){var e=window.navigator.userAgent.toLowerCase();return e.indexOf("firefox")>=0?{type:"Firefox",version:e.match(/firefox\/([\d.]+)/)[1]}:e.indexOf("chrome")>=0?{type:"Chrome",version:e.match(/chrome\/([\d.]+)/)[1]}:e.indexOf("opera")>=0?{type:"Opera",version:e.match(/opera.([\d.]+)/)[1]}:e.indexOf("safari")>=0?{type:"Safari",version:e.match(/version\/([\d.]+)/)[1]}:e.indexOf("msie")>=0?{type:"IE",version:e.match(/msie ([\d.]+)/)[1]}:void 0}},{key:"arrayLast",value:function(e){return e[e.length-1]}},{key:"arrayHead",value:function(e){return e[0]}},{key:"blankClear",value:function(t){return e.isString(t)?t.replace(/\s*/g,e.EMPTY):t}},{key:"equals",value:function(t,n){return!e.isUnDef(t)&&!e.isUnDef(n)&&JSON.stringify(t)===JSON.stringify(n)}},{key:"toFixed",value:function(e,t){return e.toString().indexOf(".")>-1?e.toFixed(t):e}},{key:"safeValue",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.isUnDef(t)?n:t}},{key:"inWorker",value:function(){return e.type(self)===s.DedicatedWorkerGlobalScope}},{key:"if",value:function(e,t,n){return e?t():n()}},{key:"slice",value:function(e){return Array.prototype.slice.call(e)}},{key:"clearBlank",value:function(e){return e.replace(/\s/g,"")}}],n&&i(t.prototype,n),u&&i(t,u),e}();function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}u.EMPTY="",u.Nul=null,u.Undef=void 0,u.noop=function(){},u.DATA_TYPE=s;var l=function(){function e(t){var n=t.draw,r=t.ruler,i=t.attr;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.draw=n,this.attr=i,this.ruler=r}var t,n,r;return t=e,(n=[{key:"setRuler",value:function(e){this.ruler=e}},{key:"getAlignPadding",value:function(){return this.attr.align===e.ALIGN.center?0:this.attr.padding}},{key:"getVerticalAlignPadding",value:function(){return this.attr.verticalAlign===e.VERTICAL_ALIGN.center?0:this.attr.padding}}])&&c(t.prototype,n),r&&c(t,r),e}();function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),e}l.VERTICAL_ALIGN={top:"top",center:"middle",bottom:"bottom"},l.ALIGN={left:"left",center:"center",right:"right"},l.TEXT_WRAP={OVER_FLOW:1,WORD_WRAP:2,TRUNCATE:3},l.TEXT_DIRECTION={HORIZONTAL:"horizontal",VERTICAL:"vertical",ANGLE:"angle",ANGLE_BAR:"bar"},l.DEFAULT_FONT_ATTR={name:"Arial",size:14,color:"rgb(0,0,0)",bold:!1,italic:!1,strikethrough:!1,underline:!1,angle:0,padding:8,align:l.ALIGN.left,textWrap:l.TEXT_WRAP.TRUNCATE,verticalAlign:l.VERTICAL_ALIGN.center,direction:l.TEXT_DIRECTION.HORIZONTAL},l.DEFAULT_RICH_ATTR={angle:0,padding:8,align:l.ALIGN.left,textWrap:l.TEXT_WRAP.TRUNCATE,verticalAlign:l.VERTICAL_ALIGN.center,direction:l.TEXT_DIRECTION.HORIZONTAL},l.DEFAULT_RICH_ITEM_ATTR={name:"Arial",size:14,color:"rgb(0,0,0)",bold:!1,italic:!1,strikethrough:!1,underline:!1};var y=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";h(this,e),"string"==typeof t?(this.el=document.createElement(t),n&&(this.el.className=n)):this.el=t,this.map={}}return v(e,null,[{key:"wrapElement",value:function(t){if([u.isArray(t),t instanceof HTMLCollection,t instanceof NodeList].includes(!0)){for(var n=[],r=0;r<t.length;r++){var i=t[r];i instanceof e?n.push(i):n.push(new e(i))}return n}return new e(t)}},{key:"createText",value:function(t){return new e(document.createTextNode(t))}},{key:"hyphenateRE",value:function(e){return e?e.replace(/([A-Z])/g,"-$1").toLowerCase():null}}]),v(e,[{key:"data",value:function(e,t){return void 0!==t?(this.map[e]=t,this):this.map[e]}},{key:"children",value:function(){for(var t=this,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return 0===arguments.length?e.wrapElement(this.el.children):(r.forEach((function(e){return t.append(e)})),this)}},{key:"childrenNodes",value:function(){for(var t=this,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return 0===arguments.length?e.wrapElement(this.el.childNodes):(r.forEach((function(e){return t.append(e)})),this)}},{key:"childrenNodesAppend",value:function(e){var t=this;return this.isTextNode()||e.childrenNodes().forEach((function(e){return t.append(e)})),this}},{key:"childrenNodesPrepend",value:function(e){var t=this;return this.isTextNode()||e.childrenNodes().forEach((function(e){return t.prepend(e)})),this}},{key:"append",value:function(e){return this.isTextNode()||e&&e.el&&this.el.append(e.el),this}},{key:"prepend",value:function(e){return this.isTextNode()||e&&e.el&&this.el.prepend(e.el),this}},{key:"offset",value:function(e){var t=this;if(void 0!==e)return Object.keys(e).forEach((function(n){t.css(n,"".concat(e[n],"px"))})),this;var n=this.el,r=n.offsetTop,i=n.offsetLeft,o=this.el;return{top:r,left:i,height:o.offsetHeight,width:o.offsetWidth}}},{key:"parent",value:function(){return this.el.parentNode?new e(this.el.parentNode):null}},{key:"addClass",value:function(e){return this.isTextNode()||this.el.classList.add(e),this}},{key:"hasClass",value:function(e){return!this.isTextNode()&&this.el.classList.contains(e)}},{key:"hasChildElement",value:function(){return this.children().length>0}},{key:"hasChild",value:function(){return this.childrenNodes().length>0}},{key:"removeClass",value:function(e){return this.isTextNode()||this.el.classList.remove(e),this}},{key:"box",value:function(){return this.isTextNode()?null:this.el.getBoundingClientRect()}},{key:"first",value:function(){return this.isTextNode()?null:e.wrapElement(this.el.firstChild)}},{key:"last",value:function(){return this.isTextNode()?null:e.wrapElement(this.el.lastChild)}},{key:"firstTextNode",value:function(){if(this.isTextNode())return this;var e=null;return function t(n){n.hasChild()&&n.childrenNodes().forEach((function(n){null===e&&t(n)})),null===e&&n.isTextNode()&&(e=n)}(this),e}},{key:"lastTextNode",value:function(){if(this.isTextNode())return this;var e=null;return function t(n){n.hasChild()&&n.childrenNodes().reverse().forEach((function(n){null===e&&t(n)})),null===e&&n.isTextNode()&&(e=n)}(this),e}},{key:"remove",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(e)this.isTextNode()||this.el.removeChild(e.el||e);else{var t=this.parent();t&&this.parent().remove(this)}return this}},{key:"contains",value:function(e){return!this.isTextNode()&&this.el.contains(e.el)}},{key:"prev",value:function(){return this.el.previousSibling?e.wrapElement(this.el.previousSibling):null}},{key:"next",value:function(){return this.el.nextSibling?e.wrapElement(this.el.nextSibling):null}},{key:"active",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"active";return this.isTextNode()||(e?this.addClass(t):this.removeClass(t)),this}},{key:"text",value:function(e){return this.isTextNode()?this.nodeValue():void 0!==e?(this.el.innerText=e,this):this.el.innerText}},{key:"html",value:function(e){return this.isTextNode()?this.nodeValue():void 0!==e?(this.el.innerHTML=e,this):this.el.innerHTML}},{key:"focus",value:function(){return this.isTextNode()||this.el.focus(),this}},{key:"blur",value:function(){return this.isTextNode()||this.el.blur(),this}},{key:"removeAttr",value:function(e){return this.isTextNode()||this.el.removeAttribute(e),this}},{key:"style",value:function(e){return this.isTextNode()||this.attr("style",e),this}},{key:"attr",value:function(e,t){var n=this;if(!this.isTextNode())if(void 0!==t)this.el.setAttribute&&this.el.setAttribute(e,t);else{if("string"==typeof e)return this.el.setAttribute?this.el.getAttribute(e):null;this.el.setAttribute&&Object.keys(e).forEach((function(t){n.el.setAttribute(t,e[t])}))}return this}},{key:"val",value:function(e){return this.isTextNode()?void 0===e?this.nodeValue():this:void 0!==e?(this.el.value=e,this):this.el.value}},{key:"get",value:function(){return this.el}},{key:"cssRemoveKeys",value:function(){var t=this;if(!this.isTextNode()&&this.el.style){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach((function(n){t.el.style&&t.el.style.removeProperty(e.hyphenateRE(n))}))}return this}},{key:"cssRemoveVal",value:function(t,n){if(!this.isTextNode()&&this.el.style){var r=e.hyphenateRE(t),i=this.el.style.getPropertyValue(r).replace(n,"");this.css(t,i)}return this}},{key:"css",value:function(t,n){var r=this;if(!this.isTextNode()&&this.el.style){if(void 0===n&&"string"!=typeof t)return Object.keys(t).forEach((function(n){var i=e.hyphenateRE(n);r.el.style.setProperty(i,t[n])})),this;if(void 0!==n){var i=e.hyphenateRE(t);return this.el.style.setProperty(i,n),this}var o=e.hyphenateRE(t);return this.el.style.getPropertyValue(o)}return null}},{key:"computedStyle",value:function(){return this.isTextNode()?null:window.getComputedStyle(this.el,null)}},{key:"show",value:function(){if(!this.isTextNode()){var e=this.computedStyle();e&&"block"!==e.display&&this.css("display","block")}return this}},{key:"hide",value:function(){if(!this.isTextNode()){var e=this.computedStyle();e&&"none"!==e.display&&this.css("display","none")}return this}},{key:"trigger",value:function(e,t){if(!this.isTextNode())switch(e){case"click":var n=new MouseEvent(e,{detail:t,bubbles:!0,cancelable:!1});n.initEvent("click",!0,!0),this.el.dispatchEvent(n);break;default:var r=new CustomEvent(e,{detail:t,bubbles:!0,cancelable:!1});this.el.dispatchEvent(r)}}},{key:"find",value:function(t){if(!this.isTextNode()){var n=this.el.querySelectorAll(t);if(n&&1===n.length)return new e(n[0]);var r=[];if(n){var i=!0,o=!1,a=void 0;try{for(var s,u=n[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;r.push(new e(c))}}catch(e){o=!0,a=e}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}}return r}return[]}},{key:"finds",value:function(t){if(!this.isTextNode()){var n=this.el.querySelectorAll(t),r=[];if(n){var i=!0,o=!1,a=void 0;try{for(var s,u=n[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;r.push(new e(c))}}catch(e){o=!0,a=e}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}}return r}return[]}},{key:"sibling",value:function(){for(var t=this.el,n=[];null!==(t=t.previousElementSibling);)n.push(new e(t));for(t=this.el;null!==(t=t.nextElementSibling);)n.push(new e(t));return n}},{key:"tagName",value:function(){return this.el.nodeName.toLocaleLowerCase()}},{key:"nodeValue",value:function(){return this.el.nodeValue}},{key:"nodeType",value:function(){return this.el.nodeType}},{key:"after",value:function(e){return this.el&&e&&e.el&&this.el.after(e.el),this}},{key:"before",value:function(e){return this.el&&e&&e.el&&this.el.before(e.el),this}},{key:"clone",value:function(){return new e(this.el.cloneNode(!0))}},{key:"empty",value:function(){return this.isTextNode()||this.html(""),this}},{key:"equals",value:function(e){return this.el===e.el}},{key:"index",value:function(){var e=this,t=this.parent(),n=-1;return t.childrenNodes().forEach((function(t,r){t.equals(e)&&(n=r)})),n}},{key:"is",value:function(e){return this.el===e.el}},{key:"isTextNode",value:function(){return"#text"===this.tagName()}},{key:"isBreakNode",value:function(){return"br"===this.tagName()}},{key:"isDocumentFragment",value:function(){return this.el instanceof DocumentFragment}}]),e}(),p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new y(e,t)},d=("".concat("x-sheet"," 1.0.0-develop"),{});function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function k(e,t,n){return t&&b(e.prototype,t),n&&b(e,n),e}d.WORK_BODY_EVENT_TYPE={CHANGE_ACTIVE:"changeactive",REMOVE_SHEET:"removesheet"},d.SYSTEM_EVENT_TYPE={MOUSE_MOVE:"mousemove",MOUSE_DOWN:"mousedown",CONTEXT_MENU:"contextmenu",SCROLL:"scroll",RESIZE:"resize",MOUSE_UP:"mouseup",INPUT:"input",KEY_DOWN:"keydown",KEY_UP:"keyup",MOUSE_OVER:"mouseover",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",MOUSE_ENTER:"mouseenter",CLICK:"click",FOCUS:"focus",DRAG_START:"dragstart",CHANGE:"change",VISIBILITY_CHANGE:"visibilitychange"},d.TABLE_EVENT_TYPE={RENDER:"render",SNAPSHOT_CHANGE:"snapshotchange",CHANGE_ROW_HEIGHT:"changerowheight",CHANGE_COL_WIDTH:"changecolwidth",SCALE_CHANGE:"scalechange",EDIT_START:"editstart",EDIT_INPUT:"editinput",EDIT_FINISH:"editfinish",REMOVE_ROW:"removerow",REMOVE_COL:"removecol",ADD_NEW_ROW:"addnewrow",ADD_NEW_COL:"addnewcol",FIXED_CHANGE:"fixedchange",FIXED_COL_CHANGE:"fixedcolchange",FIXED_ROW_CHANGE:"fixedrowchange",SELECT_OVER:"selectover",SELECT_DOWN:"selectdown",SELECT_CHANGE:"selectchange",DATA_CHANGE:"datachange",RESIZE_CHANGE:"resizechange"},d.FORM_EVENT_TYPE={SEARCH_INPUT_CHANGE:"searchinputchange",PLAIN_INPUT_CHANGE:"plaininputchange",FORM_SELECT_CHANGE:"formselectchange"};var m=new(function(){function e(){g(this,e),this.pool=[]}return k(e,[{key:"unbind",value:function(e,t,n,r){e instanceof y&&(e=e.el);var i=this.remove(e,t,n,r);i.length?i.forEach((function(t){e.removeEventListener(t.type,t.callback,t.option)})):e.removeEventListener(t,n,r)}},{key:"bind",value:function(e,t,n,r){e instanceof y&&(e=e.el),this.pool.push({ele:e,type:t,callback:n,option:r}),e.addEventListener(t,n,r)}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=[],o=[];return this.pool.forEach((function(a){var s=e===a.ele,u=null===r||r===a.option,c="*"===t||t===a.type,l=null===n||n===a.callback;s&&c&&l&&u?o.push(a):i.push(a)})),this.pool=i,o}},{key:"multipleUnbind",value:function(e,t,n,r){var i=this;e.forEach((function(e){i.unbind(e,t,n,r)}))}},{key:"multipleBind",value:function(e,t,n,r){var i=this;e.forEach((function(e){i.bind(e,t,n,r)}))}}]),e}()),T=function(){function e(){g(this,e)}return k(e,null,[{key:"unbind",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Array.isArray(e)?m.multipleUnbind(e,t,n,r):m.unbind(e,t,n,r),e}},{key:"bind",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Array.isArray(e)?m.multipleBind(e,t,n,r):m.bind(e,t,n,r),e}},{key:"mouseHold",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:150,o=setInterval((function(){n()}),i),a=function n(i){clearInterval(o),e.unbind(t,d.SYSTEM_EVENT_TYPE.MOUSE_UP,n,!0),r(i)};n(),e.bind(t,d.SYSTEM_EVENT_TYPE.MOUSE_UP,a,!0)}},{key:"mouseMoveUp",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=function(e){n(e),e.stopPropagation(),e.preventDefault()},o=function n(o){e.unbind(t,d.SYSTEM_EVENT_TYPE.MOUSE_MOVE,i,!0),e.unbind(t,d.SYSTEM_EVENT_TYPE.MOUSE_UP,n,!0),r(o),o.preventDefault()};return e.bind(t,d.SYSTEM_EVENT_TYPE.MOUSE_MOVE,i,!0),e.bind(t,d.SYSTEM_EVENT_TYPE.MOUSE_UP,o,!0),t}}]),e}();function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function O(e,t,n){return t&&E(e.prototype,t),n&&E(e,n),e}function N(e,t){return!t||"object"!==w(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function I(e){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function C(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P(e,t)}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}T.WrapFuncion={doubleClick:function(e){var t=0,n=0,r=0;return function(i){if(2===i.button)return t=0,r=0,void(n=0);var o=i.pageX,a=i.pageY,s=Date.now();s-r<=300&&o===t&&a===n?(e(i),r=0,t=0,n=0):(t=o,n=a,r=s)}},mouseClick:function(e){return function(t){e(t)}}};var _=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"div",i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return x(this,t),(e=N(this,"string"==typeof n?I(t).call(this,r,"".concat("x-sheet","-widget ").concat(n)):I(t).call(this,n))).$$rootFlag=i,N(e)}return C(t,e),O(t,[{key:"closestClass",value:function(e){for(var t=this;!p(document.body).is(t);){if(t.hasClass(e))return t;t=t.parent()}return null}},{key:"getRootWidget",value:function(){for(var e=this.data("parent");e&&!e.$$rootFlag;)e=e.data("parent");return e}},{key:"bind",value:function(){}},{key:"unbind",value:function(){T.unbind(this)}},{key:"attach",value:function(e){this.childrenNodes(e),e.parentWidget(this),e.onAttach(this)}},{key:"parentWidget",value:function(e){return e?(this.data("parent",e),this):this.data("parent")}},{key:"eventXy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,n=t.box(),r=n.top,i=n.left;return{y:e.clientY-r,x:e.clientX-i}}},{key:"destroy",value:function(){this.unbind(),this.remove()}}]),t}(function(e){function t(){return x(this,t),N(this,I(t).apply(this,arguments))}return C(t,e),O(t,[{key:"onAttach",value:function(){}}]),t}(y));function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function M(e,t){return!t||"object"!==S(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function D(e,t){return(D=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var j=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return A(this,t),(e=M(this,L(t).call(this,"".concat("x-sheet","-icon")))).iconNameEl=p("div","".concat("x-sheet","-icon-img ").concat(n)),e.childrenNodes(e.iconNameEl),e}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&D(e,t)}(t,e),n=t,(r=[{key:"setWidth",value:function(e){this.iconNameEl.css("width","".concat(e,"px"))}},{key:"setHeight",value:function(e){this.iconNameEl.css("height","".concat(e,"px"))}}])&&R(n.prototype,r),i&&R(n,i),t}(_);function F(e){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function H(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function W(e,t){return(W=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function U(e,t,n){return(U="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=G(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function G(e){return(G=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var V=[],B=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t){return!t||"object"!==F(t)&&"function"!=typeof t?Y(e):t}(this,G(t).call(this,"".concat("x-sheet","-drag-panel"))),V.push(Y(n)),n.options=u.copy({position:t.DRAG_PANEL_POSITION.CENTER},e),n.status=!1,n.mask=p("div","".concat("x-sheet","-drag-panel-mask")),n.content=p("div","".concat("x-sheet","-drag-panel-content")),U(G(t.prototype),"childrenNodes",Y(n)).call(Y(n),n.content),n.bind(),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W(e,t)}(t,e),n=t,i=[{key:"removeInstance",value:function(e){var t=[];V.forEach((function(n){n!==e&&t.push(n)})),V=t}},{key:"closeAll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];V.forEach((function(t){-1===e.indexOf(t)&&t.close()}))}}],(r=[{key:"open",value:function(){var e=this.getRootWidget(),t=this.mask;return!1===this.status&&e&&(this.status=!0,e.childrenNodes(t),e.childrenNodes(this),this.dragPanelLocation()),this}},{key:"close",value:function(){var e=this.getRootWidget();if(!0===this.status&&e){var t=this.mask;this.status=!1,e.remove(this),e.remove(t)}return this}},{key:"unbind",value:function(){var e=this.mask;T.unbind(e)}},{key:"bind",value:function(){var e=this,t=this.mask;T.bind(t,d.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){e.close(),t.stopPropagation()})),T.bind(this,d.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){if(0===t.button){var n=e.eventXy(t,e);T.mouseMoveUp(p(document),(function(t){var r=t.pageY-n.y,i=t.pageX-n.x;e.offset({top:r,left:i}),t.stopPropagation()})),t.stopPropagation()}}))}},{key:"dragPanelLocation",value:function(){var e=this.getRootWidget(),n=this.options.position,r=e.box(),i=this.box();switch(n){case t.DRAG_PANEL_POSITION.LEFT:case t.DRAG_PANEL_POSITION.RIGHT:case t.DRAG_PANEL_POSITION.TOP:break;case t.DRAG_PANEL_POSITION.CENTER:this.offset({left:r.width/2-i.width/2,top:r.height/2-i.height/2})}return this}},{key:"childrenNodes",value:function(){var e;return(e=this.content).childrenNodes.apply(e,arguments),this}},{key:"destroy",value:function(){U(G(t.prototype),"destroy",this).call(this),this.unbind(),t.removeInstance(this)}}])&&H(n.prototype,r),i&&H(n,i),t}(_);function z(e){return(z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function X(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function q(e,t,n){return(q="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=K(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function K(e){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $(e,t){return($=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}B.DRAG_PANEL_POSITION={LEFT:1,TOP:2,RIGHT:3,CENTER:4};var J=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t){return!t||"object"!==z(t)&&"function"!=typeof t?Z(e):t}(this,K(t).call(this,"".concat("x-sheet","-color-picker")))).options=u.copy({selectCb:function(){}},e),n.dragPanel=(new B).parentWidget(Z(n)),n.color=[360,0,100],n.preViewColorPoint=p("div","".concat("x-sheet","-color-picker-pre-view-color-point")),n.colorValueTips=p("div","".concat("x-sheet","-color-picker-color-value-tips")),n.colorValueTips.text("十六进制颜色值"),n.colorInput=p("input","".concat("x-sheet","-color-picker-color-input")),n.top=p("div","".concat("x-sheet","-color-picker-top")),n.top.childrenNodes(n.preViewColorPoint),n.top.childrenNodes(n.colorValueTips),n.top.childrenNodes(n.colorInput),n.selectColorPoint=p("div","".concat("x-sheet","-color-picker-select-color-point")),n.selectColorArea1=p("div","".concat("x-sheet","-color-picker-select-color-area area1")),n.selectColorArea2=p("div","".concat("x-sheet","-color-picker-select-color-area area2")),n.selectColorArea3=p("div","".concat("x-sheet","-color-picker-select-color-area area3")),n.center=p("div","".concat("x-sheet","-color-picker-center")),n.center.childrenNodes(n.selectColorArea1),n.center.childrenNodes(n.selectColorArea2),n.center.childrenNodes(n.selectColorArea3),n.center.childrenNodes(n.selectColorPoint),n.colorHuxTips=p("div","".concat("x-sheet","-color-picker-color-hux-tips")),n.colorBar=p("div","".concat("x-sheet","-color-picker-color-bar")),n.colorBarPoint=p("div","".concat("x-sheet","-color-picker-bar-point")),n.bottom=p("div","".concat("x-sheet","-color-picker-bottom")),n.colorHuxTips.text("HUE"),n.colorBar.childrenNodes(n.colorBarPoint),n.bottom.childrenNodes(n.colorHuxTips),n.bottom.childrenNodes(n.colorBar),n.cancelButton=p("div","".concat("x-sheet","-color-picker-button cancel")),n.selectButton=p("div","".concat("x-sheet","-color-picker-button select")),n.buttons=p("div","".concat("x-sheet","-color-picker-buttons")),n.cancelButton.text("取消"),n.selectButton.text("确定"),n.buttons.childrenNodes(n.selectButton),n.buttons.childrenNodes(n.cancelButton),n.childrenNodes(n.top),n.childrenNodes(n.center),n.childrenNodes(n.bottom),n.childrenNodes(n.buttons),n.dragPanel.childrenNodes(Z(n)),n.dragPanel.css("background","#ffffff"),n.bind(),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$(e,t)}(t,e),n=t,i=[{key:"fixHex",value:function(e){var t=6-e.length;if(t>0){for(var n=[],r=0;r<t;r+=1)n.push("0");n.push(e),e=n.join("")}return e}},{key:"fixHsx",value:function(e){return{h:Math.min(360,Math.max(0,e.h)),s:Math.min(100,Math.max(0,e.s)),x:Math.min(100,Math.max(0,e.x))}}},{key:"isRgb",value:function(e){return e.startsWith("rgb")}},{key:"isHex",value:function(e){return e.startsWith("#")}},{key:"isDark",value:function(e){if(u.isString(e)){if(this.isHex(e)){var n=t.hexToRgb(e);e="rgb(".concat(n.r,", ").concat(n.g,", ").concat(n.b,")")}var r=t.parseRgb(e);return.299*r.r+.578*r.g+.114*r.b>=192}return!1}},{key:"hexToRgb",value:function(e){return{r:(e=parseInt(e.indexOf("#")>-1?e.substring(1):e,16))>>16,g:(65280&e)>>8,b:255&e}}},{key:"hexToHsb",value:function(e){return this.rgbToHsb(this.hexToRgb(e))}},{key:"rgbToHsb",value:function(e){var t={h:0,s:0,x:0},n=Math.min(e.r,e.g,e.b),r=Math.max(e.r,e.g,e.b),i=r-n;return t.x=r,t.s=0!==r?255*i/r:0,0!==t.s?e.r===r?t.h=(e.g-e.b)/i:e.g===r?t.h=2+(e.b-e.r)/i:t.h=4+(e.r-e.g)/i:t.h=-1,t.h*=60,t.h<0&&(t.h+=360),t.s*=100/255,t.x*=100/255,t}},{key:"hsbToRgb",value:function(e){var t={},n=e.h,r=255*e.s/100,i=255*e.x/100;if(0===r)t.r=i,t.g=i,t.b=i;else{var o=i,a=(255-r)*i/255,s=n%60*(o-a)/60;360===n&&(n=0),n<60?(t.r=o,t.b=a,t.g=a+s):n<120?(t.g=o,t.b=a,t.r=o-s):n<180?(t.g=o,t.r=a,t.b=a+s):n<240?(t.b=o,t.r=a,t.g=o-s):n<300?(t.b=o,t.g=a,t.r=a+s):n<360?(t.r=o,t.g=a,t.b=o-s):(t.r=0,t.g=0,t.b=0)}return{r:Math.round(t.r),g:Math.round(t.g),b:Math.round(t.b)}}},{key:"rgbToHex",value:function(e){var t=[e.r.toString(16),e.g.toString(16),e.b.toString(16)];return t.forEach((function(e,n){1===e.length&&(t[n]="0".concat(e))})),t.join("")}},{key:"hsbToHex",value:function(e){return this.rgbToHex(this.hsbToRgb(e))}},{key:"parseRgb",value:function(e){var t=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return{r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10)}}},{key:"parseRgbToHex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e){if(this.isHex(e))return e.substring(1);var n=this.parseRgb(e);return this.rgbToHex(n)}return t}},{key:"parseHexToRgb",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e){var r=t.hexToRgb(e);return"rgb(".concat(r.r,",").concat(r.g,",").concat(r.b,")")}return n}}],(r=[{key:"unbind",value:function(){var e=this.selectColorPoint,t=this.colorBarPoint,n=this.colorInput,r=this.cancelButton,i=this.selectButton;T.unbind(n),T.unbind(n),T.unbind(t),T.unbind(e),T.unbind(r),T.unbind(i)}},{key:"bind",value:function(){var e=this,n=this.selectColorPoint,r=this.center,i=this.colorBarPoint,o=this.colorBar,a=this.colorInput,s=this.cancelButton,u=this.selectButton;T.bind(a,d.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(e){e.stopPropagation()})),T.bind(a,d.SYSTEM_EVENT_TYPE.CHANGE,(function(){var t=a.val();t&&e.hexColor(t)})),T.bind(i,d.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){var n=e.eventXy(t,o),r=o.box();n.x<0&&(n.x=0),n.x>r.width&&(n.x=r.width),e.downHue(n.x,r.width),T.mouseMoveUp(p(document),(function(t){var n=e.eventXy(t,o),r=o.box();n.x<0&&(n.x=0),n.x>r.width&&(n.x=r.width),e.moveHue(n.x,r.width)})),t.stopPropagation()})),T.bind(n,d.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(t){var n=e.eventXy(t,r),i=r.box();n.x<0&&(n.x=0),n.x>i.width&&(n.x=i.width),n.y<0&&(n.y=0),n.y>i.height&&(n.y=i.height),e.downSelect(n.x,n.y,i.width,i.height),T.mouseMoveUp(p(document),(function(t){var n=e.eventXy(t,r);n.x<0&&(n.x=0),n.x>i.width&&(n.x=i.width),n.y<0&&(n.y=0),n.y>i.height&&(n.y=i.height),e.moveSelect(n.x,n.y,i.width,i.height)})),t.stopPropagation()})),T.bind(s,d.SYSTEM_EVENT_TYPE.CLICK,(function(){e.close()})),T.bind(u,d.SYSTEM_EVENT_TYPE.CLICK,(function(){var n=e.color,r=t.fixHsx({h:parseInt(n[0],10),s:parseInt(n[1],10),x:parseInt(n[2],10)}),i=t.hsbToRgb(r);e.options.selectCb("rgb(".concat(i.r,",").concat(i.g,",").concat(i.b,")")),e.close()}))}},{key:"open",value:function(e){if(this.dragPanel.open(),e){if(t.isRgb(e)){var n=t.parseRgb(e);e=t.rgbToHex(n)}this.hexColor(e)}else this.change();return this}},{key:"close",value:function(){return this.dragPanel.close(),this}},{key:"sliderPosition",value:function(e){var t=this.colorBar,n=this.colorBarPoint,r=n.box(),i=t.box(),o=parseInt(i.width-i.width*e.h/360,10);o-=r.width/2,n.offset({left:o});var a=this.center,s=this.selectColorPoint,u=s.box(),c=a.box(),l=parseInt(c.width*e.s/100,10),h=parseInt(c.height*(100-e.x)/100,10);l-=u.width/2,h-=u.height/2,s.offset({left:l,top:h})}},{key:"hueChange",value:function(){var e=this.color,n=t.fixHsx({h:parseInt(e[0],10),s:parseInt(e[1],10),x:parseInt(e[2],10)}),r=this.colorBarPoint,i=this.selectColorPoint,o=this.preViewColorPoint,a=this.selectColorArea1,s=this.colorInput,u=t.hsbToHex(n),c=t.hsbToHex({h:n.h,s:100,x:100});i.css("backgroundColor","#".concat(u)),o.css("backgroundColor","#".concat(u)),r.css("backgroundColor","#".concat(c)),a.css("backgroundColor","#".concat(c)),s.val("#".concat(u)),this.sliderPosition(n)}},{key:"selectChange",value:function(){var e=this.color,n=t.fixHsx({h:parseInt(e[0],10),s:parseInt(e[1],10),x:parseInt(e[2],10)}),r=this.preViewColorPoint,i=this.selectColorPoint,o=this.colorInput,a=t.hsbToHex(n);i.css("backgroundColor","#".concat(a)),r.css("backgroundColor","#".concat(a)),o.val("#".concat(a)),this.sliderPosition(n)}},{key:"change",value:function(){this.hueChange(),this.selectChange()}},{key:"downSelect",value:function(e,t,n,r){var i=this.color;i[1]=parseInt(100*e/n,10),i[2]=parseInt(100*(r-t)/r,10),this.selectChange()}},{key:"moveSelect",value:function(e,t,n,r){var i=this.color;i[1]=parseInt(100*Math.max(0,Math.min(n,e))/n,10),i[2]=parseInt(100*(r-Math.max(0,Math.min(r,t)))/r,10),this.selectChange()}},{key:"downHue",value:function(e,t){this.color[0]=parseInt(360*(t-e)/t,10),this.hueChange()}},{key:"moveHue",value:function(e,t){this.color[0]=parseInt(360*(t-Math.max(0,Math.min(t,e)))/t,10),this.hueChange()}},{key:"hexColor",value:function(e){var n=this.color,r=t.hexToHsb(t.fixHex(e));n[0]=r.h,n[1]=r.s,n[2]=r.x,this.change()}},{key:"destroy",value:function(){q(K(t.prototype),"destroy",this).call(this),this.unbind(),this.dragPanel.destroy()}}])&&X(n.prototype,r),i&&X(n,i),t}(_);function Q(e){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function te(e,t){return!t||"object"!==Q(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ne(e){return(ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function re(e,t){return(re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ie=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=te(this,ne(t).call(this,"".concat("x-sheet","-color-array-item")))).options=u.copy({color:null,icon:null},e),n.icon=n.options.icon,n.color=u.blankClear(n.options.color),n.icon&&n.childrenNodes(n.options.icon),n.color&&(n.css("backgroundColor",n.color),J.isDark(n.options.color)?(n.checkedIcon=new j("checked-dark"),n.childrenNodes(n.checkedIcon)):(n.checkedIcon=new j("checked-light"),n.childrenNodes(n.checkedIcon)),n.checkedIcon.hide()),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&re(e,t)}(t,e),n=t,(r=[{key:"setActive",value:function(e){this.checkedIcon&&(e?this.checkedIcon.show():this.checkedIcon.hide())}}])&&ee(n.prototype,r),i&&ee(n,i),t}(_);function oe(e){return(oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function se(e,t){return!t||"object"!==oe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ue(e,t,n){return(ue="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ce(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function ce(e){return(ce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function le(e,t){return(le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var he=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=se(this,ce(t).call(this,"".concat("x-sheet","-color-array")))).options=u.copy({colors:[new ie({color:"rgb(0, 0, 0)"}),new ie({color:"rgb(67, 67, 67)"}),new ie({color:"rgb(102, 102, 102)"}),new ie({color:"rgb(153, 153, 153)"}),new ie({color:"rgb(183, 183, 183)"}),new ie({color:"rgb(204, 204, 204)"}),new ie({color:"rgb(217, 217, 217)"}),new ie({color:"rgb(239, 239, 239)"}),new ie({color:"rgb(255, 255, 255)"}),new ie({color:"rgb(152, 0, 0)"}),new ie({color:"rgb(255, 0, 0)"}),new ie({color:"rgb(255, 153, 0)"}),new ie({color:"rgb(255, 255, 0)"}),new ie({color:"rgb(0, 255, 0)"}),new ie({color:"rgb(0, 255, 255)"}),new ie({color:"rgb(74, 134, 232)"}),new ie({color:"rgb(0, 0, 255)"}),new ie({color:"rgb(153, 0, 255)"}),new ie({color:"rgb(255, 0, 255)"}),new ie({color:"rgb(230, 184, 175)"}),new ie({color:"rgb(244, 204, 204)"}),new ie({color:"rgb(252, 229, 205)"}),new ie({color:"rgb(255, 242, 204)"}),new ie({color:"rgb(217, 234, 211)"}),new ie({color:"rgb(208, 224, 227)"}),new ie({color:"rgb(201, 218, 248)"}),new ie({color:"rgb(207, 226, 243)"}),new ie({color:"rgb(217, 210, 233)"}),new ie({color:"rgb(234, 209, 220)"}),new ie({color:"rgb(221, 126, 107)"}),new ie({color:"rgb(234, 153, 153)"}),new ie({color:"rgb(249, 203, 156)"}),new ie({color:"rgb(255, 229, 153)"}),new ie({color:"rgb(182, 215, 168)"}),new ie({color:"rgb(162, 196, 201)"}),new ie({color:"rgb(164, 194, 244)"}),new ie({color:"rgb(159, 197, 232)"}),new ie({color:"rgb(180, 167, 214)"}),new ie({color:"rgb(213, 166, 189)"}),new ie({color:"rgb(204, 65, 37)"}),new ie({color:"rgb(224, 102, 102)"}),new ie({color:"rgb(246, 178, 107)"}),new ie({color:"rgb(255, 217, 102)"}),new ie({color:"rgb(147, 196, 125)"}),new ie({color:"rgb(118, 165, 175)"}),new ie({color:"rgb(109, 158, 235)"}),new ie({color:"rgb(111, 168, 220)"}),new ie({color:"rgb(142, 124, 195)"}),new ie({color:"rgb(194, 123, 160)"}),new ie({color:"rgb(166, 28, 0)"}),new ie({color:"rgb(204, 0, 0)"}),new ie({color:"rgb(230, 145, 56)"}),new ie({color:"rgb(241, 194, 50)"}),new ie({color:"rgb(106, 168, 79)"}),new ie({color:"rgb(69, 129, 142)"}),new ie({color:"rgb(60, 120, 216)"}),new ie({color:"rgb(61, 133, 198)"}),new ie({color:"rgb(103, 78, 167)"}),new ie({color:"rgb(166, 77, 121)"}),new ie({color:"rgb(133, 32, 12)"}),new ie({color:"rgb(153, 0, 0)"}),new ie({color:"rgb(180, 95, 6)"}),new ie({color:"rgb(191, 144, 0)"}),new ie({color:"rgb(56, 118, 29)"}),new ie({color:"rgb(19, 79, 92)"}),new ie({color:"rgb(17, 85, 204)"}),new ie({color:"rgb(11, 83, 148)"}),new ie({color:"rgb(53, 28, 117)"}),new ie({color:"rgb(116, 27, 71)"}),new ie({color:"rgb(91, 15, 0)"}),new ie({color:"rgb(102, 0, 0)"}),new ie({color:"rgb(120, 63, 4)"}),new ie({color:"rgb(127, 96, 0)"}),new ie({color:"rgb(39, 78, 19)"}),new ie({color:"rgb(12, 52, 61)"}),new ie({color:"rgb(28, 69, 135)"}),new ie({color:"rgb(7, 55, 99)"}),new ie({color:"rgb(32, 18, 77)"}),new ie({color:"rgb(76, 17, 48)"})],selectCb:function(){}},e),n.colors=[],n.activeColor=null,n.options.colors.forEach((function(e){n.add(e)})),n.colors.length>0&&n.setActiveByColor(n.colors[0].options.color),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&le(e,t)}(t,e),n=t,(r=[{key:"add",value:function(e){-1===this.colors.findIndex((function(t){return t.color===e.color}))&&(this.colors.push(e),this.childrenNodes(e),this.bind(e))}},{key:"unbind",value:function(){this.colors.forEach((function(e){T.unbind(e)}))}},{key:"bind",value:function(e){var t=this;T.bind(e,d.SYSTEM_EVENT_TYPE.MOUSE_DOWN,(function(){t.options.selectCb(e),e.options.color&&t.setActiveByColor(e.options.color)}))}},{key:"findItemByColor",value:function(e){return e=u.blankClear(e),this.colors.find((function(t){return t.color===e}))}},{key:"setActiveByColor",value:function(e){var t=this;e=u.blankClear(e),this.colors.forEach((function(n){n.color===e?(n.setActive(!0),t.activeColor=n.color):n.setActive(!1)}))}},{key:"clear",value:function(){this.unbind(),this.colors=[],this.empty()}},{key:"destroy",value:function(){ue(ce(t.prototype),"destroy",this).call(this),this.unbind()}}])&&ae(n.prototype,r),i&&ae(n,i),t}(_);function fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}he.BLACK="rgb(0, 0, 0)",he.WHITE="rgb(255, 255, 255)";var ve=function(){function e(t){var n=t.align,r=void 0===n?l.ALIGN.left:n,i=t.verticalAlign,o=void 0===i?l.VERTICAL_ALIGN.center:i,a=t.textWrap,s=void 0===a?l.TEXT_WRAP.TRUNCATE:a,u=t.strikethrough,c=void 0!==u&&u,h=t.underline,f=void 0!==h&&h,v=t.color,y=void 0===v?he.BLACK:v,p=t.name,d=void 0===p?"Arial":p,g=t.size,b=void 0===g?14:g,k=t.bold,m=void 0!==k&&k,T=t.italic,w=void 0!==T&&T,x=t.angle,E=void 0===x?0:x,O=t.direction,N=void 0===O?l.TEXT_DIRECTION.HORIZONTAL:O,I=t.padding,C=void 0===I?5:I;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.align=r,this.verticalAlign=o,this.textWrap=s,this.strikethrough=c,this.underline=f,this.color=y,this.name=d,this.size=b,this.bold=m,this.italic=w,this.direction=N,this.angle=E,this.padding=C}var t,n,r;return t=e,(n=[{key:"clone",value:function(){return new e({align:this.align,verticalAlign:this.verticalAlign,textWrap:this.textWrap,strikethrough:this.strikethrough,underline:this.underline,color:this.color,name:this.name,size:this.size,bold:this.bold,italic:this.italic,angle:this.angle,direction:this.direction,padding:this.padding})}},{key:"reset",value:function(){this.align=l.ALIGN.left,this.verticalAlign=l.VERTICAL_ALIGN.center,this.textWrap=l.TEXT_WRAP.TRUNCATE,this.strikethrough=!1,this.underline=!1,this.color=he.BLACK,this.name="Arial",this.size=14,this.bold=!1,this.italic=!1,this.angle=0,this.direction=l.TEXT_DIRECTION.HORIZONTAL,this.padding=5}},{key:"equals",value:function(e){var t=Object.keys(this),n=Object.keys(e);if(t.length!==n.length)return!1;for(var r=0,i=t;r<i.length;r++){var o=i[r];if(!n.includes(o))return!1}for(var a=0,s=t;a<s.length;a++){var u=s[a];if(this[u]!==e[u])return!1}return!0}}])&&fe(t.prototype,n),r&&fe(t,r),e}();function ye(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function pe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function de(e,t,n){return(de="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ke(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function ge(e){return(ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function be(e,t){return!t||"object"!==ge(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ke(e){return(ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function me(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Te(e,t)}function Te(e,t){return(Te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function we(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ee(e,t,n){return t&&xe(e.prototype,t),n&&xe(e,n),e}ve.scaleAdapter=null;var Oe=u.inWorker()?1:devicePixelRatio,Ne=Math.round(Oe),Ie=Ne+2,Ce=Ie+2,Pe=Ne/2,_e=function(){function e(t){we(this,e),this.canvas=t,this.ctx=t.getContext("2d")}return Ee(e,null,[{key:"srcPx",value:function(e){return e/this.dpr()}},{key:"cssPx",value:function(e){return this.srcPx(this.stylePx(e))}},{key:"stylePx",value:function(e){return this.round(e*this.dpr())}},{key:"round",value:function(e){return Math.round(e)}},{key:"ceil",value:function(e){return Math.ceil(e)}},{key:"trunc",value:function(e){return Math.trunc(e)}},{key:"radian",value:function(e){return-e*(Math.PI/180)}},{key:"dpr",value:function(){return Oe}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;Oe=u.inWorker()?e:devicePixelRatio,Ne=Math.round(Oe),Ce=(Ie=Ne+2)+2,Pe=Ne/2}}]),Ee(e,[{key:"attr",value:function(e){for(var t in e)if(e.hasOwnProperty(t)){var n=e[t];("string"==typeof n||n instanceof String)&&(n=n.trim()),this.ctx[t]!==n&&(this.ctx[t]=n)}return this}},{key:"resize",value:function(t,n){var r=this.canvas;return r.width=e.stylePx(t),r.height=e.stylePx(n),r.style.width="".concat(r.width/e.dpr(),"px"),r.style.height="".concat(r.height/e.dpr(),"px"),this}}]),e}(),Se=function(e){function t(e){var n;return we(this,t),(n=be(this,ke(t).call(this,e))).lineWidthType=t.LINE_WIDTH_TYPE.low,n.lineColor="rgb(0,0,0)",n}return me(t,e),Ee(t,null,[{key:"offsetToLineInside",value:function(e){return Ne>1?e-Pe:e-Ne}},{key:"getLineWidthTypePx",value:function(e){switch(e){case t.LINE_WIDTH_TYPE.medium:return Ie;case t.LINE_WIDTH_TYPE.low:return Ne;case t.LINE_WIDTH_TYPE.high:return Ce}return 0}}]),Ee(t,[{key:"corsLine",value:function(e,n){var r=this,i=pe(e,2),o=i[0],a=i[1],s=pe(n,2),u=s[0],c=s[1],l=this.lineWidthType,h=this.lineColor,f=Ne;switch(l){case t.LINE_WIDTH_TYPE.medium:f=Ie;break;case t.LINE_WIDTH_TYPE.low:f=Ne;break;case t.LINE_WIDTH_TYPE.high:f=Ce}this.attr({strokeStyle:h,lineWidth:f}),this.polyStroke((function(e){var t=pe(e,2),n=t[0],i=t[1];return[_e.round(n+r.getOffsetX())-Pe,_e.round(i+r.getOffsetY())-Pe]}),[o,a],[u,c])}},{key:"setLineColor",value:function(e){this.lineColor=e}},{key:"setLineWidthType",value:function(e){this.lineWidthType=e}},{key:"horizonLine",value:function(e,t){var n=pe(e,2),r=n[0],i=n[1],o=pe(t,2),a=o[0],s=o[1];if(i!==s)throw new TypeError("Error Horizon Line");this.corsLine([r,i],[a,s])}},{key:"verticalLine",value:function(e,t){var n=pe(e,2),r=n[0],i=n[1],o=pe(t,2),a=o[0],s=o[1];if(r!==a)throw new TypeError("Error Vertical Line");this.corsLine([r,i],[a,s])}}]),t}(function(e){function t(){return we(this,t),be(this,ke(t).apply(this,arguments))}return me(t,e),Ee(t,[{key:"line",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return this.polyStroke.apply(this,[function(t){var n=pe(t,2),r=n[0],i=n[1];return[e.linePx(_e.round(r+e.getOffsetX())),e.linePx(_e.round(i+e.getOffsetY()))]}].concat(n)),this}},{key:"linePx",value:function(e){return this.ctx.lineWidth%2==0?e:e-.5}}]),t}(function(e){function t(e){var n;return we(this,t),(n=be(this,ke(t).call(this,e))).offsetX=0,n.offsetY=0,n}return me(t,e),Ee(t,[{key:"offset",value:function(e,t){this.offsetX=e,this.offsetY=t}},{key:"getOffsetX",value:function(){return this.offsetX}},{key:"getOffsetY",value:function(){return this.offsetY}},{key:"fillText",value:function(){throw TypeError("child impl")}},{key:"fillRect",value:function(){throw TypeError("child impl")}},{key:"rect",value:function(){throw TypeError("child impl")}},{key:"drawImage",value:function(){throw TypeError("child impl")}}]),t}(function(e){function t(){return we(this,t),be(this,ke(t).apply(this,arguments))}return me(t,e),Ee(t,[{key:"polyStroke",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e},t=this.ctx;if((arguments.length<=1?0:arguments.length-1)>1){this.beginPath();var n=e(arguments.length<=1?void 0:arguments[1]),r=pe(n,2),i=r[0],o=r[1];t.moveTo(i,o);for(var a=1,s=arguments.length<=1?0:arguments.length-1;a<s;a+=1){var u=e(a+1<1||arguments.length<=a+1?void 0:arguments[a+1]),c=pe(u,2),l=c[0],h=c[1];t.lineTo(l,h)}t.stroke()}}},{key:"polyInFill",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e},t=this.ctx;if((arguments.length<=1?0:arguments.length-1)>1){this.beginPath();var n=e(arguments.length<=1?void 0:arguments[1]),r=pe(n,2),i=r[0],o=r[1];t.moveTo(i,o);for(var a=1,s=arguments.length<=1?0:arguments.length-1;a<s;a+=1){var u=e(a+1<1||arguments.length<=a+1?void 0:arguments[a+1]),c=pe(u,2),l=c[0],h=c[1];t.lineTo(l,h)}t.fill()}}},{key:"fullRect",value:function(){var e=this.canvas,t=e.width,n=e.height;return this.ctx.fillRect(0,0,t,n),this}},{key:"rotate",value:function(e){return de(ke(t.prototype),"rotate",this).call(this,_e.radian(e)),this}}]),t}(function(e){function t(e){var n;return we(this,t),(n=be(this,ke(t).call(this,e))).dash=[],n}return me(t,e),Ee(t,[{key:"beginPath",value:function(){return this.ctx.beginPath(),this}},{key:"measureText",value:function(e){return this.ctx.measureText(e)}},{key:"save",value:function(){return this.ctx.save(),this}},{key:"restore",value:function(){return this.ctx.restore(),this}},{key:"fill",value:function(){return this.ctx.fill(),this}},{key:"clip",value:function(){return this.ctx.clip(),this}},{key:"setLineDash",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.ctx;return this.dash=e,t.setLineDash(e),this}},{key:"scale",value:function(e,t){return this.ctx.scale(e,t),this}},{key:"translate",value:function(e,t){return this.ctx.translate(e,t),this}},{key:"rotate",value:function(e){return this.ctx.rotate(e),this}}]),t}(_e)))));Se.LINE_WIDTH_TYPE={low:"low",medium:"medium",high:"high"};var Ae=function(e){function t(){return we(this,t),be(this,ke(t).apply(this,arguments))}return me(t,e),Ee(t,[{key:"fillText",value:function(e,n,r){return n+=this.getOffsetX(),r+=this.getOffsetY(),this.ctx.fillText(e,t.round(n),t.round(r)),this}},{key:"fillPath",value:function(e){var t=this;return this.polyInFill.apply(this,[function(e){var n=e.x,r=e.y;return[_e.round(n+t.getOffsetX()),_e.round(r+t.getOffsetY())]}].concat(ye(e.points))),this}},{key:"fillRect",value:function(e,n,r,i){return e+=this.getOffsetX(),n+=this.getOffsetY(),this.ctx.fillRect(t.round(e),t.round(n),t.round(r),t.round(i)),this}},{key:"rect",value:function(e,n,r,i){return e+=this.getOffsetX(),n+=this.getOffsetY(),this.ctx.rect(t.round(e),t.round(n),t.round(r),t.round(i)),this}},{key:"copyImage",value:function(e,n,r,i,o,a,s,u){var c=this.ctx;return o+=this.getOffsetX(),e+=this.getOffsetX(),a+=this.getOffsetY(),n+=this.getOffsetY(),c.drawImage(this.canvas,t.round(e),t.round(n),t.round(r),t.round(i),t.round(o),t.round(a),t.round(s),t.round(u)),this}},{key:"drawImage",value:function(e,n,r,i,o,a,s,u,c){var l=this.ctx;return a+=this.getOffsetX(),s+=this.getOffsetY(),l.drawImage(e,t.round(n),t.round(r),t.round(i),t.round(o),t.round(a),t.round(s),t.round(u),t.round(c)),this}}]),t}(Se);function Re(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Le(e,t,n){return t&&Me(e.prototype,t),n&&Me(e,n),e}var De=0,je=3,Fe=function(){function e(t,n){Re(this,e),this.draw=t,u.copy(this,{color:"rgb(0,0,0)",widthType:Ae.LINE_WIDTH_TYPE.low,padding:1,spacing:e.spacing,leftShow:function(){return!1},topShow:function(){return!1},rightShow:function(){return!1},bottomShow:function(){return!1},iFMerge:function(){return!1},iFMergeFirstRow:function(){return!1},iFMergeLastRow:function(){return!1},iFMergeFirstCol:function(){return!1},iFMergeLastCol:function(){return!1}},n)}return Le(e,[{key:"setWidthType",value:function(e){this.widthType=e}},{key:"setColor",value:function(e){this.color=e}},{key:"handleExternal",value:function(e,t,n,r,i,o,a){var s={},u=this.leftShow,c=this.topShow,l=this.rightShow,h=this.bottomShow,f=this.iFMerge,v=this.iFMergeFirstRow,y=this.iFMergeLastRow,p=this.iFMergeFirstCol,d=this.iFMergeLastCol,g=this.spacing,b=null,k=null,m=null,T=null,w=null;switch(a){case"left":(b=f(i,o-1))&&(k=v(i,o-1),m=y(i,o-1),T=p(i,o-1),w=d(i,o-1));break;case"top":(b=f(i-1,o))&&(k=v(i-1,o),m=y(i-1,o),T=p(i-1,o),w=d(i-1,o));break;case"right":(b=f(i,o+1))&&(k=v(i,o+1),m=y(i,o+1),T=p(i,o+1),w=d(i,o+1));break;case"bottom":(b=f(i+1,o))&&(k=v(i+1,o),m=y(i+1,o),T=p(i+1,o),w=d(i+1,o))}if(b){switch(a){case"left":s.sx=e-g,s.ex=n-g;var x=h(i-1,o-1)||c(i,o-1),E=c(i,o),O=h(i-1,o);s.sy=t,(E||O)&&(s.sy=t-g),x&&k&&(s.sy=t+g);var N=c(i+1,o-1)||h(i,o-1),I=h(i,o),C=c(i+1,o);s.ey=r,(I||C)&&(s.ey=r+g),N&&m&&(s.ey=r-g);break;case"top":s.sy=t-g,s.ey=r-g;var P=l(i-1,o-1)||u(i-1,o),_=u(i,o),S=l(i,o-1);s.sx=e,(_||S)&&(s.sx=e-g),P&&T&&(s.sx=e+g);var A=u(i-1,o+1)||l(i-1,o),R=l(i,o),M=u(i,o+1);s.ex=n,(R||M)&&(s.ex=n+g),A&&w&&(s.ex=n-g);break;case"right":s.sx=e+g,s.ex=n+g;var L=h(i-1,o+1)||c(i,o+1),D=c(i,o),j=h(i-1,o);s.sy=t,(D||j)&&(s.sy=t-g),L&&k&&(s.sy=t+g);var F=c(i+1,o+1)||h(i,o+1),H=h(i,o),Y=c(i+1,o);s.ey=r,(H||Y)&&(s.ey=r+g),F&&m&&(s.ey=r-g);break;case"bottom":s.sy=t+g,s.ey=r+g;var W=l(i+1,o-1)||u(i+1,o),U=u(i,o),G=l(i,o-1);s.sx=e,(U||G)&&(s.sx=e-g),W&&T&&(s.sx=e+g);var V=u(i+1,o+1)||l(i+1,o),B=l(i,o),z=u(i,o+1);s.ex=n,(B||z)&&(s.ex=n+g),V&&w&&(s.ex=n-g)}return s}switch(a){case"left":s.sx=e-g,s.ex=n-g;var X=h(i-1,o-1)||c(i,o-1),Z=c(i,o),q=h(i-1,o);s.sy=t,(Z||q)&&(s.sy=t-g),X&&(s.sy=t+g);var K=c(i+1,o-1)||h(i,o-1),$=h(i,o),J=c(i+1,o);s.ey=r,($||J)&&(s.ey=r+g),K&&(s.ey=r-g);break;case"top":s.sy=t-g,s.ey=r-g;var Q=l(i-1,o-1)||u(i-1,o),ee=u(i,o),te=l(i,o-1);s.sx=e,(ee||te)&&(s.sx=e-g),Q&&(s.sx=e+g);var ne=u(i-1,o+1)||l(i-1,o),re=l(i,o),ie=u(i,o+1);s.ex=n,(re||ie)&&(s.ex=n+g),ne&&(s.ex=n-g);break;case"right":s.sx=e+g,s.ex=n+g;var oe=h(i-1,o+1)||c(i,o+1),ae=c(i,o),se=h(i-1,o);s.sy=t,(ae||se)&&(s.sy=t-g),oe&&(s.sy=t+g);var ue=c(i+1,o+1)||h(i,o+1),ce=h(i,o),le=c(i+1,o);s.ey=r,(ce||le)&&(s.ey=r+g),ue&&(s.ey=r-g);break;case"bottom":s.sy=t+g,s.ey=r+g;var he=l(i+1,o-1)||u(i+1,o),fe=u(i,o),ve=l(i,o-1);s.sx=e,(fe||ve)&&(s.sx=e-g),he&&(s.sx=e+g);var ye=u(i+1,o+1)||l(i+1,o),pe=l(i,o),de=u(i,o+1);s.ex=n,(pe||de)&&(s.ex=n+g),ye&&(s.ex=n-g)}return s}},{key:"handleInternal",value:function(e,t,n,r,i,o,a){var s={},u=this.leftShow,c=this.topShow,l=this.rightShow,h=this.bottomShow,f=this.iFMerge,v=this.iFMergeFirstRow,y=this.iFMergeLastRow,p=this.iFMergeFirstCol,d=this.iFMergeLastCol,g=this.spacing;if(f(i,o)){var b=v(i,o),k=y(i,o),m=p(i,o),T=d(i,o);switch(a){case"left":s.sx=e+g,s.ex=n+g;var w=h(i-1,o-1)||c(i,o-1),x=c(i,o),E=h(i-1,o);s.sy=t,w&&(s.sy=t-g),(x||E)&&b&&(s.sy=t+g);var O=c(i+1,o-1)||h(i,o-1),N=h(i,o),I=c(i+1,o);s.ey=r,O&&(s.ey=r+g),(N||I)&&k&&(s.ey=r-g);break;case"top":s.sy=t+g,s.ey=r+g;var C=l(i-1,o-1)||u(i-1,o),P=u(i,o),_=l(i,o-1);s.sx=e,C&&(s.sx=e-g),(P||_)&&m&&(s.sx=e+g);var S=u(i-1,o+1)||l(i-1,o),A=l(i,o),R=u(i,o+1);s.ex=n,S&&(s.ex=n+g),(A||R)&&T&&(s.ex=n-g);break;case"right":s.sx=e-g,s.ex=n-g;var M=h(i-1,o+1)||c(i,o+1),L=c(i,o),D=h(i-1,o);s.sy=t,M&&(s.sy=t-g),(L||D)&&b&&(s.sy=t+g);var j=c(i+1,o+1)||h(i,o+1),F=h(i,o),H=c(i+1,o);s.ey=r,j&&(s.ey=r+g),(F||H)&&k&&(s.ey=r-g);break;case"bottom":s.sy=t-g,s.ey=r-g;var Y=l(i+1,o-1)||u(i+1,o),W=u(i,o),U=l(i,o-1);s.sx=e,Y&&(s.sx=e-g),(W||U)&&m&&(s.sx=e+g);var G=u(i+1,o+1)||l(i+1,o),V=l(i,o),B=u(i,o+1);s.ex=n,G&&(s.ex=n+g),(V||B)&&T&&(s.ex=n-g)}return s}switch(a){case"left":s.sx=e+g,s.ex=n+g;var z=h(i-1,o-1)||c(i,o-1),X=c(i,o),Z=h(i-1,o);s.sy=t,z&&(s.sy=t-g),(X||Z)&&(s.sy=t+g);var q=c(i+1,o-1)||h(i,o-1),K=h(i,o),$=c(i+1,o);s.ey=r,q&&(s.ey=r+g),(K||$)&&(s.ey=r-g);break;case"top":s.sy=t+g,s.ey=r+g;var J=l(i-1,o-1)||u(i-1,o),Q=u(i,o),ee=l(i,o-1);s.sx=e,J&&(s.sx=e-g),(Q||ee)&&(s.sx=e+g);var te=u(i-1,o+1)||l(i-1,o),ne=l(i,o),re=u(i,o+1);s.ex=n,te&&(s.ex=n+g),(ne||re)&&(s.ex=n-g);break;case"right":s.sx=e-g,s.ex=n-g;var ie=h(i-1,o+1)||c(i,o+1),oe=c(i,o),ae=h(i-1,o);s.sy=t,ie&&(s.sy=t-g),(oe||ae)&&(s.sy=t+g);var se=c(i+1,o+1)||h(i,o+1),ue=h(i,o),ce=c(i+1,o);s.ey=r,se&&(s.ey=r+g),(ue||ce)&&(s.ey=r-g);break;case"bottom":s.sy=t-g,s.ey=r-g;var le=l(i+1,o-1)||u(i+1,o),he=u(i,o),fe=l(i,o-1);s.sx=e,le&&(s.sx=e-g),(he||fe)&&(s.sx=e+g);var ve=u(i+1,o+1)||l(i+1,o),ye=l(i,o),pe=u(i,o+1);s.ex=n,ve&&(s.ex=n+g),(ye||pe)&&(s.ex=n-g)}return s}},{key:"horizonLine",value:function(e,t,n,r,i,o,a){var s=this.draw,c=this.widthType,l=this.color;s.setLineColor(l),s.setLineWidthType(c),s.setLineDash([]);var h=this.handleExternal(e,t,n,r,i,o,a),f=this.handleInternal(e,t,n,r,i,o,a);u.isEmptyObject(f)||s.horizonLine([f.sx,f.sy],[f.ex,f.ey]),u.isEmptyObject(h)||s.horizonLine([h.sx,h.sy],[h.ex,h.ey])}},{key:"verticalLine",value:function(e,t,n,r,i,o,a){var s=this.draw,c=this.widthType,l=this.color;s.setLineColor(l),s.setLineWidthType(c),s.setLineDash([]);var h=this.handleExternal(e,t,n,r,i,o,a),f=this.handleInternal(e,t,n,r,i,o,a);u.isEmptyObject(f)||s.verticalLine([f.sx,f.sy],[f.ex,f.ey]),u.isEmptyObject(h)||s.verticalLine([h.sx,h.sy],[h.ex,h.ey])}},{key:"tiltingLine",value:function(e,t,n,r,i,o,a){}}]),e}();Fe.spacing=Ae.dpr()>=2?3:2;function He(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ye(e,t,n){return t&&He(e.prototype,t),n&&He(e,n),e}var We=0,Ue=function(){function e(t){var n=t.widthType,r=void 0===n?Ae.LINE_WIDTH_TYPE.low:n,i=t.width,o=void 0===i?-1:i,a=t.color,s=void 0===a?"rgb(0,0,0)":a,u=t.zIndex,c=void 0===u?0:u,l=t.display,h=void 0!==l&&l,f=t.type,v=void 0===f?De:f;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.zIndex=c,this.display=h,this.color=s,this.type=v,this.widthType=1===o?Ae.LINE_WIDTH_TYPE.low:2===o?Ae.LINE_WIDTH_TYPE.medium:3===o?Ae.LINE_WIDTH_TYPE.high:r,c>We&&(We=c)}return Ye(e,null,[{key:"getZIndex",value:function(){return We+=1}}]),Ye(e,[{key:"setWidthType",value:function(t){this.zIndex=e.getZIndex(),this.widthType=t}},{key:"setColor",value:function(t){this.zIndex=e.getZIndex(),this.color=t}},{key:"setDisplay",value:function(t){this.zIndex=e.getZIndex(),this.display=t}},{key:"setType",value:function(t){this.zIndex=e.getZIndex(),this.type=t}},{key:"setZIndex",value:function(e){this.zIndex=e}},{key:"priority",value:function(e){if(u.isUnDef(e))return-2;var t=this.zIndex,n=e.zIndex;return t>n?1:n>t?-1:0}},{key:"clone",value:function(){return new e({widthType:this.widthType,color:this.color,zIndex:this.zIndex,type:this.type,display:this.display})}},{key:"equal",value:function(e){var t=this.widthType===e.widthType,n=this.color===e.color,r=this.type===e.type;return n&&t&&r}}]),e}();function Ge(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ve=function(){function e(t){var n=t.left,r=void 0===n?{}:n,i=t.bottom,o=void 0===i?{}:i,a=t.top,s=void 0===a?{}:a,u=t.right,c=void 0===u?{}:u;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.left=new Ue(r),this.bottom=new Ue(o),this.top=new Ue(s),this.right=new Ue(c)}var t,n,r;return t=e,(n=[{key:"hasDouble",value:function(){var e=this.top,t=this.left,n=this.right,r=this.bottom;return e.type===je||t.type===je||n.type===je||r.type===je}},{key:"isDisplay",value:function(){return this.left.display||this.top.display||this.bottom.display||this.right.display}},{key:"setAllDisplay",value:function(e){this.setBDisplay(e),this.setLDisplay(e),this.setTDisplay(e),this.setRDisplay(e)}},{key:"setLDisplay",value:function(e){this.left.setDisplay(e)}},{key:"setTDisplay",value:function(e){this.top.setDisplay(e)}},{key:"setRDisplay",value:function(e){this.right.setDisplay(e)}},{key:"setBDisplay",value:function(e){this.bottom.setDisplay(e)}},{key:"setAllColor",value:function(e){this.setBColor(e),this.setLColor(e),this.setTColor(e),this.setRColor(e)}},{key:"setLColor",value:function(e){this.left.setColor(e)}},{key:"setTColor",value:function(e){this.top.setColor(e)}},{key:"setRColor",value:function(e){this.right.setColor(e)}},{key:"setBColor",value:function(e){this.bottom.setColor(e)}},{key:"setAllWidthType",value:function(e){this.setBWidthType(e),this.setLWidthType(e),this.setTWidthType(e),this.setRWidthType(e)}},{key:"setLWidthType",value:function(e){this.left.setWidthType(e)}},{key:"setTWidthType",value:function(e){this.top.setWidthType(e)}},{key:"setRWidthType",value:function(e){this.right.setWidthType(e)}},{key:"setBWidthType",value:function(e){this.bottom.setWidthType(e)}},{key:"setAllType",value:function(e){this.setBType(e),this.setLType(e),this.setTType(e),this.setRType(e)}},{key:"setLType",value:function(e){this.left.setType(e)}},{key:"setTType",value:function(e){this.top.setType(e)}},{key:"setRType",value:function(e){this.right.setType(e)}},{key:"setBType",value:function(e){this.bottom.setType(e)}},{key:"updateMaxIndex",value:function(){var e=Ue.getZIndex();this.left.setZIndex(e),this.bottom.setZIndex(e),this.top.setZIndex(e),this.right.setZIndex(e)}},{key:"clone",value:function(){var t=this.left,n=this.top,r=this.right,i=this.bottom;return new e({left:t.clone(),top:n.clone(),right:r.clone(),bottom:i.clone()})}}])&&Ge(t.prototype,n),r&&Ge(t,r),e}();function Be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ze=function(){function e(t){var n=t.x,r=t.y,i=t.width,o=t.height;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=n,this.y=r,this.width=i,this.height=o}var t,n,r;return t=e,(n=[{key:"disjoint",value:function(e){return this.x>e.x+e.width||this.y>this.y+e.height||e.x>this.x+this.width||e.y>this.y+this.height}},{key:"expandSize",value:function(e){return this.width+=e,this.height+=e,this}},{key:"includePoint",value:function(e,t){return e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height}},{key:"includeRect",value:function(e){var t=e.x,n=e.y,r=e.width,i=e.height;return this.x<=t&&this.x+this.width>=t+r&&this.y<=n&&this.y+this.height>=n+i}},{key:"inRectPosition",value:function(t){return new e({x:this.x-t.x,y:this.y-t.y,width:this.width,height:this.height})}},{key:"clone",value:function(){return new e({x:this.x,y:this.y,width:this.width,height:this.height})}}])&&Be(t.prototype,n),r&&Be(t,r),e}();function Xe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Ze=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.x,r=void 0===n?0:n,i=t.y,o=void 0===i?0:i;Xe(this,e),this.x=r,this.y=o};function qe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ke=function(){function e(t){var n=t.rect,r=t.draw,i=t.offset,o=void 0===i?0:i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rect=n,this.draw=r,this.offset=o}var t,n,r;return t=e,(n=[{key:"open",value:function(){var e=this.rect,t=this.draw,n=this.offset,r=e.x,i=e.y,o=e.width,a=e.height;return t.save().rect(r,i,o+n,a+n).clip().beginPath(),this}},{key:"close",value:function(){return this.draw.restore(),this}}])&&qe(t.prototype,n),r&&qe(t,r),e}();function $e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Je(e,t,n){return t&&$e(e.prototype,t),n&&$e(e,n),e}var Qe=function(){function e(t){var n=t.vertical,r=void 0===n?e.ICON_VERTICAL.CENTER:n,i=t.horizontal,o=void 0===i?e.ICON_HORIZONTAL.RIGHT:i,a=t.type,s=void 0===a?e.ICON_TYPE.image:a,c=t.image,l=void 0===c?u.Nul:c,h=t.iconFocus,f=void 0===h?null:h,v=t.height,y=void 0===v?16:v,p=t.width,d=void 0===p?16:p,g=t.color,b=void 0===g?"rgb(255,255,255)":g,k=t.offset,m=void 0===k?{x:0,y:0}:k,T=t.onDraw,w=void 0===T?function(){}:T,x=t.onLeave,E=void 0===x?function(){}:x,O=t.onMove,N=void 0===O?function(){}:O,I=t.onDown,C=void 0===I?function(){}:I,P=t.onEnter,_=void 0===P?function(){}:P;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.vertical=r,this.horizontal=o,this.width=d,this.height=y,this.type=s,this.image=l,this.color=b,this.iconFocus=f,this.offset=new Ze(m),this.onLeave=E,this.onMove=N,this.onDraw=w,this.onDown=C,this.onEnter=_,this.rect=null}return Je(e,null,[{key:"newInstances",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=[],r=0;r<t.length;r+=1){var i=t[r];n.push(new e(i))}return n}}]),Je(e,[{key:"position",value:function(t){var n=this.horizontal,r=this.vertical,i=Ae.stylePx(this.offset.x),o=Ae.stylePx(this.offset.y),a=Ae.stylePx(this.width),s=Ae.stylePx(this.height),u=t.x,c=t.y,l=t.width,h=t.height,f=0,v=0;switch(n){case e.ICON_HORIZONTAL.CENTER:f=u+l/2-a/2;break;case e.ICON_HORIZONTAL.LEFT:f=u;break;case e.ICON_HORIZONTAL.RIGHT:f=u+l-a}switch(r){case e.ICON_VERTICAL.CENTER:v=c+h/2-s/2;break;case e.ICON_VERTICAL.TOP:v=c;break;case e.ICON_VERTICAL.BOTTOM:v=c+h-s}return new ze({x:f+=i,y:v+=o,width:a,height:s})}},{key:"loadImage",value:function(t){var n=this,r=t.load,i=t.sync,o=this.image;switch(this.type){case e.ICON_TYPE.image:if(o instanceof Image)i(o);else{var a=new Image;a.src=o,a.complete?(this.image=a,i(this.image)):(a.onload=function(){n.image=a,r(a)},a.onerror=function(){console.error("图片加载失败".concat(o))})}break;case e.ICON_TYPE.draw:i()}}},{key:"drawIcon",value:function(t){var n=t.rect,r=t.draw,i=this.type;switch(this.rect=n,i){case e.ICON_TYPE.image:this.drawImage({rect:n,draw:r});break;case e.ICON_TYPE.draw:this.drawCustom({rect:n,draw:r})}}},{key:"drawCustom",value:function(e){var t=e.rect,n=e.draw;this.onDraw({rect:t,draw:n})}},{key:"drawImage",value:function(e){var t=e.rect,n=e.draw,r=this.image,i=this.color,o=this.position(t),a=o.x,s=o.y,u=o.width,c=o.height,l=t.includeRect(o),h=new Ke({rect:t,draw:n});!1===l&&h.open(),i&&(n.attr({fillStyle:i}),n.fillRect(a,s,u,c)),n.drawImage(r,0,0,r.width,r.height,a,s,u,c),!1===l&&h.close()}},{key:"eventHandle",value:function(t){var n=t.type,r=t.x,i=t.y,o=t.native,a=this.rect,s=this.iconFocus;if(a){var u=this.position(a),c=u.inRectPosition(a),l=s.activate;switch(n){case e.ICON_EVENT_TYPE.MOUSE_DOWN:c.includePoint(r,i)&&(s.setActivate(this),this.onDown({native:o,position:u}));break;case e.ICON_EVENT_TYPE.MOUSE_MOVE:c.includePoint(r,i)?(l!==this&&this.onEnter({native:o,position:u}),s.setActivate(this),this.onMove({native:o,position:u})):l&&(s.setActivate(null),this.onLeave({native:o,position:u}))}}}},{key:"setOnDraw",value:function(e){this.onDraw=e}},{key:"setOnDown",value:function(e){this.onDown=e}},{key:"setOnMove",value:function(e){this.onMove=e}},{key:"setOnEnter",value:function(e){this.onEnter=e}},{key:"setOnLeave",value:function(e){this.onLeave=e}},{key:"setFocus",value:function(e){this.iconFocus=e}}]),e}();function et(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Qe.ICON_HORIZONTAL={LEFT:0,RIGHT:1,CENTER:2},Qe.ICON_VERTICAL={TOP:3,BOTTOM:4,CENTER:5},Qe.ICON_TYPE={image:1,custom:2},Qe.ICON_EVENT_TYPE={MOUSE_DOWN:1,MOUSE_MOVE:2};var tt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"dateFormat",value:function(e,t){if(!(t instanceof Date))return t;var n={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()},r=/(y+)/.exec(e);if(r){var i=r[0],o=t.getFullYear().toString().substr(4-i.length);e=e.replace(i,o)}for(var a in n){var s=new RegExp("(".concat(a,")")).exec(e);if(s){var u=n[a].toString(),c=s[0],l=1===c.length?u:"00".concat(u).substr(u.length);e=e.replace(c,l)}}return e}},{key:"parse",value:function(t){var n=t;return n instanceof Date||(n=e.parserToDate(t,"yyyy/MM/dd"))||(n=e.parserToDate(t,"MM/dd"))||(n=e.parserToDate(t,"yyyy/MM/dd hh:mm:ss"))||(n=e.parserToDate(t,"yyyy-MM-dd"))||(n=e.parserToDate(t,"MM-dd"))||(n=e.parserToDate(t,"yyyy-MM-dd hh:mm:ss"))||(n=e.parserToDate(t,"hh:mm:ss"))||(n=e.parserToDate(t,"yyyy年MM月"))||(n=e.parserToDate(t,"MM月dd日"))?n:(n=e.parserToDate(t,"yyyy年MM月dd日 hh:mm:ss"))||t}},{key:"parserToDate",value:function(e,t){if(!e)return null;for(var n=new Date("1970/01/01 00:00:00"),r=[{reg:"y+"},{reg:"M+"},{reg:"d+"},{reg:"h+"},{reg:"m+"},{reg:"s+"},{reg:"S"}],i=n.getFullYear(),o=n.getMonth()+1,a=n.getDate(),s=n.getHours(),u=n.getMinutes(),c=n.getSeconds(),l=n.getMilliseconds(),h=1,f=0;f<t.length;f+=1)for(var v=t[f],y=0;y<r.length;y+=1){var p=r[y];if(p.reg[0]===v){p.index||(p.index=h,h+=1);break}}for(var d=0;d<r.length;d+=1){var g=r[d].reg,b=new RegExp("(".concat(g,")")).exec(t);if(b){var k=b[0],m="([0-9]{1,".concat(k.length,"})");t=t.replace(k,m)}}var T={},w=new RegExp(t).exec(e);if(!w)return null;for(var x=1;x<w.length;x+=1)T[x]=w[x];return r[0].index&&(i=T[r[0].index]),r[1].index&&(o=T[r[1].index]),r[2].index&&(a=T[r[2].index]),r[3].index&&(s=T[r[3].index]),r[4].index&&(u=T[r[4].index]),r[5].index&&(c=T[r[5].index]),r[6].index&&(l=T[r[6].index]),new Date(i,o-1,a,s,u,c,l)}}],(n=null)&&et(t.prototype,n),r&&et(t,r),e}();function nt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var rt=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"eNotation",value:function(e){return u.isNumber(e)?u.parseFloat(e).toExponential(2):e}},{key:"default",value:function(e){return e?e.toString():""}},{key:"text",value:function(e){return e}},{key:"decimal",value:function(e){if(u.isNumber(e)){var t=e.toString().indexOf(".");return-1!==t?e.toString().substring(0,t+3):"".concat(e,".00")}return e}},{key:"number",value:function(e){return u.isNumber(e)?u.parseFloat(e):e}},{key:"percentage",value:function(e){return u.isNumber(e)?"".concat(e,"%"):e}},{key:"fraction",value:function(e){if(u.isFraction(e)){var t=e.split("/")[0],n=e.split("/")[1];return u.parseInt(t)/u.parseInt(n)}return e}},{key:"rmb",value:function(e){return u.isNumber(e)?"￥".concat(e):e}},{key:"hk",value:function(e){return u.isNumber(e)?"HK".concat(e):e}},{key:"time",value:function(e){var t=tt.parse(e);return t?tt.dateFormat("hh:mm:ss",t):e}},{key:"date1",value:function(e){var t=tt.parse(e);return t?tt.dateFormat("yyyy/MM/dd",t):e}},{key:"date2",value:function(e){var t=tt.parse(e);return t?tt.dateFormat("MM月dd日",t):e}},{key:"date3",value:function(e){var t=tt.parse(e);return t?tt.dateFormat("yyyy年MM月",t):e}},{key:"date4",value:function(e){var t=tt.parse(e);return t?tt.dateFormat("yyyy年MM月dd日",t):e}},{key:"date5",value:function(e){var t=tt.parse(e);return t?tt.dateFormat("yyyy/MM/dd hh:mm:ss",t):e}},{key:"dollar",value:function(e){return u.isNumber(e)?"$".concat(e):e}}])&&nt(t.prototype,n),r&&nt(t,r),e}()),it=function(e,t){return rt[e](t)};function ot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function at(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var st=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.text,r=void 0===n?"":n,i=t.color,o=void 0===i?he.BLACK:i,a=t.name,s=void 0===a?"Arial":a,u=t.size,c=void 0===u?14:u,l=t.bold,h=void 0!==l&&l,f=t.italic,v=void 0!==f&&f,y=t.strikethrough,p=void 0!==y&&y,d=t.underline,g=void 0!==d&&d,b=t.scaleAdapter;ot(this,e),this.text=r,this.color=o,this.name=s,this.size=c,this.italic=v,this.bold=h,this.strikethrough=p,this.underline=g,this.scaleAdapter=b}var t,n,r;return t=e,(n=[{key:"clone",value:function(){return new e({text:this.text,color:this.color,name:this.name,size:this.size,italic:this.italic,bold:this.bold,underline:this.underline,strikethrough:this.strikethrough,scaleAdapter:this.scaleAdapter})}},{key:"reset",value:function(){this.color=he.BLACK,this.name="Arial",this.size=14,this.bold=!1,this.italic=!1,this.strikethrough=!1,this.underline=!1}},{key:"plain",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e};return e(this.clone())}},{key:"equals",value:function(e){return!u.isUnDef(e)&&e.text===this.text&&e.color===this.color&&e.name===this.name&&e.size===this.size&&e.italic===this.italic&&e.bold===this.bold&&e.strikethrough===this.strikethrough&&e.underline===this.underline}}])&&at(t.prototype,n),r&&at(t,r),e}();function ut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ct(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var lt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.rich,r=void 0===n?[]:n;ut(this,e),this.rich=r.map((function(e){return new st(e)}))}var t,n,r;return t=e,(n=[{key:"setRich",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.rich=e}},{key:"getRich",value:function(){return this.rich}},{key:"clone",value:function(){var t=[];return this.rich.forEach((function(e){t.push(e.clone())})),new e({rich:t})}},{key:"reset",value:function(){this.each((function(e){e.reset()}))}},{key:"hasLength",value:function(){return this.rich.length>0}},{key:"each",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};this.rich.forEach((function(t){e(t)}))}},{key:"plain",value:function(e){var t=[];return this.rich.forEach((function(n){t.push(n.plain(e))})),t}},{key:"equals",value:function(e){if(u.isUnDef(e))return!1;if(e.rich.length!==this.rich.length)return!1;for(var t=0;t<this.rich.length;t++){var n=this.rich[t],r=e.rich[t];if(!n.equals(r))return!1}return!0}}])&&ct(t.prototype,n),r&&ct(t,r),e}();function ht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ft(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vt(e,t,n){return t&&ft(e.prototype,t),n&&ft(e,n),e}var yt=new(function(){function e(){ht(this,e),this.functions={}}return vt(e,[{key:"remove",value:function(e){delete this.functions[e]}},{key:"getFunction",value:function(e){return this.functions[e.toLocaleString()]}},{key:"register",value:function(e,t){this.functions[e.toLocaleString()]=t}}]),e}()),pt=function(){function e(){ht(this,e),this.assembly=""}return vt(e,[{key:"getInstruct",value:function(){for(var e=this.assembly;e.endsWith("\r\n");){var t=e.length;e=e.substring(0,t-"\r\n".length)}return e}},{key:"writeOperand",value:function(e){this.assembly+="OPush ".concat(e,"\r\n")}},{key:"writeOperator",value:function(e){this.assembly+="".concat(e,"\r\n")}},{key:"writeString",value:function(e){this.assembly+="SPush ".concat(e,"\r\n")}},{key:"writeNumber",value:function(e){this.assembly+="NPush ".concat(e,"\r\n")}}]),e}(),dt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.syntaxCheck,r=void 0===n||n;ht(this,e),this.syntaxCheck=r}return vt(e,[{key:"lexical",value:function(e){for(var t=/^(\+|-|\*|\/|%|>|<|,|\^|=|&|!|:|>=|<=|<>)$/,n=/[0-9.]/,r=/[a-z0-9_$]/i,i=e.length,o=[],a=0,s=[];a<i;){var u=e[a],c=/\s/;if(c.test(u)){var l=e[a+1];if(c.test(l)){a++;continue}}if(c.test(u)){var h=e[a-1],f=e[a+1];r.test(h)&&r.test(f)&&s.push({type:"operator",value:u}),a++}else if("("!==u)if(")"!==u)if("{"!==u)if("}"!==u)if('"'!==u)if("'"!==u)if(t.test(u)){var v=e[a+1],y="".concat(u).concat(v);t.test(y)?(s.push({type:"operator",value:y}),a++):s.push({type:"operator",value:u}),a++}else if(n.test(u)){for(var p="";n.test(u)&&a<i;)p+=u,u=e[++a];s.push({type:"number",value:p})}else{if(!r.test(u))throw new TypeError("无法识别的token ".concat(u," "));for(var d="";r.test(u)&&a<i;)d+=u,u=e[++a];"("===u?(s.push({type:"function",value:d}),s.push({type:"function",value:"("}),o.push({type:"function",value:"("}),a++):s.push({type:"operand",value:d})}else{var g="";for(u=e[++a];"'"!==u&&a<i;)g+=u,u=e[++a];u=e[++a],s.push({type:"string",value:g})}else{var b="";for(u=e[++a];'"'!==u&&a<i;)b+=u,u=e[++a];u=e[++a],s.push({type:"string",value:b})}else s.push({type:"array",value:"}"}),a++;else s.push({type:"array",value:"array"}),s.push({type:"array",value:"{"}),a++;else{var k=o.pop();k&&"function"===k.type?s.push({type:"function",value:")"}):s.push({type:"brackets",value:")"}),a++}else s.push({type:"brackets",value:"("}),o.push({type:"brackets",value:"("}),a++}return this.syntaxCheck?this.syntax(s):s}},{key:"syntax",value:function(e){for(var t=[],n=[],r=[],i=[],o=[],a=0,s=e.length,u=function(e){return"array"===e.type&&"array"===e.value},c=function(e){return"function"===e.type&&("("!==e.value&&")"!==e.value)},l=function(t,n){if("last"===t)for(;n>=0;){var r=e[n];if(c(r))n--;else{if(!u(r))return r;n--}}if("next"===t)for(;n<s;){var i=e[n];if(c(i))n++;else{if(!u(i))return i;n++}}return null},h=function(t,n){var r=e[a],i="last"===t?"前面":"后面";if("{"===r.value){if("last"===t)switch(n.type){case"array":if("{"===n.value)return;break;case"function":case"brackets":if("("===n.value)return;break;case"operator":return void n.value}if("next"===t)switch(n.type){case"string":case"array":case"number":case"operand":return;case"function":case"brackets":if("("===n.value)return}}if("}"===r.value){if("last"===t)switch(n.type){case"number":case"string":case"array":case"operand":return;case"function":case"brackets":if(")"===n.value)return}if("next"===t)switch(n.type){case"array":if("}"===n.value)return;break;case"function":case"brackets":if(")"===n.value)return;break;case"operator":return void n.value}}throw TypeError("错误表达式 ".concat(r.value," ").concat(i," ").concat(n.value))},f=function(t,n){var r=e[a],i="last"===t?"前面":"后面";switch(n.type){case"array":if("last"===t&&"{"===n.value)return;if("next"===t&&"}"===n.value)return;break;case"brackets":case"function":if("last"===t&&"("===n.value)return;if("next"===t&&")"===n.value)return;break;case"operator":return}throw TypeError("错误表达式 ".concat(r.value," ").concat(i," ").concat(n.value))},v=function(t,n){var r=e[a],i="last"===t?"前面":"后面";switch(n.type){case"brackets":case"function":case"string":case"number":case"operand":return;case"array":if(","===r.value)return}throw TypeError("错误表达式 ".concat(r.value," ").concat(i," ").concat(n.value))},y=function(t,n){var r=e[a],i="last"===t?"前面":"后面";if("("===r.value){if("last"===t)switch(n.type){case"array":if("{"===n.value)return;break;case"function":case"brackets":if("("===n.value)return;break;case"operator":return}if("next"===t)switch(n.type){case"function":case"string":case"number":case"operand":return;case"array":if("{"===n.value)return;break;case"brackets":if("("===n.value)return}}if(")"===r.value){if("last"===t)switch(n.type){case"function":case"number":case"string":case"operand":return;case"array":if("}"===n.value)return;break;case"brackets":if(")"===n.value)return}if("next"===t)switch(n.type){case"array":if("}"===n.value)return;break;case"function":case"brackets":if(")"===n.value)return;break;case"operator":return void n.value}}throw TypeError("错误表达式 ".concat(r.value," ").concat(i," ").concat(n.value))};a<s;){var p=e[a];if(u(p))a++;else if(c(p))a++;else{var d=p.type,g=p.value;if("'"===d&&(t.length?t.pop():n.length||t.push("'")),'"'===d&&(n.length?n.pop():t.length||n.push('"')),"string"===d){var b=l("last",a-1),k=l("next",a+1);b&&f("last",b),k&&f("next",k)}if("number"===d){var m=l("last",a-1),T=l("next",a+1);m&&f("last",m),T&&f("next",T)}if("array"===d){if("{"===g&&i.push(p),"}"===g){if(0===i.length)throw new TypeError("数组缺少闭合标签");i.pop()}var w=l("last",a-1),x=l("next",a+1);w&&h("last",w),x&&h("next",x)}if("function"===d){"("===g&&r.push(p),")"===g&&r.pop();var E=l("last",a-1),O=l("next",a+1);E&&y("last",E),O&&y("next",O)}if("operator"===d){var N=l("last",a-1),I=l("next",a+1);if(!N)throw TypeError("错误表达式: ".concat(p.value," 错误"));if(v("last",N),!I)throw TypeError("错误表达式: ".concat(p.value," 错误"));v("next",I)}if("brackets"===d&&("("===g&&o.push(p),")"===g)){if(0===o.length)throw new TypeError("括号缺少闭合标签");o.pop()}a++}}if(i.length)throw new TypeError("数组缺少闭合标签");if(r.length)throw new TypeError("函数缺少闭合标签");if(t.length)throw new TypeError("单引号缺少闭合标签");if(n.length)throw new TypeError("双引号缺少闭合标签");if(o.length)throw new TypeError("括号缺少闭合标签");return e}}]),e}(),gt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.tokens,r=t.writer;ht(this,e),this.writer=r,this.tokens=n,this.groupStack=[],this.index=-1,this.ignore=[","],this.opIf={">":"ifge","<":"ifgt","=":"ifeq",">=":"if_icmpge","<=":"if_icmpgt","<>":"ifne"},this.opAdd={"+":"add","-":"sub","&":"link"},this.opMul={"*":"mul","/":"div","%":"mod","^":"power"},this.opCommon={" ":"common"},this.opRel={"!":"rel",":":"uni"},this.opNew={array:"newarray"},this.opCell={function:"invoke"}}return vt(e,[{key:"eofToken",value:function(){return this.index>=this.tokens.length-1}},{key:"nextToken",value:function(){return this.index++,this.token=this.tokens[this.index],this.token}},{key:"backToken",value:function(){return this.index--,this.token=this.tokens[this.index],this.token}},{key:"reduceGroup",value:function(){var e=this.groupStack,t=e.length;if(t>0){var n=e[t-1],r=n.number;n.number=r-1}}},{key:"increaseGroup",value:function(){var e=this.groupStack,t=e.length;if(t>0){var n=e[t-1],r=n.number;n.number=r+1}}},{key:"popGroup",value:function(){return this.groupStack.pop()}},{key:"addGroup",value:function(e){return e.number=0,this.groupStack.push(e),e}},{key:"isSkipNextToken",value:function(){if(!this.eofToken()){var e=this.ignore;this.nextToken();var t=this.token;this.backToken();var n=t.value;return e.includes(n)}return!1}},{key:"compile",value:function(){var e=this.writer;for(this.compileIfge();this.isSkipNextToken();)this.nextToken(),this.compileIfge();return e.getInstruct()}},{key:"compileIfge",value:function(){for(this.compileAdd();!this.eofToken();){var e=this.nextToken(),t=e.type,n=e.value;if("operator"!==t){this.backToken();break}if(!this.opIf[n]){this.backToken();break}var r=this.opIf[n];this.compileAdd(),this.reduceGroup(),this.writer.writeOperator(r)}}},{key:"compileAdd",value:function(){for(this.compileMul();!this.eofToken();){var e=this.nextToken(),t=e.type,n=e.value;if("operator"!==t){this.backToken();break}if(!this.opAdd[n]){this.backToken();break}var r=this.opAdd[n];this.compileMul(),this.reduceGroup(),this.writer.writeOperator(r)}}},{key:"compileMul",value:function(){for(this.compileCommon();!this.eofToken();){var e=this.nextToken(),t=e.type,n=e.value;if("operator"!==t){this.backToken();break}if(!this.opMul[n]){this.backToken();break}var r=this.opMul[n];this.compileCommon(),this.reduceGroup(),this.writer.writeOperator(r)}}},{key:"compileCommon",value:function(){for(this.compileRel();!this.eofToken();){var e=this.nextToken(),t=e.type,n=e.value;if("operator"!==t){this.backToken();break}if(!this.opCommon[n]){this.backToken();break}var r=this.opCommon[n];this.compileRel(),this.reduceGroup(),this.writer.writeOperator(r)}}},{key:"compileRel",value:function(){for(this.compileArray();!this.eofToken();){var e=this.nextToken(),t=e.type,n=e.value;if("operator"!==t){this.backToken();break}if(!this.opRel[n]){this.backToken();break}var r=this.opRel[n];this.compileArray(),this.reduceGroup(),this.writer.writeOperator(r)}}},{key:"compileArray",value:function(){for(this.compileFunction();!this.eofToken();){var e=this.nextToken(),t=e.type,n=e.value;if("array"!==t){this.backToken();break}if("}"===n){this.backToken();break}for(this.addGroup(e),this.nextToken(),this.compileIfge();this.isSkipNextToken();)this.nextToken(),this.compileIfge();this.popGroup();var r=e.number,i=this.opNew[t];this.writer.writeOperator("".concat(i," ").concat(r)),this.nextToken()}}},{key:"compileFunction",value:function(){for(this.compilePushValue();!this.eofToken();){var e=this.nextToken(),t=e.type,n=e.value;if("function"!==t){this.backToken();break}if(")"===n){this.backToken();break}for(this.addGroup(e),this.nextToken(),this.compileIfge();this.isSkipNextToken();)this.nextToken(),this.compileIfge();this.popGroup();var r=e.number,i=this.opCell[t];this.writer.writeOperator("".concat(i," ").concat(n," ").concat(r)),this.nextToken()}}},{key:"compilePushValue",value:function(){if(!this.eofToken()){var e=this.nextToken(),t=this.writer,n=e.type,r=e.value;switch(n){case"string":return this.increaseGroup(),void t.writeString("".concat(r));case"number":return this.increaseGroup(),void t.writeNumber("".concat(r));case"operand":return this.increaseGroup(),void t.writeOperand(r)}switch(n){case"brackets":if("("===r){for(this.compileIfge();this.isSkipNextToken();)this.nextToken(),this.compileIfge();this.nextToken()}return}switch(n){case"array":return"}"!==r&&this.increaseGroup(),void this.backToken();case"function":return")"!==r&&this.increaseGroup(),void this.backToken()}switch(n){case"operator":return void this.backToken()}throw new TypeError("无法识别的token ".concat(n," ").concat(r," "))}}}]),e}(),bt=function(){function e(t){ht(this,e),this.instruct=t.split("\r\n"),this.memory=[]}return vt(e,[{key:"eval",value:function(){var e=this,t=/^newarray/,n=/^invoke/,r=/^SPush/,i=/^NPush/,o=/^OPush/;return this.instruct.forEach((function(a){switch(a){case"if_icmpge":e.ificmpge();break;case"if_icmpgt":e.ificmpgt();break;case"ifge":e.ifge();break;case"ifgt":e.ifgt();break;case"ifeq":e.ifeq();break;case"ifne":e.ifne();break;case"add":e.add();break;case"sub":e.sub();break;case"mul":e.mul();break;case"div":e.div();break;case"mod":e.mod();break;case"power":e.power();break;case"rel":e.rel();break;case"link":e.link();break;case"uni":e.uni();break;case"common":e.common();break;default:if(t.test(a)){var s=a.split(" ")[1];e.array(s);break}if(n.test(a)){var u=a.split(" "),c=u[1],l=u[2];e.invoke(c,l);break}if(r.test(a)){var h=a.split(" ")[1];e.pushS(h);break}if(i.test(a)){var f=a.split(" ")[1];e.pushN(f);break}if(o.test(a)){var v=a.split(" ")[1];e.pushO(v);break}}})),this.memory.pop()}},{key:"pushS",value:function(e){this.memory.push(e)}},{key:"pushN",value:function(e){e=parseFloat(e),this.memory.push(e)}},{key:"pushO",value:function(e){this.memory.push(e)}},{key:"ifge",value:function(){var e=this.memory.pop(),t=this.memory.pop();this.memory.push(t>e)}},{key:"ifgt",value:function(){var e=this.memory.pop(),t=this.memory.pop();this.memory.push(t<e)}},{key:"ifeq",value:function(){var e=this.memory.pop(),t=this.memory.pop();this.memory.push(t===e)}},{key:"ifne",value:function(){var e=this.memory.pop(),t=this.memory.pop();this.memory.push(t!==e)}},{key:"ificmpge",value:function(){var e=this.memory.pop(),t=this.memory.pop();this.memory.push(t>=e)}},{key:"ificmpgt",value:function(){var e=this.memory.pop(),t=this.memory.pop();this.memory.push(t<=e)}},{key:"add",value:function(){var e=this.memory.pop(),t=this.memory.pop();this.memory.push(t+e)}},{key:"sub",value:function(){var e=this.memory.pop(),t=this.memory.pop();this.memory.push(t-e)}},{key:"mul",value:function(){var e=this.memory.pop(),t=this.memory.pop();this.memory.push(t*e)}},{key:"div",value:function(){var e=this.memory.pop(),t=this.memory.pop();this.memory.push(t/e)}},{key:"mod",value:function(){var e=this.memory.pop(),t=this.memory.pop();this.memory.push(t%e)}},{key:"common",value:function(){}},{key:"rel",value:function(){}},{key:"uni",value:function(){}},{key:"link",value:function(){var e=this.memory.pop(),t=this.memory.pop();this.memory.push("".concat(t).concat(e))}},{key:"power",value:function(){var e=this.memory.pop(),t=this.memory.pop();this.memory.push(Math.pow(t,e))}},{key:"array",value:function(e){for(var t=[],n=1;n<=e;n++){var r=this.memory.pop();t.push(r)}t.reverse(),this.memory.push(t)}},{key:"invoke",value:function(e,t){for(var n=[],r=1;r<=t;r++){var i=this.memory.pop();n.push(i)}n.reverse();var o=yt.getFunction(e).apply(this,n);this.memory.push(o)}}]),e}(),kt=function(e){e.startsWith("=")&&(e=e.substring(1));var t=new dt,n=new pt,r=t.lexical(e);return new gt({writer:n,tokens:r}).compile()},mt=function(e){return new bt(e).eval()};function Tt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var xt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.expr,r=void 0===n?u.EMPTY:n;Tt(this,e),this.expr=r,this.content=u.Nul,this.instruct=u.Nul}var t,n,r;return t=e,(n=[{key:"getValue",value:function(){var e=this.expr,t=this.content,n=this.instruct;return t||(n||(n=kt(e)),t=mt(n)),this.content=t,this.instruct=n,t}},{key:"hasExpr",value:function(){var e=this.expr;return!u.isBlank(e)}},{key:"getExpr",value:function(){return this.expr}},{key:"setExpr",value:function(e){this.expr=e,this.content=u.Nul,this.instruct=u.Nul}},{key:"clone",value:function(){return new e({expr:this.expr})}}])&&wt(t.prototype,n),r&&wt(t,r),e}();function Et(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ot(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Nt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.ruler,r=void 0===n?u.Undef:n,i=t.format,o=void 0===i?"default":i,a=t.icons,s=void 0===a?[]:a,c=t.fontAttr,l=void 0===c?{}:c,h=t.custom,f=void 0===h?{}:h,v=t.borderAttr,y=void 0===v?{}:v,p=t.formula,d=void 0===p?{}:p,g=t.richText,b=void 0===g?{}:g,k=t.background,m=void 0===k?u.Undef:k,T=t.text,w=void 0===T?u.EMPTY:T,x=t.contentWidth,E=void 0===x?0:x,O=t.contentHeight,N=void 0===O?0:O,I=t.contentType,C=void 0===I?e.TYPE.STRING:I;Et(this,e),this.background=m,this.icons=Qe.newInstances(s),this.custom=f,this.ruler=r,this.format=o,this.formula=new xt(d),this.text=w,this.richText=new lt(b),this.formatText=u.EMPTY,this.contentHeight=N,this.contentWidth=E,this.fontAttr=new ve(l),this.borderAttr=new Ve(y),this.setContentType(C)}var t,n,r;return t=e,(n=[{key:"setIcons",value:function(e){return this.icons=e,this}},{key:"setText",value:function(e){return this.formatText=null,this.text=e,this.formula.setExpr(null),this.richText.setRich([]),this.setContentWidth(0),this}},{key:"setRichText",value:function(e){return this.formatText=null,this.text=null,this.formula.setExpr(null),this.richText.setRich(e),this.setContentWidth(0),this}},{key:"setExpr",value:function(e){return this.formatText=null,this.text=null,this.formula.setExpr(e),this.richText.setRich([]),this.setContentWidth(0),this}},{key:"getExpr",value:function(){return this.formula.getExpr()}},{key:"setFormat",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";return this.format=e,this.formatText=null,this.setContentWidth(0),this}},{key:"setRuler",value:function(e){return this.ruler=e,this}},{key:"setContentType",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.TYPE.STRING,n=this.text;switch(t){case e.TYPE.STRING:this.contentType=e.TYPE.STRING;break;case e.TYPE.NUMBER:this.contentType=t,u.isNumber(n)?(this.contentType=e.TYPE.NUMBER,this.text=u.parseFloat(n)):(this.contentType=e.TYPE.STRING,this.text="".concat(n));break;case e.TYPE.DATE_TIME:var r=tt.parse(n);u.isDate(r)?(this.contentType=e.TYPE.DATE_TIME,this.text=u.parseFloat(n)):(this.contentType=e.TYPE.STRING,this.text="".concat(n));break;case e.TYPE.RICH_TEXT:this.contentType=e.TYPE.RICH_TEXT}return this}},{key:"isEmpty",value:function(){return u.isBlank(this.getComputeText())}},{key:"hasFormula",value:function(){return this.formula.hasExpr()}},{key:"getFormatText",value:function(){var t=this.text,n=this.formula,r=this.format,i=this.formatText,o=this.contentType;if(n.hasExpr()){var a=n.getValue();return a&&u.isBlank(i)&&(i=it(r,a)),this.formatText=i,i}switch(o){case e.TYPE.STRING:case e.TYPE.NUMBER:case e.TYPE.DATE_TIME:return r&&u.isBlank(i)?(this.formatText=it(r,t),this.formatText):i}return u.EMPTY}},{key:"getComputeText",value:function(){var t=this.text,n=this.formula,r=this.richText,i=this.contentType;if(n.hasExpr())return n.getValue();switch(i){case e.TYPE.STRING:case e.TYPE.NUMBER:case e.TYPE.DATE_TIME:return t;case e.TYPE.RICH_TEXT:return r}return u.EMPTY}},{key:"setFontAttr",value:function(e){return this.fontAttr=e,this}},{key:"setBorderAttr",value:function(e){return this.borderAttr=e,this}},{key:"clone",value:function(){var t=this.background,n=this.text,r=this.format,i=this.custom,o=this.icons,a=this.contentType,s=this.formula,u=this.richText;return new e({background:t,text:n,custom:i,contentType:a,format:r,fontAttr:this.fontAttr,borderAttr:this.borderAttr,icons:o,formula:s,richText:u})}},{key:"toJSON",value:function(){var e=this.background,t=this.text,n=this.format,r=this.custom,i=this.icons,o=this.contentType,a=this.formula,s=this.richText,u=this.fontAttr,c=this.borderAttr;return{custom:r,expr:a.getExpr(),rich:s.getRich(),contentType:o,text:t,icons:i,background:e,format:n,fontAttr:u,borderAttr:c}}},{key:"toString",value:function(){return this.getFormatText()}},{key:"setContentWidth",value:function(e){return this.contentWidth=e,this}},{key:"setContentHeight",value:function(e){return this.contentHeight=e,this}}])&&Ot(t.prototype,n),r&&Ot(t,r),e}();function It(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Nt.TYPE={NUMBER:0,STRING:1,RICH_TEXT:2,DATE_TIME:3};var Ct=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t){var n=t.cell;this.cell=u.safeValue(n,t)}else this.cell=void 0}var t,n,r;return t=e,(n=[{key:"getCell",value:function(){var e=this.cell;return e instanceof Nt?e:(u.isString(e)?this.cell=new Nt({text:e}):this.cell=new Nt(e),this.cell)}},{key:"setCell",value:function(e){return this.cell=e,this}},{key:"clone",value:function(){return new e({mergeId:this.mergeId,cell:this.cell})}}])&&It(t.prototype,n),r&&It(t,r),e}();function Pt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var _t=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pool={}}var t,n,r;return t=e,(n=[{key:"clear",value:function(){var e=this;Object.keys((function(t){delete e.pool[t]}))}},{key:"removeListen",value:function(e){delete this.pool[e]}},{key:"registerListen",value:function(e,t){this.pool[e]=t}},{key:"execute",value:function(e){if(this.pool[e]){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(t=this.pool)[e].apply(t,r)}}}])&&Pt(t.prototype,n),r&&Pt(t,r),e}();function St(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var At=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.undoStack=[],this.redoStack=[],this.layer={event:"",data:[]},this.apply=!1,this.listen=new _t}var t,n,r;return t=e,(n=[{key:"canRedo",value:function(){return this.redoStack.length>0}},{key:"canUndo",value:function(){return this.undoStack.length>0}},{key:"undo",value:function(){for(var e=this.undoStack.pop(),t=e.data.length-1;t>=0;t--)e.data[t].undo();this.redoStack.push(e),this.listen.execute("change",e.event,"undo")}},{key:"redo",value:function(){for(var e=this.redoStack.pop(),t=0,n=e.data.length;t<n;t++)e.data[t].redo();this.undoStack.push(e),this.listen.execute("change",e.event,"redo")}},{key:"open",value:function(){this.layer={event:"",data:[]},this.apply=!0}},{key:"close",value:function(e){this.layer.data.length&&(this.layer.event=e,this.redoStack=[],this.undoStack.push(this.layer)),this.layer={event:"",data:[]},this.apply=!1,this.listen.execute("change",e,"close")}},{key:"addAction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{undo:function(){},redo:function(){}};this.apply&&this.layer.data.push(e)}}])&&St(t.prototype,n),r&&St(t,r),e}();function Rt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Lt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.snapshot,r=void 0===n?new At:n,i=t.items,o=void 0===i?[]:i;Rt(this,e),this.items=o,this.snapshot=r}var t,n,r;return t=e,(n=[{key:"getOrNew",value:function(e,t){var n=this.get(e,t);if(n)return n;var r=new Ct;return this.set(e,t,r),r}},{key:"getItems",value:function(){return this.items}},{key:"slice",value:function(e,t,n,r){return this.items.slice(e,n+1).map((function(e){return e?e.slice(t,r+1):e}))}},{key:"get",value:function(e,t){var n=this.items[e];return n&&n[t]?this.wrap(n,t):void 0}},{key:"set",value:function(e,t,n){var r=this.items[e]||[];r[t]=n,this.items[e]=r}},{key:"wrap",value:function(e,t){var n=e[t];return n?(n=n instanceof Ct?n:new Ct(n),e[t]=n,n):n}},{key:"each",value:function(e){for(var t=this.items,n=t.length,r=0;r<n;r++){var i=t[r];if(i)for(var o=i.length,a=0;a<o;a++)e(this.get(r,a))}}},{key:"clear",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.ignoreCorner,r=void 0!==n&&n,i=e.sri,o=e.eri,a=e.sci,s=e.eci,u=this.items,c=this.snapshot,l=u.length,h=[],f=o-i+1,v=s-a+1,y={undo:function(){for(var e=i;e<=o&&!(e>=l);e++){var t=h[e],n=u[e];if(n)for(var c=a;c<=s&&!(c>=l);c++)if(r){if(e===i&&c===a)continue;n[c]=t[c]}else n[c]=t[c]}},redo:function(){h=new Array(f);for(var e=i;e<=o&&!(e>=l);e++){var t=u[e];if(t){for(var n=new Array(v),c=t.length,y=a;y<=s&&!(y>=c);y++)if(r){if(e===i&&y===a)continue;n[y]=t[y],t[y]=void 0}else n[y]=t[y],t[y]=void 0;h[e]=n}}}};c.addAction(y),y.redo()}},{key:"setOrNew",value:function(e,t,n){var r=this.items[e];r&&(r[t]=n)}},{key:"removeRow",value:function(e){var t,n=this,r={undo:function(){t&&n.items.splice(e,0,t)},redo:function(){t=n.items.splice(e,1)[0]}};this.snapshot.addAction(r),r.redo()}},{key:"removeCol",value:function(e){var t=this,n=this.snapshot,r=[],i={undo:function(){for(var n=r.length,i=0;i<n;i++){var o=r[i],a=o.ri,s=o.item;t.items[a].splice(e,0,s)}},redo:function(){var n=t.items.length;r=[];for(var i=0;i<n;i++){var o=t.items[i];if(o){var a=o.splice(e,1)[0];r.push({ri:i,item:a})}}}};n.addAction(i),i.redo()}},{key:"insertRowAfter",value:function(e){var t=this,n={undo:function(){t.items.splice(e+1,1)},redo:function(){var n=t.items[e];if(n){for(var r=[],i=0,o=n.length;i<o;i++){var a=n[i];if(a){var s=a.mergeId;r[i]={mergeId:s}}}t.items.splice(e+1,0,r)}else t.items.splice(e+1,0,[])}};this.snapshot.addAction(n),n.redo()}},{key:"insertColAfter",value:function(e){var t=this,n={undo:function(){for(var n=0,r=t.items.length;n<r;n++){var i=t.items[n];i&&i.splice(e+1,1)}},redo:function(){for(var n=0,r=t.items.length;n<r;n++){var i=t.items[n];if(i){var o=i[e];if(o){var a=o.mergeId;i.splice(e+1,0,{mergeId:a})}else i.splice(e+1,0,{})}}}};this.snapshot.addAction(n),n.redo()}},{key:"insertRowBefore",value:function(e){var t=this,n={undo:function(){t.items.splice(e,1)},redo:function(){var n=t.items[e];if(n){for(var r=[],i=0,o=n.length;i<o;i++){var a=n[i];if(a){var s=a.mergeId;r[i]={mergeId:s}}}t.items.splice(e,0,r)}else t.items.splice(e,0,[])}};this.snapshot.addAction(n),n.redo()}},{key:"insertColBefore",value:function(e){var t=this,n={undo:function(){for(var n=0,r=t.items.length;n<r;n++){var i=t.items[n];i&&i.splice(e,1)}},redo:function(){for(var n=0,r=t.items.length;n<r;n++){var i=t.items[n];if(i){var o=i[e];if(o){var a=o.mergeId;i.splice(e,0,{mergeId:a})}else i.splice(e,0,{})}}}};this.snapshot.addAction(n),n.redo()}}])&&Mt(t.prototype,n),r&&Mt(t,r),e}();addEventListener("message",(function(e){var t=e.data,n=new Lt({items:t}),r=0,i=0;n.each((function(e){if(e){var t=e.getCell();if(t.hasFormula()){var n=t.getComputeText();u.isNumber(n)&&(r+=u.parseFloat(n),i++)}else switch(t.contentType){case Nt.TYPE.NUMBER:r+=t.getComputeText(),i++}}})),postMessage({total:r,number:i})}))}]);
//# sourceMappingURL=sumtotal.worker.js.map